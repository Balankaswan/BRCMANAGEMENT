const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-DubB-cnQ.js","assets/vendor-wpXbf5jk.js"])))=>i.map(i=>d[i]);
import{r as pe,a as bu,R as ec}from"./vendor-wpXbf5jk.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Oc={exports:{}},Js={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu=pe,yu=Symbol.for("react.element"),wu=Symbol.for("react.fragment"),Nu=Object.prototype.hasOwnProperty,ju=vu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_u={key:!0,ref:!0,__self:!0,__source:!0};function Bc(n,e,r){var a,s={},i=null,l=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(l=e.ref);for(a in e)Nu.call(e,a)&&!_u.hasOwnProperty(a)&&(s[a]=e[a]);if(n&&n.defaultProps)for(a in e=n.defaultProps,e)s[a]===void 0&&(s[a]=e[a]);return{$$typeof:yu,type:n,key:i,ref:l,props:s,_owner:ju.current}}Js.Fragment=wu;Js.jsx=Bc;Js.jsxs=Bc;Oc.exports=Js;var t=Oc.exports,Tc,tc=bu;Tc=tc.createRoot,tc.hydrateRoot;const Su="http://localhost:5001/api";class Lu{constructor(e){this.token=null,this.baseURL=e,this.token=localStorage.getItem("auth_token")}setToken(e){this.token=e,localStorage.setItem("auth_token",e)}clearToken(){this.token=null,localStorage.removeItem("auth_token")}async request(e,r={}){const a=`${this.baseURL}${e}`,s={"Content-Type":"application/json",...r.headers};this.token&&(s.Authorization=`Bearer ${this.token}`),console.log(`Making API request to: ${a}`),console.log("Request options:",{method:r.method,headers:s}),r.body&&console.log("Request body:",r.body);try{const i=await fetch(a,{...r,headers:s});if(console.log(`Response status: ${i.status}`),!i.ok){const u=await i.json().catch(()=>({}));throw console.error("Error response data:",u),new Error(u.message||`HTTP ${i.status}: ${i.statusText}`)}const l=await i.json();return console.log("Success response:",l),l}catch(i){throw console.error(`API Error (${e}):`,i),console.error("Full error details:",{message:i instanceof Error?i.message:"Unknown error",stack:i instanceof Error?i.stack:void 0,url:a,options:r}),i}}async login(e,r){const a=await this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:r})});return a.token&&this.setToken(a.token),a}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async logout(){try{await this.request("/auth/logout",{method:"POST"})}finally{this.clearToken()}}async getProfile(){return this.request("/auth/profile")}async createPODFile(e){return this.request("/pod",{method:"POST",body:JSON.stringify(e)})}async getLoadingSlips(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/loading-slips${r}`)}async getLoadingSlip(e){return this.request(`/loading-slips/${e}`)}async createLoadingSlip(e){return this.request("/loading-slips",{method:"POST",body:JSON.stringify(e)})}async updateLoadingSlip(e,r){return this.request(`/loading-slips/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteLoadingSlip(e){return this.request(`/loading-slips/${e}`,{method:"DELETE"})}async getBills(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/bills${r}`)}async getBill(e){return this.request(`/bills/${e}`)}async createBill(e){return this.request("/bills",{method:"POST",body:JSON.stringify(e)})}async updateBill(e,r){return this.request(`/bills/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteBill(e){return this.request(`/bills/${e}`,{method:"DELETE"})}async markBillAsReceived(e,r){return this.request(`/bills/${e}/received`,{method:"PATCH",body:JSON.stringify(r)})}async getMemos(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/memos${r}`)}async getMemo(e){return this.request(`/memos/${e}`)}async createMemo(e){return this.request("/memos",{method:"POST",body:JSON.stringify(e)})}async updateMemo(e,r){return this.request(`/memos/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteMemo(e){return this.request(`/memos/${e}`,{method:"DELETE"})}async markMemoAsPaid(e,r){return this.request(`/memos/${e}/paid`,{method:"PATCH",body:JSON.stringify(r)})}async getBankingEntries(){return this.request("/banking")}async getCashbookEntries(){return this.request("/cashbook")}async createBankingEntry(e){return this.request("/banking",{method:"POST",body:JSON.stringify(e)})}async createCashbookEntry(e){return this.request("/cashbook",{method:"POST",body:JSON.stringify(e)})}async deleteCashbookEntry(e){return this.request(`/cashbook/${e}`,{method:"DELETE"})}async updateBankingEntry(e,r){return this.request(`/banking/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteBankingEntry(e){return this.request(`/banking/${e}`,{method:"DELETE"})}async getParties(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/parties${r}`)}async createParty(e){return this.request("/parties",{method:"POST",body:JSON.stringify(e)})}async updateParty(e,r){return this.request(`/parties/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteParty(e){return this.request(`/parties/${e}`,{method:"DELETE"})}async getSuppliers(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/suppliers${r}`)}async createSupplier(e){return this.request("/suppliers",{method:"POST",body:JSON.stringify(e)})}async updateSupplier(e,r){return this.request(`/suppliers/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteSupplier(e){return this.request(`/suppliers/${e}`,{method:"DELETE"})}async getVehicles(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/vehicles${r}`)}async createVehicle(e){return this.request("/vehicles",{method:"POST",body:JSON.stringify(e)})}async updateVehicle(e,r){return this.request(`/vehicles/${e}`,{method:"PUT",body:JSON.stringify(r)})}async deleteVehicle(e){return this.request(`/vehicles/${e}`,{method:"DELETE"})}async getLedgerEntries(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/ledgers${r}`)}async getLedgerSummary(e,r){const a=r?`?ledger_type=${r}`:"";return this.request(`/ledgers/summary/${encodeURIComponent(e)}${a}`)}async createLedgerEntry(e){return this.request("/ledgers",{method:"POST",body:JSON.stringify(e)})}async deleteLedgerEntry(e){return this.request(`/ledgers/${e}`,{method:"DELETE"})}async getFuelWallets(){return this.request("/fuel/wallets")}async createFuelWallet(e){return this.request("/fuel/wallets",{method:"POST",body:JSON.stringify(e)})}async getFuelTransactions(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/fuel/transactions${r}`)}async allocateFuel(e){return this.request("/fuel/allocate",{method:"POST",body:JSON.stringify(e)})}async getPODFiles(e){const r=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/pod${r}`)}async uploadPODFile(e){return this.request("/pod",{method:"POST",body:JSON.stringify(e)})}async deletePODFile(e){return this.request(`/pod/${e}`,{method:"DELETE"})}}const Fe=new Lu(Su),rc=n=>{var e,r;return console.error("API Error:",n),(e=n.message)!=null&&e.includes("401")||(r=n.message)!=null&&r.includes("Unauthorized")?(Fe.clearToken(),window.location.href="/login","Session expired. Please login again."):n.message||"An unexpected error occurred"},Mc=pe.createContext(null),Rc=({children:n})=>{const[e,r]=pe.useState([]),[a,s]=pe.useState([]),[i,l]=pe.useState([]),[u,c]=pe.useState([]),[m,b]=pe.useState([]),[w,y]=pe.useState([]),[p,_]=pe.useState([]),[j,B]=pe.useState([]),[v,L]=pe.useState([]),[q,G]=pe.useState([{id:"1",name:"BPCL",balance:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"2",name:"HPCL",balance:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"3",name:"IOCL",balance:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"4",name:"Shell",balance:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]),[K,$]=pe.useState([]),[Q,X]=pe.useState([]),[se,Y]=pe.useState([]),I={loadingSlips:e,memos:a,bills:i,bankingEntries:u,cashbookEntries:m,ledgerEntries:w,parties:p,suppliers:j,vehicles:v,fuelWallets:q,fuelTransactions:K,vehicleFuelExpenses:Q,podFiles:se,setBankingEntries:h=>c(h),setBills:h=>l(h),setMemos:h=>s(h),setLoadingSlips:h=>r(h),setLedgerEntries:h=>y(h),addLoadingSlip:h=>{r(g=>[h,...g])},updateLoadingSlip:h=>{r(g=>g.map(S=>S.id===h.id?h:S))},deleteLoadingSlip:h=>{r(g=>g.filter(S=>S.id!==h)),s(g=>g.filter(S=>S.loading_slip_id!==h)),l(g=>g.filter(S=>S.loading_slip_id!==h)),y(g=>g.filter(S=>S.loading_slip_id!==h))},addMemo:h=>{s(F=>[h,...F]);const g=e.find(F=>F.id===h.loading_slip_id),S=v.find(F=>F.vehicle_no===(g==null?void 0:g.vehicle_no)),D=(S==null?void 0:S.ownership_type)==="own";if(console.log("ðŸš› MEMO CREATION DEBUG:",{memo:h.memo_number,vehicle:g==null?void 0:g.vehicle_no,vehicleFound:!!S,ownership:S==null?void 0:S.ownership_type,isOwn:D,supplier:h.supplier,willCreateSupplierEntry:!D,allVehicles:v.map(F=>({no:F.vehicle_no,ownership:F.ownership_type}))}),D){console.log("âœ… Own vehicle detected - creating vehicle income only, NO supplier entry");const F=h.freight-(h.commission||0)-(h.mamool||0),R=[{id:`${h.id}-vehicle-income`,ledger_type:"vehicle_income",reference_id:h.memo_number,reference_name:`Vehicle ${g==null?void 0:g.vehicle_no} - Net Freight`,date:h.date,description:`Net freight from memo ${h.memo_number} (after commission & mamool)`,debit:0,credit:F,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no}];if(h.detention&&h.detention>0){const J={id:`${h.id}-detention`,ledger_type:"vehicle_income",reference_id:h.memo_number,reference_name:`Vehicle ${g==null?void 0:g.vehicle_no} - Detention`,date:h.date,description:`Detention charges from memo ${h.memo_number}`,debit:0,credit:h.detention,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};R.push(J)}if(h.extra&&h.extra>0){const J={id:`${h.id}-extra`,ledger_type:"vehicle_income",reference_id:h.memo_number,reference_name:`Vehicle ${g==null?void 0:g.vehicle_no} - Extra Charges`,date:h.date,description:`Extra charges from memo ${h.memo_number}`,debit:0,credit:h.extra,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};R.push(J)}y(J=>[...R,...J])}else{console.log("ðŸ“‹ Market vehicle detected - creating supplier entry");const F=h.freight-(h.commission||0)-(h.mamool||0)+(h.detention||0)+(h.extra||0),A={id:`${h.id}-supplier`,ledger_type:"supplier",reference_id:h.memo_number,reference_name:h.supplier,date:h.date,description:"Market vehicle memo - supplier amount",debit:0,credit:F,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};y(R=>[A,...R])}},updateMemo:h=>{s(F=>F.map(A=>A.id===h.id?h:A));const g=e.find(F=>F.id===h.loading_slip_id),S=v.find(F=>F.vehicle_no===(g==null?void 0:g.vehicle_no)),D=(S==null?void 0:S.ownership_type)==="own";if(y(F=>F.filter(A=>{var R;return!(A.memo_number===h.memo_number||A.reference_id===h.memo_number||(R=A.id)!=null&&R.startsWith(`${h.id}-`))})),D){const F=h.freight-(h.commission||0)-(h.mamool||0),R=[{id:`${h.id}-vehicle-income`,ledger_type:"vehicle_income",reference_id:h.memo_number,reference_name:`Vehicle ${g==null?void 0:g.vehicle_no} - Net Freight`,date:h.date,description:`Net freight from memo ${h.memo_number} (after commission & mamool)`,debit:0,credit:F,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no}];if(h.detention&&h.detention>0){const J={id:`${h.id}-detention`,ledger_type:"vehicle_income",reference_id:h.memo_number,reference_name:`Vehicle ${g==null?void 0:g.vehicle_no} - Detention`,date:h.date,description:`Detention charges from memo ${h.memo_number}`,debit:0,credit:h.detention,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};R.push(J)}if(h.extra&&h.extra>0){const J={id:`${h.id}-extra`,ledger_type:"vehicle_income",reference_id:h.memo_number,reference_name:`Vehicle ${g==null?void 0:g.vehicle_no} - Extra Charges`,date:h.date,description:`Extra charges from memo ${h.memo_number}`,debit:0,credit:h.extra,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};R.push(J)}y(J=>[...R,...J])}else{const F=h.freight-(h.commission||0)-(h.mamool||0)+(h.detention||0)+(h.extra||0),A={id:`${h.id}-supplier`,ledger_type:"supplier",reference_id:h.memo_number,reference_name:h.supplier,date:h.date,description:"Market vehicle memo - supplier amount",debit:0,credit:F,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,memo_number:h.memo_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};y(R=>[A,...R])}},deleteMemo:h=>{const g=a.find(S=>S.id===h);s(S=>S.filter(D=>D.id!==h)),y(S=>S.filter(D=>{var F;return!(D.memo_number===(g==null?void 0:g.memo_number)||D.reference_id===(g==null?void 0:g.memo_number)||(F=D.id)!=null&&F.startsWith(`${h}-`))}))},markMemoAsPaid:(h,g,S)=>{s(D=>D.map(F=>F.id===h?{...F,paid_date:g,paid_amount:S,status:"paid",is_paid:!0}:F))},addBill:h=>{l(A=>[h,...A]);const g=e.find(A=>A.id===h.loading_slip_id);if(h.pod_image){const A={id:`${h.id}-pod`,filename:`POD_${h.bill_number}.jpg`,fileData:h.pod_image,fileType:"image/jpeg",billNo:h.bill_number,vehicleNo:g==null?void 0:g.vehicle_no,party:h.party,uploadDate:new Date().toISOString(),created_at:new Date().toISOString()};Y(R=>[A,...R])}const S=h.bill_amount+(h.detention||0)+(h.extra||0)+(h.rto||0)-(h.mamool||0)-(h.penalties||0)-(h.tds||0),F=[{id:`${h.id}-party`,ledger_type:"party",reference_id:h.bill_number,reference_name:h.party,date:h.date,description:`Bill ${h.bill_number} - ${h.party}`,debit:S,credit:0,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,bill_number:h.bill_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no}];if(h.tds&&h.tds>0){const A={id:`${h.id}-tds`,ledger_type:"general",reference_id:h.bill_number,reference_name:"TDS A/C",date:h.date,description:`TDS deducted from Bill ${h.bill_number} - ${h.party}`,debit:h.tds,credit:0,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,bill_number:h.bill_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};F.push(A)}y(A=>[...F,...A])},updateBill:h=>{l(A=>A.map(R=>R.id===h.id?h:R));const g=e.find(A=>A.id===h.loading_slip_id);if(h.pod_image){const A=se.findIndex(J=>J.id===`${h.id}-pod`),R={id:`${h.id}-pod`,filename:`POD_${h.bill_number}.jpg`,fileData:h.pod_image,fileType:"image/jpeg",billNo:h.bill_number,vehicleNo:g==null?void 0:g.vehicle_no,party:h.party,uploadDate:new Date().toISOString(),created_at:new Date().toISOString()};A>=0?Y(J=>J.map((re,ve)=>ve===A?R:re)):Y(J=>[R,...J])}y(A=>A.filter(R=>!R.bill_number||R.bill_number!==h.bill_number));const S=h.bill_amount+(h.detention||0)+(h.extra||0)+(h.rto||0)-(h.mamool||0)-(h.penalties||0)-(h.tds||0),F=[{id:`${h.id}-party`,ledger_type:"party",reference_id:h.bill_number,reference_name:h.party,date:h.date,description:`Bill ${h.bill_number} - ${h.party}`,debit:S,credit:0,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,bill_number:h.bill_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no}];if(h.tds&&h.tds>0){const A={id:`${h.id}-tds`,ledger_type:"general",reference_id:h.bill_number,reference_name:"TDS A/C",date:h.date,description:`TDS deducted from Bill ${h.bill_number} - ${h.party}`,debit:h.tds,credit:0,balance:0,created_at:new Date().toISOString(),loading_slip_id:h.loading_slip_id,bill_number:h.bill_number,from_location:g==null?void 0:g.from_location,to_location:g==null?void 0:g.to_location,vehicle_no:g==null?void 0:g.vehicle_no};F.push(A)}y(A=>[...F,...A])},deleteBill:h=>{const g=i.find(S=>S.id===h);l(S=>S.filter(D=>D.id!==h)),y(S=>S.filter(D=>!D.bill_number||D.bill_number!==(g==null?void 0:g.bill_number)))},markBillAsReceived:(h,g,S)=>{l(D=>D.map(F=>F.id===h?{...F,received_date:g,received_amount:S,status:"received",is_received:!0}:F))},addBankingEntry:h=>{if(c(g=>g.some(D=>D.id===h.id)?g:[h,...g]),h.category==="memo_advance"&&h.reference_id){const g={id:`${h.id}-advance`,memo_id:h.reference_id,date:h.date,amount:h.amount,mode:h.payment_mode==="cash"?"cash":"bank",reference:h.narration,description:`Advance payment via ${h.type==="debit"?"bank debit":"bank credit"}`,created_at:new Date().toISOString()};s(S=>S.map(D=>D.memo_number===h.reference_id?{...D,advance_payments:[...D.advance_payments||[],g]}:D)),c(S=>S.map(D=>D.id===h.id?{...D,memo_advance_id:g.id}:D));return}if(h.category==="bill_advance"&&h.reference_id){const g={id:`${h.id}-advance`,bill_id:h.reference_id,date:h.date,amount:h.amount,mode:h.payment_mode==="cash"?"cash":"bank",reference:h.narration,description:`Advance payment via ${h.type==="debit"?"bank debit":"bank credit"}`,created_at:new Date().toISOString()};l(S=>S.map(D=>D.bill_number===h.reference_id?{...D,advance_payments:[...D.advance_payments||[],g]}:D)),c(S=>S.map(D=>D.id===h.id?{...D,bill_advance_id:g.id}:D));return}if(!["memo_payment","bill_payment"].includes(h.category)){if(h.vehicle_no&&h.category==="vehicle_expense"){const g=v.find(D=>D.vehicle_no===h.vehicle_no);if((g==null?void 0:g.ownership_type)==="own"){const D={id:`${h.id}-vehicle-expense`,referenceId:h.id,reference_id:h.id,ledger_type:"vehicle_expense",reference_name:`Vehicle ${h.vehicle_no} - Expense`,source_type:"banking",type:"expense",date:h.date,description:h.narration||"Vehicle expense",debit:h.amount,credit:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no};y(F=>[D,...F]);return}}if(h.type==="debit"&&h.category==="fuel_wallet"){const g={id:`${h.id}-fuel-tx`,wallet_name:h.narration||"BPCL",type:"wallet_credit",amount:h.amount,date:h.date,narration:`Bank debit for fuel - ${h.narration}`,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no};$(F=>[g,...F]);const S=h.narration||"BPCL",D=q.find(F=>F.name===S);G(D?F=>F.map(A=>A.name===S?{...A,balance:A.balance+h.amount}:A):F=>[...F,{id:`wallet-${Date.now()}`,name:S,balance:h.amount,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);return}if(h.reference_name&&h.reference_name.trim()&&!["fuel_wallet","vehicle_expense","vehicle_credit_note"].includes(h.category)){const g=h.reference_name.trim(),S={id:`${h.id}-person-ledger`,ledger_type:"general",reference_id:h.id,reference_name:g,date:h.date,description:`${h.type==="debit"?"Payment to":"Receipt from"} ${g} - ${h.narration||h.category}`,debit:h.type==="debit"?h.amount:0,credit:h.type==="credit"?h.amount:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no,source_type:"banking"};y(D=>[S,...D])}else{const g={id:`${h.id}-ledger`,ledger_type:"general",reference_id:h.id,reference_name:h.reference_name||h.category||"Other Income",date:h.date,description:h.narration||h.category,debit:h.type==="debit"?h.amount:0,credit:h.type==="credit"?h.amount:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no,source_type:"banking"};y(S=>[g,...S]);try{Fe.createLedgerEntry(g).then(()=>{console.log("âœ… General ledger entry saved to backend:",g)}).catch(S=>{console.error("âŒ Failed to save general ledger entry:",S)})}catch(S){console.error("âŒ Error saving general ledger entry:",S)}}}},updateBankingEntry:(h,g)=>{const S=u.find(D=>D.id===h);if(c(D=>D.map(F=>F.id===h?g:F)),S&&(y(D=>D.filter(F=>F.reference_id!==g.id||F.source_type!=="banking")),S.type==="debit"&&S.category==="fuel_wallet")){const D=S.narration||"BPCL";G(F=>F.map(A=>A.name===D?{...A,balance:A.balance-S.amount}:A)),$(F=>F.filter(A=>A.id!==`${S.id}-fuel-tx`))}if(g.category==="memo_advance"&&g.reference_id){S!=null&&S.memo_advance_id&&s(F=>F.map(A=>{var R,J;return(R=A.advance_payments)!=null&&R.some(re=>re.id===S.memo_advance_id)?{...A,advance_payments:(J=A.advance_payments)==null?void 0:J.filter(re=>re.id!==S.memo_advance_id)}:A}));const D={id:`${g.id}-advance`,memo_id:g.reference_id,date:g.date,amount:g.amount,mode:g.payment_mode==="cash"?"cash":"bank",reference:g.narration,description:`Advance payment via ${g.type==="debit"?"bank debit":"bank credit"}`,created_at:new Date().toISOString()};s(F=>F.map(A=>{var R;return A.memo_number===g.reference_id?{...A,advance_payments:[...((R=A.advance_payments)==null?void 0:R.filter(J=>J.id!==`${g.id}-advance`))||[],D]}:A})),c(F=>F.map(A=>A.id===g.id?{...A,memo_advance_id:D.id}:A));return}if(g.category==="bill_advance"&&g.reference_id){S!=null&&S.bill_advance_id&&l(F=>F.map(A=>{var R,J;return(R=A.advance_payments)!=null&&R.some(re=>re.id===S.bill_advance_id)?{...A,advance_payments:(J=A.advance_payments)==null?void 0:J.filter(re=>re.id!==S.bill_advance_id)}:A}));const D={id:`${g.id}-advance`,bill_id:g.reference_id,date:g.date,amount:g.amount,mode:g.payment_mode==="cash"?"cash":"bank",reference:g.narration,description:`Advance payment via ${g.type==="debit"?"bank debit":"bank credit"}`,created_at:new Date().toISOString()};l(F=>F.map(A=>{var R;return A.bill_number===g.reference_id?{...A,advance_payments:[...((R=A.advance_payments)==null?void 0:R.filter(J=>J.id!==`${g.id}-advance`))||[],D]}:A})),c(F=>F.map(A=>A.id===g.id?{...A,bill_advance_id:D.id}:A));return}if(!["memo_payment","bill_payment"].includes(g.category)){if(g.vehicle_no&&g.category==="vehicle_expense"){const D=v.find(A=>A.vehicle_no===g.vehicle_no);if((D==null?void 0:D.ownership_type)==="own"){const A={id:`${g.id}-vehicle-expense`,ledger_type:"vehicle_expense",reference_id:g.id,reference_name:`Vehicle ${g.vehicle_no} - Expense`,date:g.date,description:g.narration||"Vehicle expense",debit:g.amount,credit:0,balance:0,created_at:new Date().toISOString(),vehicle_no:g.vehicle_no};y(R=>[A,...R]);return}}if(g.type==="debit"&&g.category==="fuel_wallet"){const D={id:`${g.id}-fuel-tx`,wallet_name:g.narration||"BPCL",type:"wallet_credit",amount:g.amount,date:g.date,narration:`Bank debit for fuel - ${g.narration}`,created_at:new Date().toISOString(),vehicle_no:g.vehicle_no};$(R=>[D,...R]);const F=g.narration||"BPCL",A=q.find(R=>R.name===F);G(A?R=>R.map(J=>J.name===F?{...J,balance:J.balance+g.amount}:J):R=>[...R,{id:`wallet-${Date.now()}`,name:F,balance:g.amount,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);return}if(g.reference_name&&g.reference_name.trim()&&!["fuel_wallet","vehicle_expense","vehicle_credit_note"].includes(g.category)){const D=g.reference_name.trim(),F={id:`${g.id}-person-ledger`,ledger_type:"general",reference_id:g.id,reference_name:D,date:g.date,description:`${g.type==="debit"?"Payment to":"Receipt from"} ${D} - ${g.narration||g.category}`,debit:g.type==="debit"?g.amount:0,credit:g.type==="credit"?g.amount:0,balance:0,created_at:new Date().toISOString(),vehicle_no:g.vehicle_no,source_type:"banking"};y(A=>[F,...A])}else{const D={id:`${g.id}-ledger`,ledger_type:"general",reference_id:g.id,reference_name:g.category,date:g.date,description:g.narration||g.category,debit:g.type==="debit"?g.amount:0,credit:g.type==="credit"?g.amount:0,balance:0,source_type:"banking",created_at:new Date().toISOString()};y(F=>[D,...F])}}},deleteBankingEntry:h=>{const g=u.find(S=>S.id===h);if(c(S=>S.filter(D=>D.id!==h)),y(S=>S.filter(D=>!(D.reference_id===h&&D.source_type==="banking"))),g&&g.type==="debit"&&g.category==="fuel_wallet"){const S=g.narration||"BPCL";q.find(F=>F.name===S)&&G(F=>F.map(A=>A.name===S?{...A,balance:A.balance-g.amount}:A)),$(F=>F.filter(A=>A.id!==`${g.id}-fuel-tx`))}g&&g.memo_advance_id&&s(S=>S.map(D=>{var F,A;return(F=D.advance_payments)!=null&&F.some(R=>R.id===g.memo_advance_id)?{...D,advance_payments:(A=D.advance_payments)==null?void 0:A.filter(R=>R.id!==g.memo_advance_id)}:D})),g&&g.bill_advance_id&&l(S=>S.map(D=>{var F,A;return(F=D.advance_payments)!=null&&F.some(R=>R.id===g.bill_advance_id)?{...D,advance_payments:(A=D.advance_payments)==null?void 0:A.filter(R=>R.id!==g.bill_advance_id)}:D}))},addCashbookEntry:h=>{if(b(g=>[h,...g]),h.vehicle_no&&h.category==="vehicle_expense"){const g=v.find(D=>D.vehicle_no===h.vehicle_no);if((g==null?void 0:g.ownership_type)==="own"){const D={id:`${h.id}-vehicle-expense`,referenceId:h.id,reference_id:h.id,ledger_type:"vehicle_expense",reference_name:`Vehicle ${h.vehicle_no} - Cash Expense`,source_type:"cashbook",type:"expense",date:h.date,description:h.narration||"Vehicle cash expense",debit:h.amount,credit:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no};y(F=>[D,...F]);return}}if(h.reference_name&&h.reference_name.trim()&&!["fuel_wallet","vehicle_expense","vehicle_credit_note"].includes(h.category)){const g=h.reference_name.trim(),S={id:`${h.id}-person-ledger`,ledger_type:"general",reference_id:h.id,reference_name:g,date:h.date,description:`${h.type==="debit"?"Cash payment to":"Cash receipt from"} ${g} - ${h.narration||h.category}`,debit:h.type==="debit"?h.amount:0,credit:h.type==="credit"?h.amount:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no,source_type:"cashbook"};y(D=>[S,...D])}else{const g={id:`${h.id}-ledger`,ledger_type:"general",reference_id:h.id,reference_name:h.reference_name||h.category||"Cash Transaction",date:h.date,description:h.narration||h.category,debit:h.type==="debit"?h.amount:0,credit:h.type==="credit"?h.amount:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no,source_type:"cashbook"};y(S=>[g,...S])}},updateCashbookEntry:h=>{if(b(g=>g.map(S=>S.id===h.id?h:S)),y(g=>g.filter(S=>S.reference_id!==h.id||S.source_type!=="cashbook")),h.vehicle_no&&h.category==="vehicle_expense"){const g=v.find(D=>D.vehicle_no===h.vehicle_no);if((g==null?void 0:g.ownership_type)==="own"){const D={id:`${h.id}-vehicle-expense`,referenceId:h.id,reference_id:h.id,ledger_type:"vehicle_expense",reference_name:`Vehicle ${h.vehicle_no} - Expense`,source_type:"cashbook",type:"expense",date:h.date,description:h.narration||"Vehicle expense",debit:h.amount,credit:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no};y(F=>[D,...F]);return}}if(h.reference_name&&h.reference_name.trim()&&!["fuel_wallet","vehicle_expense","vehicle_credit_note"].includes(h.category)){const g=h.reference_name.trim(),S={id:`${h.id}-person-ledger`,ledger_type:"general",reference_id:h.id,reference_name:g,date:h.date,description:`${h.type==="debit"?"Cash payment to":"Cash receipt from"} ${g} - ${h.narration||h.category}`,debit:h.type==="debit"?h.amount:0,credit:h.type==="credit"?h.amount:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h.vehicle_no,source_type:"cashbook"};y(D=>[S,...D])}else{const g={id:`${h.id}-ledger`,ledger_type:"general",reference_id:h.id,reference_name:h.category,date:h.date,description:h.narration||h.category,debit:h.type==="debit"?h.amount:0,credit:h.type==="credit"?h.amount:0,balance:0,source_type:"cashbook",source_id:h.id,created_at:new Date().toISOString()};y(S=>[g,...S])}},deleteCashbookEntry:h=>{b(g=>g.filter(S=>S.id!==h)),y(g=>g.filter(S=>!(S.source_id===h&&S.source_type==="cashbook")))},addParty:h=>_(g=>[h,...g]),updateParty:h=>_(g=>g.map(S=>S.id===h.id?h:S)),deleteParty:h=>_(g=>g.filter(S=>S.id!==h)),addSupplier:h=>B(g=>[h,...g]),updateSupplier:h=>B(g=>g.map(S=>S.id===h.id?h:S)),deleteSupplier:h=>B(g=>g.filter(S=>S.id!==h)),addVehicle:h=>L(g=>[h,...g]),updateVehicle:h=>L(g=>g.map(S=>S.id===h.id?h:S)),deleteVehicle:h=>L(g=>g.filter(S=>S.id!==h)),setVehicles:h=>L(h),addFuelWallet:h=>G(g=>[h,...g]),setFuelWallets:h=>G(h),getFuelWalletBalance:h=>{const g=q.find(S=>S.name===h);return g?g.balance:0},getVehicleFuelExpenses:h=>Q.filter(g=>g.vehicle_no===h),addPODFile:h=>{Y(g=>[h,...g])},deletePODFile:h=>{Y(g=>g.filter(S=>S.id!==h))},getPODFiles:()=>se,allocateFuelToVehicle:async(h,g,S,D,F,A,R,J)=>{try{const ve=await Fe.allocateFuel({vehicle_no:h,wallet_name:g,amount:S,date:D,narration:F||`Fuel allocation from ${g}`,fuel_quantity:A,rate_per_liter:R,odometer_reading:J});if(console.log("âœ… Fuel allocated successfully via backend:",ve),ve.transaction){const V={id:ve.transaction._id||Date.now().toString(),vehicle_no:h,wallet_name:g,amount:S,date:D,narration:F||`Fuel allocation from ${g}`,fuel_quantity:A,rate_per_liter:R,odometer_reading:J,created_at:new Date().toISOString()};X(ee=>[V,...ee])}ve.wallet&&G(V=>V.map(ee=>ee.name===g?{...ee,balance:ve.wallet.balance}:ee));const k=v.find(V=>V.vehicle_no===h),z=(k==null?void 0:k.ownership_type)==="own";if(console.log("ðŸš› Fuel allocation debug:",{vehicleNo:h,vehicle:k==null?void 0:k.vehicle_no,ownership:k==null?void 0:k.ownership_type,isOwnVehicle:z,amount:S}),z){const V={id:`${ve.transaction._id||Date.now()}-ledger`,referenceId:ve.transaction._id||Date.now().toString(),reference_id:ve.transaction._id||Date.now().toString(),ledger_type:"vehicle_expense",reference_name:`Vehicle ${h} - Fuel Expense`,source_type:"fuel",type:"expense",date:D,description:`Fuel expense for vehicle ${h} from ${g}`,debit:S,credit:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h};y(ee=>[V,...ee]),console.log("âœ… Created fuel expense ledger entry:",V)}console.log("ðŸ”„ Triggering data sync after successful fuel allocation"),window.dispatchEvent(new CustomEvent("data-sync-required"));try{const V=await Fe.getLedgerEntries();V.ledgerEntries&&(y(V.ledgerEntries),console.log("âœ… Manually refreshed ledger entries after fuel allocation:",V.ledgerEntries.length))}catch(V){console.error("âŒ Failed to manually sync ledger entries:",V)}}catch(ve){console.error("âŒ Failed to allocate fuel via backend:",ve);const k={id:Date.now().toString(),vehicle_no:h,wallet_name:g,amount:S,date:D,narration:F||`Fuel allocation from ${g}`,fuel_quantity:A,rate_per_liter:R,odometer_reading:J,created_at:new Date().toISOString()};X(ee=>[k,...ee]),G(ee=>ee.map(W=>W.name===g?{...W,balance:W.balance-S}:W));const z=v.find(ee=>ee.vehicle_no===h);if((z==null?void 0:z.ownership_type)==="own"){const ee={id:`${k.id}-ledger`,referenceId:k.id,reference_id:k.id,ledger_type:"vehicle_expense",reference_name:`Vehicle ${h} - Fuel Expense`,source_type:"fuel",type:"expense",date:D,description:`Fuel expense for vehicle ${h} from ${g}`,debit:S,credit:0,balance:0,created_at:new Date().toISOString(),vehicle_no:h};y(W=>[ee,...W]);try{Fe.createLedgerEntry(ee).then(()=>{console.log("âœ… Fuel expense ledger entry saved to backend:",ee)}).catch(W=>{console.error("âŒ Failed to save fuel expense ledger entry:",W)})}catch(W){console.error("âŒ Error creating fuel expense ledger entry:",W)}}console.log("ðŸ”„ Triggering data sync after fallback fuel allocation"),window.dispatchEvent(new CustomEvent("data-sync-required"))}const re={id:`fuel-tx-${Date.now()}`,type:"fuel_allocation",wallet_name:g,amount:S,date:D,vehicle_no:h,narration:F||`Fuel allocation from ${g}`,created_at:new Date().toISOString()};$(ve=>[re,...ve])},bulkPaySupplierMemos:(h,g,S,D,F,A,R,J)=>{const re={id:J||`bulk-pay-supplier-${Date.now()}`,date:D,type:"debit",category:"supplier_payment",amount:S,narration:R||`Bulk payment to ${h} for ${g.length} memos`,bank_account:F,payment_mode:A,created_at:new Date().toISOString()};c(k=>[re,...k]),s(k=>k.map(z=>g.includes(z.id)?{...z,paid_date:D,paid_amount:S/g.length}:z));const ve={id:`${re.id}-supplier-ledger`,ledger_type:"supplier",reference_id:re.id,reference_name:h,date:D,description:`Bulk payment to ${h}`,debit:S,credit:0,balance:0,created_at:new Date().toISOString()};y(k=>[ve,...k])},bulkPayBills:(h,g,S,D,F,A,R)=>{const J={id:`bulk-pay-bills-${Date.now()}`,date:D,type:"credit",category:"bill_payment",amount:S,narration:R||`Bulk payment from ${h} for ${g.length} bills`,bank_account:F,payment_mode:A,created_at:new Date().toISOString()};c(ve=>[J,...ve]),l(ve=>ve.map(k=>g.includes(k.id)?{...k,received_date:D,received_amount:S/g.length}:k));const re={id:`${J.id}-party-ledger`,ledger_type:"party",reference_id:J.id,reference_name:h,date:D,description:`Bulk payment from ${h}`,debit:0,credit:S,balance:0,created_at:new Date().toISOString()};y(ve=>[re,...ve])},setCashbookEntries:h=>b(h),setPODFiles:h=>Y(h),cleanupSupplierLedgerForOwnVehicles:()=>{y(h=>h.filter(g=>{if(g.ledger_type!=="supplier")return!0;const S=a.find(A=>A.memo_number===g.memo_number);if(!S)return!0;const D=e.find(A=>A.id===S.loading_slip_id),F=v.find(A=>A.vehicle_no===(D==null?void 0:D.vehicle_no));return(F==null?void 0:F.ownership_type)==="own"?(console.log("ðŸ§¹ Removing incorrect supplier ledger entry for own vehicle:",{memo:S.memo_number,vehicle:D==null?void 0:D.vehicle_no,supplier:S.supplier}),!1):!0}))}};return t.jsx(Mc.Provider,{value:I,children:n})},tr=()=>{const n=pe.useContext(Mc);if(!n)throw new Error("useDataStore must be used within a DataStoreProvider");return n},qc=pe.createContext(null),Au=({children:n})=>{const[e,r]=pe.useState(null),[a,s]=pe.useState(!0);pe.useEffect(()=>{const m=localStorage.getItem("auth_token");m?(Fe.setToken(m),i()):s(!1)},[]);const i=async()=>{try{const m=await Fe.getProfile();r(m.user)}catch(m){console.error("Failed to fetch user profile:",m),Fe.clearToken()}finally{s(!1)}},l=async(m,b)=>{try{const w=await Fe.login(m,b);r(w.user)}catch(w){throw new Error(rc(w))}},u=async()=>{try{await Fe.logout()}catch(m){console.error("Logout error:",m)}finally{r(null)}},c=async m=>{try{const b=await Fe.register(m);r(b.user)}catch(b){throw new Error(rc(b))}};return t.jsx(qc.Provider,{value:{user:e,isLoading:a,login:l,logout:u,register:c},children:n})},zc=()=>{const n=pe.useContext(qc);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},ku=()=>{const n=tr();return pe.useEffect(()=>{const i=async()=>{var l,u;try{if(!localStorage.getItem("auth_token"))return;console.log("Starting comprehensive API sync...");const m=()=>{console.log("Sync event received, refreshing data..."),setTimeout(()=>i(),500)};window.addEventListener("data-sync-required",m);const[b,w,y,p,_,j,B,v,L,q,G]=await Promise.allSettled([Fe.getBills(),Fe.getParties(),Fe.getSuppliers(),Fe.getVehicles(),Fe.getMemos(),Fe.getLoadingSlips(),Fe.getBankingEntries(),Fe.getLedgerEntries(),Fe.getPODFiles(),Fe.getFuelWallets(),Fe.getFuelTransactions()]);if(b.status==="fulfilled"){const K=b.value.bills||[];n.setBills(K),console.log("Bills synced:",K.length)}if(_.status==="fulfilled"){const K=_.value.memos||[];n.setMemos(K),console.log("Memos synced:",K.length)}if(j.status==="fulfilled"){const K=j.value.loadingSlips||[];n.setLoadingSlips(K),console.log("Loading slips synced:",K.length)}if(B.status==="fulfilled"&&n.setBankingEntries(B.value.bankingEntries||[]),w.status==="fulfilled"){const K=w.value.parties||[];console.log("ðŸ¢ Parties synced from backend:",K.length),n.parties.forEach($=>n.deleteParty($.id)),K.forEach($=>n.addParty($))}if(y.status==="fulfilled"){const K=y.value.suppliers||[];console.log("ðŸšš Suppliers synced from backend:",K.length),n.suppliers.forEach($=>n.deleteSupplier($.id)),K.forEach($=>n.addSupplier($))}if(p.status==="fulfilled"){const K=p.value.vehicles||[];console.log("ðŸš› Vehicles synced from backend:",K.length,"Own vehicles:",K.filter($=>$.ownership_type==="own").length),n.setVehicles(K)}if(L.status==="fulfilled"&&(n.podFiles.forEach(K=>n.deletePODFile(K.id)),(l=L.value.podFiles)==null||l.forEach(K=>n.addPODFile(K))),q.status==="fulfilled"){const K=q.value.wallets||[];console.log("â›½ Fuel wallets synced from backend:",K.length),n.setFuelWallets(K)}if(v.status==="fulfilled"){const K=v.value.ledgerEntries||[];console.log("ðŸ“Š Ledger entries synced from backend:",K.length,"Vehicle income entries:",K.filter($=>$.ledger_type==="vehicle_income").length),n.setLedgerEntries(K)}G.status==="fulfilled"&&console.log("Fuel transactions fetched:",(u=G.value.transactions)==null?void 0:u.length),console.log("Complete data synchronization finished - all modules synced including ledger entries")}catch(c){console.error("Failed to sync data from API:",c)}};return i(),()=>{window.removeEventListener("data-sync-required",()=>{})}},[]),{syncAfterCreate:async(i,l)=>{try{switch(i){case"bill":const u=await Fe.createBill(l);n.addBill(u.bill),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"memo":if(console.log("syncAfterCreate memo data received:",l),!l.loading_slip_id)throw console.error("ERROR: loading_slip_id is missing from memo data!"),new Error("loading_slip_id is required for memo creation");const c=await Fe.createMemo(l);n.addMemo(c.memo),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"loadingSlip":const m=await Fe.createLoadingSlip(l);n.addLoadingSlip(m.loadingSlip),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"party":const b=await Fe.createParty(l);n.addParty(b.party),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"supplier":const w=await Fe.createSupplier(l);n.addSupplier(w.supplier),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"vehicle":const y=await Fe.createVehicle(l);n.addVehicle(y.vehicle),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"bankingEntry":const p=await Fe.createBankingEntry(l);n.addBankingEntry(p.bankingEntry),window.dispatchEvent(new CustomEvent("data-sync-required"));break;default:console.warn("Unknown sync type:",i)}}catch(u){console.error(`Failed to create ${i}:`,u);const c=u instanceof Error?u.message:"Unknown error";throw window.dispatchEvent(new CustomEvent("sync-error",{detail:{type:"create",entity:i,error:c}})),u}},syncAfterUpdate:async(i,l,u)=>{try{switch(i){case"bill":const c=await Fe.updateBill(l,u);n.updateBill(c.bill),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"memo":const m=await Fe.updateMemo(l,u);n.updateMemo(m.memo),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"loadingSlip":const b=await Fe.updateLoadingSlip(l,u);n.updateLoadingSlip(b.loadingSlip),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"party":const w=await Fe.updateParty(l,u);n.updateParty(w.party),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"supplier":const y=await Fe.updateSupplier(l,u);n.updateSupplier(y.supplier),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"vehicle":const p=await Fe.updateVehicle(l,u);n.updateVehicle(p.vehicle),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"bankingEntry":const _=await Fe.updateBankingEntry(l,u);n.updateBankingEntry(l,_.bankingEntry),window.dispatchEvent(new CustomEvent("data-sync-required"));break;default:console.warn("Unknown sync type:",i)}}catch(c){console.error(`Failed to update ${i}:`,c);const m=c instanceof Error?c.message:"Unknown error";throw window.dispatchEvent(new CustomEvent("sync-error",{detail:{type:"update",entity:i,error:m}})),c}},syncAfterDelete:async(i,l)=>{try{switch(i){case"bill":await Fe.deleteBill(l),n.deleteBill(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"memo":await Fe.deleteMemo(l),n.deleteMemo(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"loadingSlip":await Fe.deleteLoadingSlip(l),n.deleteLoadingSlip(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"party":await Fe.deleteParty(l),n.deleteParty(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"supplier":await Fe.deleteSupplier(l),n.deleteSupplier(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"vehicle":await Fe.deleteVehicle(l),n.deleteVehicle(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;case"bankingEntry":await Fe.deleteBankingEntry(l),n.deleteBankingEntry(l),window.dispatchEvent(new CustomEvent("data-sync-required"));break;default:console.warn("Unknown sync type:",i)}}catch(u){console.error(`Failed to delete ${i}:`,u);const c=u instanceof Error?u.message:"Unknown error";throw window.dispatchEvent(new CustomEvent("sync-error",{detail:{type:"delete",entity:i,error:c}})),u}},retrySync:async()=>{try{console.log("Retrying data synchronization..."),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(i){console.error("Failed to retry sync:",i)}}}},Cu=()=>{const{login:n,register:e}=zc(),[r,a]=pe.useState(!0),[s,i]=pe.useState({name:"",email:"",password:"",role:"operator"}),[l,u]=pe.useState(!1),[c,m]=pe.useState(""),b=async y=>{y.preventDefault(),u(!0),m("");try{r?await n(s.email,s.password):await e(s)}catch(p){m(p instanceof Error?p.message:"An error occurred")}finally{u(!1)}},w=y=>{i({...s,[y.target.name]:y.target.value})};return t.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[t.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"BRC Transport Management"}),t.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r?"Sign in to your account":"Create a new account"})]})}),t.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:t.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[t.jsxs("form",{className:"space-y-6",onSubmit:b,children:[c&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:c}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),t.jsx("div",{className:"mt-1",children:t.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:s.email,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})})]}),!r&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),t.jsx("div",{className:"mt-1",children:t.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:s.name,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),t.jsx("div",{className:"mt-1",children:t.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:s.password,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})})]}),!r&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Role"}),t.jsx("div",{className:"mt-1",children:t.jsxs("select",{id:"role",name:"role",value:s.role,onChange:w,className:"block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"operator",children:"Operator"}),t.jsx("option",{value:"manager",children:"Manager"}),t.jsx("option",{value:"admin",children:"Admin"})]})})]}),t.jsx("div",{children:t.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:l?"Please wait...":r?"Sign In":"Sign Up"})}),t.jsx("div",{className:"text-center",children:t.jsx("button",{type:"button",onClick:()=>a(!r),className:"text-sm text-blue-600 hover:text-blue-500",children:r?"Don't have an account? Sign up":"Already have an account? Sign in"})})]}),t.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:t.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[t.jsxs("p",{children:["ðŸŒ ",t.jsx("strong",{children:"LAN Access Instructions:"})]}),t.jsxs("p",{children:["1. Start backend: ",t.jsx("code",{children:"cd backend && npm start"})]}),t.jsxs("p",{children:["2. Find your IP: ",t.jsx("code",{children:"ifconfig"})," (Mac/Linux)"]}),t.jsxs("p",{children:["3. Access from any device: ",t.jsx("code",{children:"http://YOUR_IP:3000"})]})]})})]})})]})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ot=(n,e)=>{const r=pe.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:u="",children:c,...m},b)=>pe.createElement("svg",{ref:b,...Pu,width:s,height:s,stroke:a,strokeWidth:l?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Fu(n)}`,u].join(" "),...m},[...e.map(([w,y])=>pe.createElement(w,y)),...Array.isArray(c)?c:[c]]));return r.displayName=`${n}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=ot("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eu=ot("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=ot("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=ot("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=ot("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iu=ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=ot("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=ot("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=ot("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=ot("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=ot("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=ot("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=ot("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=ot("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"8ur5zv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=ot("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=ot("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=ot("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=ot("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=ot("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=ot("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=ot("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=ot("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=ot("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=ot("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=ot("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=ot("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=ot("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Uu="/assets/IMG_8496-D_UWoCQ9.jpg",ni=Uu,Wn={width:50,height:20,x:15,y:8},$u=({children:n,currentPage:e,onNavigate:r})=>{const a=[{id:"dashboard",label:"Dashboard",icon:vr},{id:"loading-slip",label:"Loading Slip",icon:Br},{id:"memo",label:"Memo",icon:Bi},{id:"bills",label:"Bills",icon:Bi},{id:"paid-memo",label:"Paid Memo",icon:Bi},{id:"received-bills",label:"Received Bills",icon:Bi},{id:"banking",label:"Banking",icon:Yn},{id:"cashbook",label:"Cashbook",icon:Yn},{id:"party-ledger",label:"Party Ledgers",icon:Br},{id:"supplier-ledger",label:"Supplier Ledgers",icon:Br},{id:"general-ledger",label:"General Ledgers",icon:Br},{id:"fuel-management",label:"Fuel Management",icon:Ts},{id:"vehicle-ledger",label:"Vehicle Ledger",icon:vr},{id:"vehicle-ownership",label:"Vehicle Ownership",icon:vr},{id:"pod",label:"POD",icon:Eu}];return t.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[t.jsxs("div",{className:"w-64 bg-white shadow-lg",children:[t.jsx("div",{className:"p-6 border-b",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center overflow-hidden",children:[t.jsx("img",{src:ni,alt:"BRC Logo",className:"w-full h-full object-contain",onError:s=>{var l;const i=s.target;i.style.display="none",(l=i.nextElementSibling)==null||l.classList.remove("hidden")}}),t.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center hidden",children:t.jsx(vr,{className:"w-6 h-6 text-white"})})]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"BHAVISHYA ROAD"}),t.jsx("p",{className:"text-sm text-gray-600",children:"CARRIERS"})]})]})}),t.jsx("nav",{className:"p-4",children:t.jsx("ul",{className:"space-y-2",children:a.map(s=>{const i=s.icon;return t.jsx("li",{children:t.jsxs("button",{onClick:()=>r(s.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${e===s.id?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[t.jsx(i,{className:"w-5 h-5"}),t.jsx("span",{className:"font-medium",children:s.label})]})},s.id)})})})]}),t.jsxs("div",{className:"flex-1 flex flex-col",children:[t.jsx("header",{className:"bg-white shadow-sm border-b px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Bhavishya Road Carriers - Logistics Management"}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-green-600",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),t.jsx("span",{children:"LAN Mode - Real-time Sync Active"})]})]})}),t.jsx("main",{className:"flex-1 p-6",children:n})]})]})},me=n=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2}).format(n),ac=()=>{const{memos:n,bills:e,bankingEntries:r,loadingSlips:a,vehicles:s}=tr(),i=(()=>{const y=e.reduce((_,j)=>{const B=j.bill_amount+(j.detention||0)+(j.extra||0)+(j.rto||0)-(j.mamool||0)-(j.penalties||0);return _+B},0),p=n.reduce((_,j)=>_+j.net_amount,0);return y-p})(),l=e.reduce((y,p)=>{const _=r.filter(j=>j.reference_id===p.bill_number&&j.type==="credit").reduce((j,B)=>j+B.amount,0);return y+(p.net_amount-_)},0),u=n.reduce((y,p)=>{const _=a.find(L=>L.id===p.loading_slip_id),j=s.find(L=>L.vehicle_no===(_==null?void 0:_.vehicle_no));if((j==null?void 0:j.ownership_type)!=="market")return y;const B=r.filter(L=>L.reference_id===p.memo_number&&L.type==="debit").reduce((L,q)=>L+q.amount,0),v=p.freight-B-(p.commission||0)-(p.mamool||0)+(p.detention||0)+(p.extra||0);return y+Math.max(0,v)},0),c=e.reduce((y,p)=>y+p.bill_amount,0),m=[{title:"Total Profit (Bill - Memo)",value:me(i),icon:zi,color:"bg-green-50 text-green-700",iconBg:"bg-green-100"},{title:"Party Balance",value:me(l),icon:Hc,color:"bg-blue-50 text-blue-700",iconBg:"bg-blue-100"},{title:"Supplier Balance",value:me(u),icon:vr,color:"bg-orange-50 text-orange-700",iconBg:"bg-orange-100"},{title:"Monthly Revenue",value:me(c),icon:Ou,color:"bg-purple-50 text-purple-700",iconBg:"bg-purple-100"}],b=e.slice(0,5).map((y,p)=>({id:y.id||`bill-${p}-${Date.now()}`,bill_number:y.bill_number,party:y.party,amount:y.net_amount,date:y.date,status:"Pending"})),w=n.slice(0,5).map((y,p)=>({id:y.id||`memo-${p}-${Date.now()}`,memo_number:y.memo_number,supplier:y.supplier,amount:y.net_amount,date:y.date,status:"Pending"}));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsx("input",{type:"month",defaultValue:"2025-08",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:m.map((y,p)=>{const _=y.icon;return t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:y.title}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:y.value})]}),t.jsx("div",{className:`w-12 h-12 rounded-lg ${y.iconBg} flex items-center justify-center`,children:t.jsx(_,{className:`w-6 h-6 ${y.color.split(" ")[1]}`})})]})},`stat-${y.title}-${p}`)})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Bills"})}),t.jsx("div",{className:"p-6",children:b.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(Br,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No recent bills found"})]}):t.jsx("div",{className:"space-y-4",children:b.map(y=>t.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:y.bill_number}),t.jsx("div",{className:"text-sm text-gray-500",children:y.party}),t.jsx("div",{className:"text-xs text-gray-400",children:new Date(y.date).toLocaleDateString("en-IN")})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium text-gray-900",children:me(y.amount)}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.status==="Paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:y.status})]})]},`bill-${y.id}`))})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Memos"})}),t.jsx("div",{className:"p-6",children:w.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(Bi,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No recent memos found"})]}):t.jsx("div",{className:"space-y-4",children:w.map(y=>t.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:y.memo_number}),t.jsx("div",{className:"text-sm text-gray-500",children:y.supplier}),t.jsx("div",{className:"text-xs text-gray-400",children:new Date(y.date).toLocaleDateString("en-IN")})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium text-gray-900",children:me(y.amount)}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.status==="Paid"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:y.status})]})]},`memo-${y.id}`))})})]})]})]})},Vu="modulepreload",Hu=function(n){return"/"+n},ic={},ri=function(e,r,a){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Hu(c),c in ic)return;ic[c]=!0;const m=c.endsWith(".css"),b=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${b}`))return;const w=document.createElement("link");if(w.rel=m?"stylesheet":Vu,m||(w.as="script"),w.crossOrigin="",w.href=c,u&&w.setAttribute("nonce",u),document.head.appendChild(w),m)return new Promise((y,p)=>{w.addEventListener("load",y),w.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return s.then(l=>{for(const u of l||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})},Ja=(n,e,r)=>{if(!n||n.length===0)return`${r}-1`;const a=n.reduce((s,i)=>{const l=i[e];if(typeof l=="string"){let u;if(l.startsWith(r+"-")?u=parseInt(l.substring(r.length+1),10):u=parseInt(l,10),!isNaN(u)&&u>s)return u}return s},0);return`${r}-${a+1}`},Wu=({initialData:n,nextSlipNumber:e,onSubmit:r,onCancel:a})=>{const{parties:s,suppliers:i,vehicles:l,addParty:u,addSupplier:c,addVehicle:m}=tr(),[b,w]=pe.useState({slip_number:n?n.slip_number:e,date:new Date().toISOString().split("T")[0],party:"",vehicle_no:"",from_location:"",to_location:"",material:"",dimension:"",weight:0,supplier:"",freight:0,advance:0,rto:0,narration:""}),[y]=pe.useState(["HAZIRA","HYD","Mumbai","Delhi","Bangalore","Chennai","Pune","Ahmedabad"]),[p,_]=pe.useState(!1),[j,B]=pe.useState(!1),[v,L]=pe.useState(!1),[q,G]=pe.useState(""),[K,$]=pe.useState(""),[Q,X]=pe.useState({vehicle_no:"",vehicle_type:"Truck",ownership_type:"market",owner_name:"",driver_name:"",driver_phone:""}),[se,Y]=pe.useState(!1),[I,h]=pe.useState(!1),[g,S]=pe.useState(!1),[D,F]=pe.useState(!1),[A,R]=pe.useState(!1);pe.useEffect(()=>{n&&w({slip_number:n.slip_number||e,date:n.date?new Date(n.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],party:n.party||"",vehicle_no:n.vehicle_no||"",from_location:n.from_location||"",to_location:n.to_location||"",material:n.material||"",dimension:n.dimension||"",weight:n.weight||0,supplier:n.supplier||"",freight:n.freight||0,advance:n.advance||0,rto:n.rto||0,narration:n.narration||""})},[n,e]);const J=async W=>{if(W.preventDefault(),!l.find(ue=>ue.vehicle_no===b.vehicle_no)){const ue=b.supplier.toLowerCase().includes("bhavishya")||b.supplier.toLowerCase().includes("brc")||b.supplier==="Self"||b.supplier==="Own",Le={vehicle_no:b.vehicle_no.trim(),vehicle_type:"Truck",ownership_type:ue?"own":"market",owner_name:ue?"Bhavishya Road Carriers":b.supplier,driver_name:"",driver_phone:""};try{const Se=await Fe.createVehicle(Le);m(Se.vehicle),console.log("âœ… Vehicle auto-created and saved to backend:",Se.vehicle),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(Se){console.error("âŒ Failed to save vehicle to backend:",Se);const ke={...Le,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};m(ke),console.log("âš ï¸ Vehicle created locally only (backend failed):",ke)}}const ne=b.freight-b.advance,de=b.freight+b.rto;r({...b,balance:ne,total_freight:de})},re=W=>{const{name:ne,value:de,type:ue}=W.target;w(Le=>({...Le,[ne]:ue==="number"?parseFloat(de)||0:de}))},ve=(W,ne)=>{w(de=>({...de,[W]:ne})),Y(!1),h(!1),S(!1),F(!1),R(!1)},k=async()=>{if(q.trim()){const W={name:q.trim(),contact:"",address:""};try{const ne=await Fe.createParty(W);u(ne.party),console.log("âœ… Party auto-created and saved to backend:",ne.party),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(ne){console.error("âŒ Failed to save party to backend:",ne);const de={...W,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};u(de),console.log("âš ï¸ Party created locally only (backend failed):",de)}w(ne=>({...ne,party:q.trim()})),G(""),_(!1)}},z=async()=>{if(K.trim()){const W={name:K.trim(),contact:"",address:""};try{const ne=await Fe.createSupplier(W);c(ne.supplier),console.log("âœ… Supplier auto-created and saved to backend:",ne.supplier),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(ne){console.error("âŒ Failed to save supplier to backend:",ne);const de={...W,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c(de),console.log("âš ï¸ Supplier created locally only (backend failed):",de)}w(ne=>({...ne,supplier:K.trim()})),$(""),B(!1)}},V=async()=>{if(Q.vehicle_no.trim()){const W={...Q,vehicle_no:Q.vehicle_no.trim()};try{const ne=await Fe.createVehicle(W);m(ne.vehicle),console.log("âœ… Vehicle auto-created and saved to backend:",ne.vehicle),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(ne){console.error("âŒ Failed to save vehicle to backend:",ne);const de={...W,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};m(de),console.log("âš ï¸ Vehicle created locally only (backend failed):",de)}w(ne=>({...ne,vehicle_no:Q.vehicle_no.trim()})),X({vehicle_no:"",vehicle_type:"Truck",ownership_type:"market",owner_name:"",driver_name:"",driver_phone:""}),L(!1)}},ee=(W,ne)=>W.reduce((ue,Le)=>{const Se=typeof Le=="string"?Le:Le.vehicle_no;return ue.find(ke=>(typeof ke=="string"?ke:ke.vehicle_no)===Se)||ue.push(Le),ue},[]).filter(ue=>(typeof ue=="string"?ue:ue.vehicle_no||ue.name||"").toLowerCase().includes(ne.toLowerCase()));return t.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Loading Slip":"New Loading Slip"}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-6 h-6"})})]}),t.jsxs("form",{onSubmit:J,className:"p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slip Number"}),t.jsx("input",{type:"text",name:"slip_number",value:b.slip_number,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",name:"date",value:b.date,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Party (M/S)"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"party",value:b.party,onChange:re,onFocus:()=>Y(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>Y(!se)}),se&&t.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[[...new Set(s.map(W=>W.name))].map(W=>t.jsx("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer",onClick:()=>{w(ne=>({...ne,party:W})),Y(!1)},children:W},W)),t.jsx("div",{className:"border-t border-gray-200",children:t.jsx("div",{className:"px-4 py-2 text-blue-600 hover:bg-blue-50 cursor-pointer font-medium",onClick:()=>{_(!0),Y(!1)},children:"+ Add New Party"})})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle No"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"vehicle_no",value:b.vehicle_no,onChange:re,onFocus:()=>S(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>S(!g)}),g&&t.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[ee(l,b.vehicle_no).map((W,ne)=>t.jsxs("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer flex items-center justify-between",onClick:()=>ve("vehicle_no",typeof W=="string"?W:W.vehicle_no),children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{children:typeof W=="string"?W:W.vehicle_no}),typeof W!="string"&&t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${W.ownership_type==="own"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:W.ownership_type==="own"?"Own Vehicle":"Market Vehicle"})]}),typeof W!="string"&&W.vehicle_type&&t.jsx("span",{className:"text-xs text-gray-500",children:W.vehicle_type})]},`vehicle-${W.id||ne}`)),t.jsx("div",{className:"border-t border-gray-200",children:t.jsx("div",{className:"px-4 py-2 text-blue-600 hover:bg-blue-50 cursor-pointer font-medium",onClick:()=>{L(!0),S(!1)},children:"+ Add New Vehicle"})})]})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"supplier",value:b.supplier,onChange:re,onFocus:()=>h(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>h(!I)}),I&&t.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[[...new Set(i.map(W=>W.name))].map(W=>t.jsx("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer",onClick:()=>{w(ne=>({...ne,supplier:W})),h(!1)},children:W},W)),t.jsx("div",{className:"border-t border-gray-200",children:t.jsx("div",{className:"px-4 py-2 text-blue-600 hover:bg-blue-50 cursor-pointer font-medium",onClick:()=>{B(!0),h(!1)},children:"+ Add New Supplier"})})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"from_location",value:b.from_location,onChange:re,onFocus:()=>F(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>F(!D)}),D&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:ee(y,b.from_location).map((W,ne)=>t.jsx("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer",onClick:()=>ve("from_location",W),children:W},`from-${ne}`))})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"to_location",value:b.to_location,onChange:re,onFocus:()=>R(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>R(!A)}),A&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:ee(y,b.to_location).map((W,ne)=>t.jsx("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer",onClick:()=>ve("to_location",W),children:W},`to-${ne}`))})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Material"}),t.jsx("input",{type:"text",name:"material",value:b.material,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Steel Coils, Iron Ore"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dimension"}),t.jsx("input",{type:"text",name:"dimension",value:b.dimension,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 20ft x 8ft x 8ft"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight (MT)"}),t.jsx("input",{type:"number",name:"weight",value:b.weight,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Freight (â‚¹)"}),t.jsx("input",{type:"number",name:"freight",value:b.freight,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Advance (â‚¹)"}),t.jsx("input",{type:"number",name:"advance",value:b.advance,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RTO (â‚¹)"}),t.jsx("input",{type:"number",name:"rto",value:b.rto,onChange:re,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Narration"}),t.jsx("textarea",{name:"narration",value:b.narration,onChange:W=>w(ne=>({...ne,narration:W.target.value})),placeholder:"Enter narration or remarks",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-gray-50 p-4 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balance (Freight - Advance)"}),t.jsx("div",{className:"w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700",children:me(b.freight-b.advance)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Freight (Freight + RTO)"}),t.jsx("div",{className:"w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700",children:me(b.freight+b.rto)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[t.jsx("div",{children:n&&t.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",onClick:()=>console.log("PDF generation not implemented yet"),children:"Generate PDF"})}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[n?"Update":"Create"," Loading Slip"]})]})]})]})]}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Party"}),t.jsx("input",{type:"text",value:q,onChange:W=>G(W.target.value),placeholder:"Enter party name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",autoFocus:!0}),t.jsxs("div",{className:"flex justify-end space-x-3",children:[t.jsx("button",{type:"button",onClick:()=>{_(!1),G("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),t.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!q.trim(),children:"Add Party"})]})]})}),j&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Supplier"}),t.jsx("input",{type:"text",value:K,onChange:W=>$(W.target.value),placeholder:"Enter supplier name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",autoFocus:!0}),t.jsxs("div",{className:"flex justify-end space-x-3",children:[t.jsx("button",{type:"button",onClick:()=>{B(!1),$("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),t.jsx("button",{type:"button",onClick:z,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!K.trim(),children:"Add Supplier"})]})]})}),v&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Vehicle"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Number *"}),t.jsx("input",{type:"text",value:Q.vehicle_no,onChange:W=>X(ne=>({...ne,vehicle_no:W.target.value})),placeholder:"e.g., GJ01AB1234",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Type"}),t.jsxs("select",{value:Q.vehicle_type,onChange:W=>X(ne=>({...ne,vehicle_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"Truck",children:"Truck"}),t.jsx("option",{value:"Trailer",children:"Trailer"}),t.jsx("option",{value:"Container",children:"Container"}),t.jsx("option",{value:"Tanker",children:"Tanker"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ownership Type *"}),t.jsxs("select",{value:Q.ownership_type,onChange:W=>X(ne=>({...ne,ownership_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"market",children:"Market Vehicle"}),t.jsx("option",{value:"own",children:"Own Vehicle"})]})]}),Q.ownership_type==="market"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name"}),t.jsx("input",{type:"text",value:Q.owner_name,onChange:W=>X(ne=>({...ne,owner_name:W.target.value})),placeholder:"Vehicle owner name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Name"}),t.jsx("input",{type:"text",value:Q.driver_name,onChange:W=>X(ne=>({...ne,driver_name:W.target.value})),placeholder:"Driver name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Phone"}),t.jsx("input",{type:"tel",value:Q.driver_phone,onChange:W=>X(ne=>({...ne,driver_phone:W.target.value})),placeholder:"Driver phone number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),t.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[t.jsx("button",{type:"button",onClick:()=>{L(!1),X({vehicle_no:"",vehicle_type:"Truck",ownership_type:"market",owner_name:"",driver_name:"",driver_phone:""})},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),t.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!Q.vehicle_no.trim(),children:"Add Vehicle"})]})]})})]})},Wc=({slip:n,nextMemoNumber:e,initialData:r,onSubmit:a,onCancel:s})=>{const[i,l]=pe.useState({memo_number:(r==null?void 0:r.memo_number)||e||"",loading_slip_id:(r==null?void 0:r.loading_slip_id)||(n==null?void 0:n.id)||"",date:r?r.date.split("T")[0]:new Date().toISOString().split("T")[0],supplier:(r==null?void 0:r.supplier)||(n==null?void 0:n.supplier)||"",freight:(r==null?void 0:r.freight)||(n==null?void 0:n.freight)||0,commission_rate:6,commission:(r==null?void 0:r.commission)||0,mamool:(r==null?void 0:r.mamool)||0,detention:(r==null?void 0:r.detention)||0,extra:(r==null?void 0:r.extra)||0,rto:(r==null?void 0:r.rto)||(n==null?void 0:n.rto)||0,net_amount:(r==null?void 0:r.net_amount)||0,advance_payments:(r==null?void 0:r.advance_payments)||[],status:(r==null?void 0:r.status)||"pending",narration:(r==null?void 0:r.narration)||""});pe.useEffect(()=>{n&&!r&&l(m=>({...m,memo_number:e||"",loading_slip_id:n.id,supplier:n.supplier,freight:n.freight,rto:n.rto||0}))},[n,e,r]),pe.useEffect(()=>{const m=i.freight*(i.commission_rate/100);l(b=>({...b,commission:m}))},[i.freight,i.commission_rate]),pe.useEffect(()=>{const m=i.freight-i.commission-i.mamool+i.detention+i.extra+i.rto;l(b=>({...b,net_amount:m}))},[i.freight,i.commission,i.mamool,i.detention,i.extra,i.rto]);const u=m=>{m.preventDefault(),console.log("Memo form data being submitted:",i),console.log("Loading slip ID:",i.loading_slip_id),a(i)},c=m=>{const{name:b,value:w,type:y}=m.target;l(p=>({...p,[b]:y==="number"?parseFloat(w)||0:w}))};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"New Memo"}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-6 h-6"})})]}),t.jsxs("form",{onSubmit:u,className:"p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Memo Number"}),t.jsx("input",{type:"text",name:"memo_number",value:i.memo_number,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",name:"date",value:i.date,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier"}),t.jsx("input",{type:"text",name:"supplier",value:i.supplier,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Loading Slip Details"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Slip No:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.slip_number})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Vehicle:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.vehicle_no})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Route:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[n.from_location," â†’ ",n.to_location]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Party:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.party})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Material:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.material||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Weight:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[n.weight," MT"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Dimension:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.dimension})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Supplier:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.supplier})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Freight (â‚¹)"}),t.jsx("input",{type:"number",name:"freight",value:i.freight,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commission Rate (%)"}),t.jsx("input",{type:"number",name:"commission_rate",value:i.commission_rate,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0",max:"100"})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commission (â‚¹) â€” auto-fills from rate but editable"}),t.jsx("input",{type:"number",name:"commission",value:i.commission,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Currently ",i.commission_rate,"% of freight = ",me(i.freight*(i.commission_rate/100))]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mamool (â‚¹)"}),t.jsx("input",{type:"number",name:"mamool",value:i.mamool,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detention (â‚¹)"}),t.jsx("input",{type:"number",name:"detention",value:i.detention,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Extra (â‚¹)"}),t.jsx("input",{type:"number",name:"extra",value:i.extra,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RTO (â‚¹)"}),t.jsx("input",{type:"number",name:"rto",value:i.rto,onChange:c,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Narration"}),t.jsx("textarea",{name:"narration",value:i.narration,onChange:m=>l(b=>({...b,narration:m.target.value})),placeholder:"Enter narration or remarks",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx(Uc,{className:"w-5 h-5 text-green-600 mr-2"}),t.jsx("h3",{className:"text-sm font-medium text-green-900",children:"Calculation Summary"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-green-700",children:"Freight:"}),t.jsx("span",{className:"ml-2 font-medium",children:me(i.freight)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-red-700",children:"Commission:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["-",me(i.commission)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-red-700",children:"Mamool:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["-",me(i.mamool)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-green-700",children:"Detention + Extra:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["+",me(i.detention+i.extra)]})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-green-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-green-900 font-medium",children:"Net Amount:"}),t.jsx("span",{className:"text-xl font-bold text-green-900",children:me(i.net_amount)})]})})]}),t.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[t.jsx("div",{}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("button",{type:"button",onClick:s,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Memo"})]})]})]})]})})};function xt(n){"@babel/helpers - typeof";return xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(n)}var cr=Uint8Array,Lr=Uint16Array,wl=Int32Array,Ks=new cr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zs=new cr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),il=new cr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gc=function(n,e){for(var r=new Lr(31),a=0;a<31;++a)r[a]=e+=1<<n[a-1];for(var s=new wl(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)s[i]=i-r[a]<<5|a;return{b:r,r:s}},Yc=Gc(Ks,2),Jc=Yc.b,sl=Yc.r;Jc[28]=258,sl[258]=28;var Xc=Gc(Zs,0),Gu=Xc.b,sc=Xc.r,ol=new Lr(32768);for(var St=0;St<32768;++St){var Vn=(St&43690)>>1|(St&21845)<<1;Vn=(Vn&52428)>>2|(Vn&13107)<<2,Vn=(Vn&61680)>>4|(Vn&3855)<<4,ol[St]=((Vn&65280)>>8|(Vn&255)<<8)>>1}var fn=function(n,e,r){for(var a=n.length,s=0,i=new Lr(e);s<a;++s)n[s]&&++i[n[s]-1];var l=new Lr(e);for(s=1;s<e;++s)l[s]=l[s-1]+i[s-1]<<1;var u;if(r){u=new Lr(1<<e);var c=15-e;for(s=0;s<a;++s)if(n[s])for(var m=s<<4|n[s],b=e-n[s],w=l[n[s]-1]++<<b,y=w|(1<<b)-1;w<=y;++w)u[ol[w]>>c]=m}else for(u=new Lr(a),s=0;s<a;++s)n[s]&&(u[s]=ol[l[n[s]-1]++]>>15-n[s]);return u},Jn=new cr(288);for(var St=0;St<144;++St)Jn[St]=8;for(var St=144;St<256;++St)Jn[St]=9;for(var St=256;St<280;++St)Jn[St]=7;for(var St=280;St<288;++St)Jn[St]=8;var Ui=new cr(32);for(var St=0;St<32;++St)Ui[St]=5;var Yu=fn(Jn,9,0),Ju=fn(Jn,9,1),Xu=fn(Ui,5,0),Ku=fn(Ui,5,1),Vo=function(n){for(var e=n[0],r=1;r<n.length;++r)n[r]>e&&(e=n[r]);return e},Yr=function(n,e,r){var a=e/8|0;return(n[a]|n[a+1]<<8)>>(e&7)&r},Ho=function(n,e){var r=e/8|0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>(e&7)},Nl=function(n){return(n+7)/8|0},Kc=function(n,e,r){return(r==null||r>n.length)&&(r=n.length),new cr(n.subarray(e,r))},Zu=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Xr=function(n,e,r){var a=new Error(e||Zu[n]);if(a.code=n,Error.captureStackTrace&&Error.captureStackTrace(a,Xr),!r)throw a;return a},Qu=function(n,e,r,a){var s=n.length,i=0;if(!s||e.f&&!e.l)return r||new cr(0);var l=!r,u=l||e.i!=2,c=e.i;l&&(r=new cr(s*3));var m=function(Se){var ke=r.length;if(Se>ke){var De=new cr(Math.max(ke*2,Se));De.set(r),r=De}},b=e.f||0,w=e.p||0,y=e.b||0,p=e.l,_=e.d,j=e.m,B=e.n,v=s*8;do{if(!p){b=Yr(n,w,1);var L=Yr(n,w+1,3);if(w+=3,L)if(L==1)p=Ju,_=Ku,j=9,B=5;else if(L==2){var $=Yr(n,w,31)+257,Q=Yr(n,w+10,15)+4,X=$+Yr(n,w+5,31)+1;w+=14;for(var se=new cr(X),Y=new cr(19),I=0;I<Q;++I)Y[il[I]]=Yr(n,w+I*3,7);w+=Q*3;for(var h=Vo(Y),g=(1<<h)-1,S=fn(Y,h,1),I=0;I<X;){var D=S[Yr(n,w,g)];w+=D&15;var q=D>>4;if(q<16)se[I++]=q;else{var F=0,A=0;for(q==16?(A=3+Yr(n,w,3),w+=2,F=se[I-1]):q==17?(A=3+Yr(n,w,7),w+=3):q==18&&(A=11+Yr(n,w,127),w+=7);A--;)se[I++]=F}}var R=se.subarray(0,$),J=se.subarray($);j=Vo(R),B=Vo(J),p=fn(R,j,1),_=fn(J,B,1)}else Xr(1);else{var q=Nl(w)+4,G=n[q-4]|n[q-3]<<8,K=q+G;if(K>s){c&&Xr(0);break}u&&m(y+G),r.set(n.subarray(q,K),y),e.b=y+=G,e.p=w=K*8,e.f=b;continue}if(w>v){c&&Xr(0);break}}u&&m(y+131072);for(var re=(1<<j)-1,ve=(1<<B)-1,k=w;;k=w){var F=p[Ho(n,w)&re],z=F>>4;if(w+=F&15,w>v){c&&Xr(0);break}if(F||Xr(2),z<256)r[y++]=z;else if(z==256){k=w,p=null;break}else{var V=z-254;if(z>264){var I=z-257,ee=Ks[I];V=Yr(n,w,(1<<ee)-1)+Jc[I],w+=ee}var W=_[Ho(n,w)&ve],ne=W>>4;W||Xr(3),w+=W&15;var J=Gu[ne];if(ne>3){var ee=Zs[ne];J+=Ho(n,w)&(1<<ee)-1,w+=ee}if(w>v){c&&Xr(0);break}u&&m(y+131072);var de=y+V;if(y<J){var ue=i-J,Le=Math.min(J,de);for(ue+y<0&&Xr(3);y<Le;++y)r[y]=a[ue+y]}for(;y<de;++y)r[y]=r[y-J]}}e.l=p,e.p=k,e.b=y,e.f=b,p&&(b=1,e.m=j,e.d=_,e.n=B)}while(!b);return y!=r.length&&l?Kc(r,0,y):r.subarray(0,y)},Ln=function(n,e,r){r<<=e&7;var a=e/8|0;n[a]|=r,n[a+1]|=r>>8},Ii=function(n,e,r){r<<=e&7;var a=e/8|0;n[a]|=r,n[a+1]|=r>>8,n[a+2]|=r>>16},Wo=function(n,e){for(var r=[],a=0;a<n.length;++a)n[a]&&r.push({s:a,f:n[a]});var s=r.length,i=r.slice();if(!s)return{t:Qc,l:0};if(s==1){var l=new cr(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(K,$){return K.f-$.f}),r.push({s:-1,f:25001});var u=r[0],c=r[1],m=0,b=1,w=2;for(r[0]={s:-1,f:u.f+c.f,l:u,r:c};b!=s-1;)u=r[r[m].f<r[w].f?m++:w++],c=r[m!=b&&r[m].f<r[w].f?m++:w++],r[b++]={s:-1,f:u.f+c.f,l:u,r:c};for(var y=i[0].s,a=1;a<s;++a)i[a].s>y&&(y=i[a].s);var p=new Lr(y+1),_=ll(r[b-1],p,0);if(_>e){var a=0,j=0,B=_-e,v=1<<B;for(i.sort(function($,Q){return p[Q.s]-p[$.s]||$.f-Q.f});a<s;++a){var L=i[a].s;if(p[L]>e)j+=v-(1<<_-p[L]),p[L]=e;else break}for(j>>=B;j>0;){var q=i[a].s;p[q]<e?j-=1<<e-p[q]++-1:++a}for(;a>=0&&j;--a){var G=i[a].s;p[G]==e&&(--p[G],++j)}_=e}return{t:new cr(p),l:_}},ll=function(n,e,r){return n.s==-1?Math.max(ll(n.l,e,r+1),ll(n.r,e,r+1)):e[n.s]=r},oc=function(n){for(var e=n.length;e&&!n[--e];);for(var r=new Lr(++e),a=0,s=n[0],i=1,l=function(c){r[a++]=c},u=1;u<=e;++u)if(n[u]==s&&u!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(s),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(s);i=1,s=n[u]}return{c:r.subarray(0,a),n:e}},Oi=function(n,e){for(var r=0,a=0;a<e.length;++a)r+=n[a]*e[a];return r},Zc=function(n,e,r){var a=r.length,s=Nl(e+2);n[s]=a&255,n[s+1]=a>>8,n[s+2]=n[s]^255,n[s+3]=n[s+1]^255;for(var i=0;i<a;++i)n[s+i+4]=r[i];return(s+4+a)*8},lc=function(n,e,r,a,s,i,l,u,c,m,b){Ln(e,b++,r),++s[256];for(var w=Wo(s,15),y=w.t,p=w.l,_=Wo(i,15),j=_.t,B=_.l,v=oc(y),L=v.c,q=v.n,G=oc(j),K=G.c,$=G.n,Q=new Lr(19),X=0;X<L.length;++X)++Q[L[X]&31];for(var X=0;X<K.length;++X)++Q[K[X]&31];for(var se=Wo(Q,7),Y=se.t,I=se.l,h=19;h>4&&!Y[il[h-1]];--h);var g=m+5<<3,S=Oi(s,Jn)+Oi(i,Ui)+l,D=Oi(s,y)+Oi(i,j)+l+14+3*h+Oi(Q,Y)+2*Q[16]+3*Q[17]+7*Q[18];if(c>=0&&g<=S&&g<=D)return Zc(e,b,n.subarray(c,c+m));var F,A,R,J;if(Ln(e,b,1+(D<S)),b+=2,D<S){F=fn(y,p,0),A=y,R=fn(j,B,0),J=j;var re=fn(Y,I,0);Ln(e,b,q-257),Ln(e,b+5,$-1),Ln(e,b+10,h-4),b+=14;for(var X=0;X<h;++X)Ln(e,b+3*X,Y[il[X]]);b+=3*h;for(var ve=[L,K],k=0;k<2;++k)for(var z=ve[k],X=0;X<z.length;++X){var V=z[X]&31;Ln(e,b,re[V]),b+=Y[V],V>15&&(Ln(e,b,z[X]>>5&127),b+=z[X]>>12)}}else F=Yu,A=Jn,R=Xu,J=Ui;for(var X=0;X<u;++X){var ee=a[X];if(ee>255){var V=ee>>18&31;Ii(e,b,F[V+257]),b+=A[V+257],V>7&&(Ln(e,b,ee>>23&31),b+=Ks[V]);var W=ee&31;Ii(e,b,R[W]),b+=J[W],W>3&&(Ii(e,b,ee>>5&8191),b+=Zs[W])}else Ii(e,b,F[ee]),b+=A[ee]}return Ii(e,b,F[256]),b+A[256]},eh=new wl([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Qc=new cr(0),th=function(n,e,r,a,s,i){var l=i.z||n.length,u=new cr(a+l+5*(1+Math.ceil(l/7e3))+s),c=u.subarray(a,u.length-s),m=i.l,b=(i.r||0)&7;if(e){b&&(c[0]=i.r>>3);for(var w=eh[e-1],y=w>>13,p=w&8191,_=(1<<r)-1,j=i.p||new Lr(32768),B=i.h||new Lr(_+1),v=Math.ceil(r/3),L=2*v,q=function(We){return(n[We]^n[We+1]<<v^n[We+2]<<L)&_},G=new wl(25e3),K=new Lr(288),$=new Lr(32),Q=0,X=0,se=i.i||0,Y=0,I=i.w||0,h=0;se+2<l;++se){var g=q(se),S=se&32767,D=B[g];if(j[S]=D,B[g]=S,I<=se){var F=l-se;if((Q>7e3||Y>24576)&&(F>423||!m)){b=lc(n,c,0,G,K,$,X,Y,h,se-h,b),Y=Q=X=0,h=se;for(var A=0;A<286;++A)K[A]=0;for(var A=0;A<30;++A)$[A]=0}var R=2,J=0,re=p,ve=S-D&32767;if(F>2&&g==q(se-ve))for(var k=Math.min(y,F)-1,z=Math.min(32767,se),V=Math.min(258,F);ve<=z&&--re&&S!=D;){if(n[se+R]==n[se+R-ve]){for(var ee=0;ee<V&&n[se+ee]==n[se+ee-ve];++ee);if(ee>R){if(R=ee,J=ve,ee>k)break;for(var W=Math.min(ve,ee-2),ne=0,A=0;A<W;++A){var de=se-ve+A&32767,ue=j[de],Le=de-ue&32767;Le>ne&&(ne=Le,D=de)}}}S=D,D=j[S],ve+=S-D&32767}if(J){G[Y++]=268435456|sl[R]<<18|sc[J];var Se=sl[R]&31,ke=sc[J]&31;X+=Ks[Se]+Zs[ke],++K[257+Se],++$[ke],I=se+R,++Q}else G[Y++]=n[se],++K[n[se]]}}for(se=Math.max(se,I);se<l;++se)G[Y++]=n[se],++K[n[se]];b=lc(n,c,m,G,K,$,X,Y,h,se-h,b),m||(i.r=b&7|c[b/8|0]<<3,b-=7,i.h=B,i.p=j,i.i=se,i.w=I)}else{for(var se=i.w||0;se<l+m;se+=65535){var De=se+65535;De>=l&&(c[b/8|0]=m,De=l),b=Zc(c,b+1,n.subarray(se,De))}i.i=l}return Kc(u,0,a+Nl(b)+s)},ed=function(){var n=1,e=0;return{p:function(r){for(var a=n,s=e,i=r.length|0,l=0;l!=i;){for(var u=Math.min(l+2655,i);l<u;++l)s+=a+=r[l];a=(a&65535)+15*(a>>16),s=(s&65535)+15*(s>>16)}n=a,e=s},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},rh=function(n,e,r,a,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),l=new cr(i.length+n.length);l.set(i),l.set(n,i.length),n=l,s.w=i.length}return th(n,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,r,a,s)},td=function(n,e,r){for(;r;++e)n[e]=r,r>>>=8},nh=function(n,e){var r=e.level,a=r==0?0:r<6?1:r==9?3:2;if(n[0]=120,n[1]=a<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var s=ed();s.p(e.dictionary),td(n,2,s.d())}},ah=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&Xr(6,"invalid zlib data"),(n[1]>>5&1)==+!e&&Xr(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function cl(n,e){e||(e={});var r=ed();r.p(n);var a=rh(n,e,e.dictionary?6:2,4);return nh(a,e),td(a,a.length-4,r.d()),a}function ih(n,e){return Qu(n.subarray(ah(n,e),-4),{i:2},e,e)}var sh=typeof TextDecoder<"u"&&new TextDecoder,oh=0;try{sh.decode(Qc,{stream:!0}),oh=1}catch{}var Ge=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Go(){Ge.console&&typeof Ge.console.log=="function"&&Ge.console.log.apply(Ge.console,arguments)}var Nt={log:Go,warn:function(n){Ge.console&&(typeof Ge.console.warn=="function"?Ge.console.warn.apply(Ge.console,arguments):Go.call(null,arguments))},error:function(n){Ge.console&&(typeof Ge.console.error=="function"?Ge.console.error.apply(Ge.console,arguments):Go(n))}};function Yo(n,e,r){var a=new XMLHttpRequest;a.open("GET",n),a.responseType="blob",a.onload=function(){da(a.response,e,r)},a.onerror=function(){Nt.error("could not download file")},a.send()}function cc(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Es(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Mi,dl,da=Ge.saveAs||((typeof window>"u"?"undefined":xt(window))!=="object"||window!==Ge?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,r){var a=Ge.URL||Ge.webkitURL,s=document.createElement("a");e=e||n.name||"download",s.download=e,s.rel="noopener",typeof n=="string"?(s.href=n,s.origin!==location.origin?cc(s.href)?Yo(n,e,r):Es(s,s.target="_blank"):Es(s)):(s.href=a.createObjectURL(n),setTimeout(function(){a.revokeObjectURL(s.href)},4e4),setTimeout(function(){Es(s)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,r){if(e=e||n.name||"download",typeof n=="string")if(cc(n))Yo(n,e,r);else{var a=document.createElement("a");a.href=n,a.target="_blank",setTimeout(function(){Es(a)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:xt(i)!=="object"&&(Nt.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(n,r),e)}:function(n,e,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof n=="string")return Yo(n,e,r);var s=n.type==="application/octet-stream",i=/constructor/i.test(Ge.HTMLElement)||Ge.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&i)&&(typeof FileReader>"u"?"undefined":xt(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var b=u.result;b=l?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=b:location=b,a=null},u.readAsDataURL(n)}else{var c=Ge.URL||Ge.webkitURL,m=c.createObjectURL(n);a?a.location=m:location.href=m,a=null,setTimeout(function(){c.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function rd(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],a=0;a<r.length;a++){var s=r[a].re,i=r[a].process,l=s.exec(n);l&&(e=i(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),c=this.g.toString(16),m=this.b.toString(16);return u.length==1&&(u="0"+u),c.length==1&&(c="0"+c),m.length==1&&(m="0"+m),"#"+u+c+m}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Jo(n,e){var r=n[0],a=n[1],s=n[2],i=n[3];r=ir(r,a,s,i,e[0],7,-680876936),i=ir(i,r,a,s,e[1],12,-389564586),s=ir(s,i,r,a,e[2],17,606105819),a=ir(a,s,i,r,e[3],22,-1044525330),r=ir(r,a,s,i,e[4],7,-176418897),i=ir(i,r,a,s,e[5],12,1200080426),s=ir(s,i,r,a,e[6],17,-1473231341),a=ir(a,s,i,r,e[7],22,-45705983),r=ir(r,a,s,i,e[8],7,1770035416),i=ir(i,r,a,s,e[9],12,-1958414417),s=ir(s,i,r,a,e[10],17,-42063),a=ir(a,s,i,r,e[11],22,-1990404162),r=ir(r,a,s,i,e[12],7,1804603682),i=ir(i,r,a,s,e[13],12,-40341101),s=ir(s,i,r,a,e[14],17,-1502002290),r=sr(r,a=ir(a,s,i,r,e[15],22,1236535329),s,i,e[1],5,-165796510),i=sr(i,r,a,s,e[6],9,-1069501632),s=sr(s,i,r,a,e[11],14,643717713),a=sr(a,s,i,r,e[0],20,-373897302),r=sr(r,a,s,i,e[5],5,-701558691),i=sr(i,r,a,s,e[10],9,38016083),s=sr(s,i,r,a,e[15],14,-660478335),a=sr(a,s,i,r,e[4],20,-405537848),r=sr(r,a,s,i,e[9],5,568446438),i=sr(i,r,a,s,e[14],9,-1019803690),s=sr(s,i,r,a,e[3],14,-187363961),a=sr(a,s,i,r,e[8],20,1163531501),r=sr(r,a,s,i,e[13],5,-1444681467),i=sr(i,r,a,s,e[2],9,-51403784),s=sr(s,i,r,a,e[7],14,1735328473),r=or(r,a=sr(a,s,i,r,e[12],20,-1926607734),s,i,e[5],4,-378558),i=or(i,r,a,s,e[8],11,-2022574463),s=or(s,i,r,a,e[11],16,1839030562),a=or(a,s,i,r,e[14],23,-35309556),r=or(r,a,s,i,e[1],4,-1530992060),i=or(i,r,a,s,e[4],11,1272893353),s=or(s,i,r,a,e[7],16,-155497632),a=or(a,s,i,r,e[10],23,-1094730640),r=or(r,a,s,i,e[13],4,681279174),i=or(i,r,a,s,e[0],11,-358537222),s=or(s,i,r,a,e[3],16,-722521979),a=or(a,s,i,r,e[6],23,76029189),r=or(r,a,s,i,e[9],4,-640364487),i=or(i,r,a,s,e[12],11,-421815835),s=or(s,i,r,a,e[15],16,530742520),r=lr(r,a=or(a,s,i,r,e[2],23,-995338651),s,i,e[0],6,-198630844),i=lr(i,r,a,s,e[7],10,1126891415),s=lr(s,i,r,a,e[14],15,-1416354905),a=lr(a,s,i,r,e[5],21,-57434055),r=lr(r,a,s,i,e[12],6,1700485571),i=lr(i,r,a,s,e[3],10,-1894986606),s=lr(s,i,r,a,e[10],15,-1051523),a=lr(a,s,i,r,e[1],21,-2054922799),r=lr(r,a,s,i,e[8],6,1873313359),i=lr(i,r,a,s,e[15],10,-30611744),s=lr(s,i,r,a,e[6],15,-1560198380),a=lr(a,s,i,r,e[13],21,1309151649),r=lr(r,a,s,i,e[4],6,-145523070),i=lr(i,r,a,s,e[11],10,-1120210379),s=lr(s,i,r,a,e[2],15,718787259),a=lr(a,s,i,r,e[9],21,-343485551),n[0]=Gn(r,n[0]),n[1]=Gn(a,n[1]),n[2]=Gn(s,n[2]),n[3]=Gn(i,n[3])}function Qs(n,e,r,a,s,i){return e=Gn(Gn(e,n),Gn(a,i)),Gn(e<<s|e>>>32-s,r)}function ir(n,e,r,a,s,i,l){return Qs(e&r|~e&a,n,e,s,i,l)}function sr(n,e,r,a,s,i,l){return Qs(e&a|r&~a,n,e,s,i,l)}function or(n,e,r,a,s,i,l){return Qs(e^r^a,n,e,s,i,l)}function lr(n,e,r,a,s,i,l){return Qs(r^(e|~a),n,e,s,i,l)}function nd(n){var e,r=n.length,a=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)Jo(a,lh(n.substring(e-64,e)));n=n.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)s[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(Jo(a,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,Jo(a,s),a}function lh(n){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return r}Mi=Ge.atob.bind(Ge),dl=Ge.btoa.bind(Ge);var dc="0123456789abcdef".split("");function ch(n){for(var e="",r=0;r<4;r++)e+=dc[n>>8*r+4&15]+dc[n>>8*r&15];return e}function dh(n){return String.fromCharCode((255&n)>>0,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function ul(n){return nd(n).map(dh).join("")}var uh=function(n){for(var e=0;e<n.length;e++)n[e]=ch(n[e]);return n.join("")}(nd("hello"))!="5d41402abc4b2a76b9719d911017c592";function Gn(n,e){if(uh){var r=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(r>>16)<<16|65535&r}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function hl(n,e){var r,a,s,i;if(n!==r){for(var l=(s=n,i=1+(256/n.length>>0),new Array(i+1).join(s)),u=[],c=0;c<256;c++)u[c]=c;var m=0;for(c=0;c<256;c++){var b=u[c];m=(m+b+l.charCodeAt(c))%256,u[c]=u[m],u[m]=b}r=n,a=u}else u=a;var w=e.length,y=0,p=0,_="";for(c=0;c<w;c++)p=(p+(b=u[y=(y+1)%256]))%256,u[y]=u[p],u[p]=b,l=u[(u[y]+u[p])%256],_+=String.fromCharCode(e.charCodeAt(c)^l);return _}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var uc={print:4,modify:8,copy:16,"annot-forms":32};function Ga(n,e,r,a){this.v=1,this.r=2;var s=192;n.forEach(function(u){if(uc.perm!==void 0)throw new Error("Invalid permission: "+u);s+=uc[u]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var i=(e+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,l),this.P=-(1+(255^s)),this.encryptionKey=ul(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=hl(this.encryptionKey,this.padding)}function Ya(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",r=n.length,a=0;a<r;a++){var s=n.charCodeAt(a);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?e+="#"+("0"+s.toString(16)).slice(-2):e+=n[a]}return e}function hc(n){if(xt(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,a,s){if(s=s||!1,typeof r!="string"||typeof a!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var i=Math.random().toString(35);return e[r][i]=[a,!!s],i},this.unsubscribe=function(r){for(var a in e)if(e[a][r])return delete e[a][r],Object.keys(e[a]).length===0&&delete e[a],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[r]){var l=e[r][i];try{l[0].apply(n,a)}catch(u){Ge.console&&Nt.error("jsPDF PubSub Error",u.message,u)}l[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Vs(n){if(!(this instanceof Vs))return new Vs(n);var e="opacity,stroke-opacity".split(",");for(var r in n)n.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=n[r]);this.id="",this.objectNumber=-1}function ad(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function ha(n,e,r,a,s){if(!(this instanceof ha))return new ha(n,e,r,a,s);this.type=n==="axial"?2:3,this.coords=e,this.colors=r,ad.call(this,a,s)}function Xa(n,e,r,a,s){if(!(this instanceof Xa))return new Xa(n,e,r,a,s);this.boundingBox=n,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,ad.call(this,a,s)}function $e(n){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],s=arguments[2],i=arguments[3],l=[],u=1,c=16,m="S",b=null;xt(n=n||{})==="object"&&(r=n.orientation,a=n.unit||a,s=n.format||s,i=n.compress||n.compressPdf||i,(b=n.encryption||null)!==null&&(b.userPassword=b.userPassword||"",b.ownerPassword=b.ownerPassword||"",b.userPermissions=b.userPermissions||[]),u=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(c=n.floatPrecision),m=n.defaultPathOperation||"S"),l=n.filters||(i===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var w=n.putOnlyUsedFonts||!1,y={},p={internal:{},__private__:{}};p.__private__.PubSub=hc;var _="1.3",j=p.__private__.getPdfVersion=function(){return _};p.__private__.setPdfVersion=function(f){_=f};var B={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return B};var v=p.__private__.getPageFormat=function(f){return B[f]};s=s||"a4";var L={COMPAT:"compat",ADVANCED:"advanced"},q=L.COMPAT;function G(){this.saveGraphicsState(),Z(new He(Be,0,0,-Be,0,Dn()*Be).toString()+" cm"),this.setFontSize(this.getFontSize()/Be),m="n",q=L.ADVANCED}function K(){this.restoreGraphicsState(),m="S",q=L.COMPAT}var $=p.__private__.combineFontStyleAndFontWeight=function(f,P){if(f=="bold"&&P=="normal"||f=="bold"&&P==400||f=="normal"&&P=="italic"||f=="bold"&&P=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return P&&(f=P==400||P==="normal"?f==="italic"?"italic":"normal":P!=700&&P!=="bold"||f!=="normal"?(P==700?"bold":P)+""+f:"bold"),f};p.advancedAPI=function(f){var P=q===L.COMPAT;return P&&G.call(this),typeof f!="function"||(f(this),P&&K.call(this)),this},p.compatAPI=function(f){var P=q===L.ADVANCED;return P&&K.call(this),typeof f!="function"||(f(this),P&&G.call(this)),this},p.isAdvancedAPI=function(){return q===L.ADVANCED};var Q,X=function(f){if(q!==L.ADVANCED)throw new Error(f+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},se=p.roundToPrecision=p.__private__.roundToPrecision=function(f,P){var H=e||P;if(isNaN(f)||isNaN(H))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return f.toFixed(H).replace(/0+$/,"")};Q=p.hpf=p.__private__.hpf=typeof c=="number"?function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.hpf");return se(f,c)}:c==="smart"?function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.hpf");return se(f,f>-1&&f<1?16:5)}:function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.hpf");return se(f,16)};var Y=p.f2=p.__private__.f2=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.f2");return se(f,2)},I=p.__private__.f3=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.f3");return se(f,3)},h=p.scale=p.__private__.scale=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.scale");return q===L.COMPAT?f*Be:q===L.ADVANCED?f:void 0},g=function(f){return q===L.COMPAT?Dn()-f:q===L.ADVANCED?f:void 0},S=function(f){return h(g(f))};p.__private__.setPrecision=p.setPrecision=function(f){typeof parseInt(f,10)=="number"&&(e=parseInt(f,10))};var D,F="00000000000000000000000000000000",A=p.__private__.getFileId=function(){return F},R=p.__private__.setFileId=function(f){return F=f!==void 0&&/^[a-fA-F0-9]{32}$/.test(f)?f.toUpperCase():F.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),b!==null&&(nr=new Ga(b.userPermissions,b.userPassword,b.ownerPassword,F)),F};p.setFileId=function(f){return R(f),this},p.getFileId=function(){return A()};var J=p.__private__.convertDateToPDFDate=function(f){var P=f.getTimezoneOffset(),H=P<0?"+":"-",te=Math.floor(Math.abs(P/60)),ce=Math.abs(P%60),xe=[H,V(te),"'",V(ce),"'"].join("");return["D:",f.getFullYear(),V(f.getMonth()+1),V(f.getDate()),V(f.getHours()),V(f.getMinutes()),V(f.getSeconds()),xe].join("")},re=p.__private__.convertPDFDateToDate=function(f){var P=parseInt(f.substr(2,4),10),H=parseInt(f.substr(6,2),10)-1,te=parseInt(f.substr(8,2),10),ce=parseInt(f.substr(10,2),10),xe=parseInt(f.substr(12,2),10),_e=parseInt(f.substr(14,2),10);return new Date(P,H,te,ce,xe,_e,0)},ve=p.__private__.setCreationDate=function(f){var P;if(f===void 0&&(f=new Date),f instanceof Date)P=J(f);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(f))throw new Error("Invalid argument passed to jsPDF.setCreationDate");P=f}return D=P},k=p.__private__.getCreationDate=function(f){var P=D;return f==="jsDate"&&(P=re(D)),P};p.setCreationDate=function(f){return ve(f),this},p.getCreationDate=function(f){return k(f)};var z,V=p.__private__.padd2=function(f){return("0"+parseInt(f)).slice(-2)},ee=p.__private__.padd2Hex=function(f){return("00"+(f=f.toString())).substr(f.length)},W=0,ne=[],de=[],ue=0,Le=[],Se=[],ke=!1,De=de,We=function(){W=0,ue=0,de=[],ne=[],Le=[],gn=qt(),qr=qt()};p.__private__.setCustomOutputDestination=function(f){ke=!0,De=f};var be=function(f){ke||(De=f)};p.__private__.resetCustomOutputDestination=function(){ke=!1,De=de};var Z=p.__private__.out=function(f){return f=f.toString(),ue+=f.length+1,De.push(f),De},et=p.__private__.write=function(f){return Z(arguments.length===1?f.toString():Array.prototype.join.call(arguments," "))},qe=p.__private__.getArrayBuffer=function(f){for(var P=f.length,H=new ArrayBuffer(P),te=new Uint8Array(H);P--;)te[P]=f.charCodeAt(P);return H},Ae=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return Ae};var Ce=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(f){return Ce=q===L.ADVANCED?f/Be:f,this};var Oe,Ie=p.__private__.getFontSize=p.getFontSize=function(){return q===L.COMPAT?Ce:Ce*Be},ze=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(f){return ze=f,this},p.__private__.getR2L=p.getR2L=function(){return ze};var Xe,nt=p.__private__.setZoomMode=function(f){var P=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(f))Oe=f;else if(isNaN(f)){if(P.indexOf(f)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+f+'" is not recognized.');Oe=f}else Oe=parseInt(f,10)};p.__private__.getZoomMode=function(){return Oe};var at,ct=p.__private__.setPageMode=function(f){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(f)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+f+'" is not recognized.');Xe=f};p.__private__.getPageMode=function(){return Xe};var bt=p.__private__.setLayoutMode=function(f){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(f)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+f+'" is not recognized.');at=f};p.__private__.getLayoutMode=function(){return at},p.__private__.setDisplayMode=p.setDisplayMode=function(f,P,H){return nt(f),bt(P),ct(H),this};var Ye={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(f){if(Object.keys(Ye).indexOf(f)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ye[f]},p.__private__.getDocumentProperties=function(){return Ye},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(f){for(var P in Ye)Ye.hasOwnProperty(P)&&f[P]&&(Ye[P]=f[P]);return this},p.__private__.setDocumentProperty=function(f,P){if(Object.keys(Ye).indexOf(f)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ye[f]=P};var it,Be,rr,ut,Tr,yt={},Lt={},en=[],ft={},Kn={},Ct={},Mr={},mn=null,Pt=0,Ke=[],pt=new hc(p),Zn=n.hotfixes||[],Kt={},tn={},rn=[],He=function f(P,H,te,ce,xe,_e){if(!(this instanceof f))return new f(P,H,te,ce,xe,_e);isNaN(P)&&(P=1),isNaN(H)&&(H=0),isNaN(te)&&(te=0),isNaN(ce)&&(ce=1),isNaN(xe)&&(xe=0),isNaN(_e)&&(_e=0),this._matrix=[P,H,te,ce,xe,_e]};Object.defineProperty(He.prototype,"sx",{get:function(){return this._matrix[0]},set:function(f){this._matrix[0]=f}}),Object.defineProperty(He.prototype,"shy",{get:function(){return this._matrix[1]},set:function(f){this._matrix[1]=f}}),Object.defineProperty(He.prototype,"shx",{get:function(){return this._matrix[2]},set:function(f){this._matrix[2]=f}}),Object.defineProperty(He.prototype,"sy",{get:function(){return this._matrix[3]},set:function(f){this._matrix[3]=f}}),Object.defineProperty(He.prototype,"tx",{get:function(){return this._matrix[4]},set:function(f){this._matrix[4]=f}}),Object.defineProperty(He.prototype,"ty",{get:function(){return this._matrix[5]},set:function(f){this._matrix[5]=f}}),Object.defineProperty(He.prototype,"a",{get:function(){return this._matrix[0]},set:function(f){this._matrix[0]=f}}),Object.defineProperty(He.prototype,"b",{get:function(){return this._matrix[1]},set:function(f){this._matrix[1]=f}}),Object.defineProperty(He.prototype,"c",{get:function(){return this._matrix[2]},set:function(f){this._matrix[2]=f}}),Object.defineProperty(He.prototype,"d",{get:function(){return this._matrix[3]},set:function(f){this._matrix[3]=f}}),Object.defineProperty(He.prototype,"e",{get:function(){return this._matrix[4]},set:function(f){this._matrix[4]=f}}),Object.defineProperty(He.prototype,"f",{get:function(){return this._matrix[5]},set:function(f){this._matrix[5]=f}}),Object.defineProperty(He.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(He.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(He.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(He.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),He.prototype.join=function(f){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Q).join(f)},He.prototype.multiply=function(f){var P=f.sx*this.sx+f.shy*this.shx,H=f.sx*this.shy+f.shy*this.sy,te=f.shx*this.sx+f.sy*this.shx,ce=f.shx*this.shy+f.sy*this.sy,xe=f.tx*this.sx+f.ty*this.shx+this.tx,_e=f.tx*this.shy+f.ty*this.sy+this.ty;return new He(P,H,te,ce,xe,_e)},He.prototype.decompose=function(){var f=this.sx,P=this.shy,H=this.shx,te=this.sy,ce=this.tx,xe=this.ty,_e=Math.sqrt(f*f+P*P),Te=(f/=_e)*H+(P/=_e)*te;H-=f*Te,te-=P*Te;var Ue=Math.sqrt(H*H+te*te);return Te/=Ue,f*(te/=Ue)<P*(H/=Ue)&&(f=-f,P=-P,Te=-Te,_e=-_e),{scale:new He(_e,0,0,Ue,0,0),translate:new He(1,0,0,1,ce,xe),rotate:new He(f,P,-P,f,0,0),skew:new He(1,0,Te,1,0,0)}},He.prototype.toString=function(f){return this.join(" ")},He.prototype.inversed=function(){var f=this.sx,P=this.shy,H=this.shx,te=this.sy,ce=this.tx,xe=this.ty,_e=1/(f*te-P*H),Te=te*_e,Ue=-P*_e,tt=-H*_e,Ze=f*_e;return new He(Te,Ue,tt,Ze,-Te*ce-tt*xe,-Ue*ce-Ze*xe)},He.prototype.applyToPoint=function(f){var P=f.x*this.sx+f.y*this.shx+this.tx,H=f.x*this.shy+f.y*this.sy+this.ty;return new Ca(P,H)},He.prototype.applyToRectangle=function(f){var P=this.applyToPoint(f),H=this.applyToPoint(new Ca(f.x+f.w,f.y+f.h));return new pi(P.x,P.y,H.x-P.x,H.y-P.y)},He.prototype.clone=function(){var f=this.sx,P=this.shy,H=this.shx,te=this.sy,ce=this.tx,xe=this.ty;return new He(f,P,H,te,ce,xe)},p.Matrix=He;var Rr=p.matrixMult=function(f,P){return P.multiply(f)},nn=new He(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=nn;var fr=function(f,P){if(!Kn[f]){var H=(P instanceof ha?"Sh":"P")+(Object.keys(ft).length+1).toString(10);P.id=H,Kn[f]=H,ft[H]=P,pt.publish("addPattern",P)}};p.ShadingPattern=ha,p.TilingPattern=Xa,p.addShadingPattern=function(f,P){return X("addShadingPattern()"),fr(f,P),this},p.beginTilingPattern=function(f){X("beginTilingPattern()"),os(f.boundingBox[0],f.boundingBox[1],f.boundingBox[2]-f.boundingBox[0],f.boundingBox[3]-f.boundingBox[1],f.matrix)},p.endTilingPattern=function(f,P){X("endTilingPattern()"),P.stream=Se[z].join(`
`),fr(f,P),pt.publish("endTilingPattern",P),rn.pop().restore()};var Ht=p.__private__.newObject=function(){var f=qt();return wr(f,!0),f},qt=p.__private__.newObjectDeferred=function(){return W++,ne[W]=function(){return ue},W},wr=function(f,P){return P=typeof P=="boolean"&&P,ne[f]=ue,P&&Z(f+" 0 obj"),f},ga=p.__private__.newAdditionalObject=function(){var f={objId:qt(),content:""};return Le.push(f),f},gn=qt(),qr=qt(),zr=p.__private__.decodeColorString=function(f){var P=f.split(" ");if(P.length!==2||P[1]!=="g"&&P[1]!=="G")P.length===5&&(P[4]==="k"||P[4]==="K")&&(P=[(1-P[0])*(1-P[3]),(1-P[1])*(1-P[3]),(1-P[2])*(1-P[3]),"r"]);else{var H=parseFloat(P[0]);P=[H,H,H,"r"]}for(var te="#",ce=0;ce<3;ce++)te+=("0"+Math.floor(255*parseFloat(P[ce])).toString(16)).slice(-2);return te},Ur=p.__private__.encodeColorString=function(f){var P;typeof f=="string"&&(f={ch1:f});var H=f.ch1,te=f.ch2,ce=f.ch3,xe=f.ch4,_e=f.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof H=="string"&&H.charAt(0)!=="#"){var Te=new rd(H);if(Te.ok)H=Te.toHex();else if(!/^\d*\.?\d*$/.test(H))throw new Error('Invalid color "'+H+'" passed to jsPDF.encodeColorString.')}if(typeof H=="string"&&/^#[0-9A-Fa-f]{3}$/.test(H)&&(H="#"+H[1]+H[1]+H[2]+H[2]+H[3]+H[3]),typeof H=="string"&&/^#[0-9A-Fa-f]{6}$/.test(H)){var Ue=parseInt(H.substr(1),16);H=Ue>>16&255,te=Ue>>8&255,ce=255&Ue}if(te===void 0||xe===void 0&&H===te&&te===ce)if(typeof H=="string")P=H+" "+_e[0];else switch(f.precision){case 2:P=Y(H/255)+" "+_e[0];break;case 3:default:P=I(H/255)+" "+_e[0]}else if(xe===void 0||xt(xe)==="object"){if(xe&&!isNaN(xe.a)&&xe.a===0)return P=["1.","1.","1.",_e[1]].join(" ");if(typeof H=="string")P=[H,te,ce,_e[1]].join(" ");else switch(f.precision){case 2:P=[Y(H/255),Y(te/255),Y(ce/255),_e[1]].join(" ");break;default:case 3:P=[I(H/255),I(te/255),I(ce/255),_e[1]].join(" ")}}else if(typeof H=="string")P=[H,te,ce,xe,_e[2]].join(" ");else switch(f.precision){case 2:P=[Y(H),Y(te),Y(ce),Y(xe),_e[2]].join(" ");break;case 3:default:P=[I(H),I(te),I(ce),I(xe),_e[2]].join(" ")}return P},an=p.__private__.getFilters=function(){return l},kr=p.__private__.putStream=function(f){var P=(f=f||{}).data||"",H=f.filters||an(),te=f.alreadyAppliedFilters||[],ce=f.addLength1||!1,xe=P.length,_e=f.objectId,Te=function(ar){return ar};if(b!==null&&_e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");b!==null&&(Te=nr.encryptor(_e,0));var Ue={};H===!0&&(H=["FlateEncode"]);var tt=f.additionalKeyValues||[],Ze=(Ue=$e.API.processDataByFilters!==void 0?$e.API.processDataByFilters(P,H):{data:P,reverseChain:[]}).reverseChain+(Array.isArray(te)?te.join(" "):te.toString());if(Ue.data.length!==0&&(tt.push({key:"Length",value:Ue.data.length}),ce===!0&&tt.push({key:"Length1",value:xe})),Ze.length!=0)if(Ze.split("/").length-1==1)tt.push({key:"Filter",value:Ze});else{tt.push({key:"Filter",value:"["+Ze+"]"});for(var lt=0;lt<tt.length;lt+=1)if(tt[lt].key==="DecodeParms"){for(var kt=[],Ft=0;Ft<Ue.reverseChain.split("/").length-1;Ft+=1)kt.push("null");kt.push(tt[lt].value),tt[lt].value="["+kt.join(" ")+"]"}}Z("<<");for(var zt=0;zt<tt.length;zt++)Z("/"+tt[zt].key+" "+tt[zt].value);Z(">>"),Ue.data.length!==0&&(Z("stream"),Z(Te(Ue.data)),Z("endstream"))},sn=p.__private__.putPage=function(f){var P=f.number,H=f.data,te=f.objId,ce=f.contentsObjId;wr(te,!0),Z("<</Type /Page"),Z("/Parent "+f.rootDictionaryObjId+" 0 R"),Z("/Resources "+f.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(Q(f.mediaBox.bottomLeftX))+" "+parseFloat(Q(f.mediaBox.bottomLeftY))+" "+Q(f.mediaBox.topRightX)+" "+Q(f.mediaBox.topRightY)+"]"),f.cropBox!==null&&Z("/CropBox ["+Q(f.cropBox.bottomLeftX)+" "+Q(f.cropBox.bottomLeftY)+" "+Q(f.cropBox.topRightX)+" "+Q(f.cropBox.topRightY)+"]"),f.bleedBox!==null&&Z("/BleedBox ["+Q(f.bleedBox.bottomLeftX)+" "+Q(f.bleedBox.bottomLeftY)+" "+Q(f.bleedBox.topRightX)+" "+Q(f.bleedBox.topRightY)+"]"),f.trimBox!==null&&Z("/TrimBox ["+Q(f.trimBox.bottomLeftX)+" "+Q(f.trimBox.bottomLeftY)+" "+Q(f.trimBox.topRightX)+" "+Q(f.trimBox.topRightY)+"]"),f.artBox!==null&&Z("/ArtBox ["+Q(f.artBox.bottomLeftX)+" "+Q(f.artBox.bottomLeftY)+" "+Q(f.artBox.topRightX)+" "+Q(f.artBox.topRightY)+"]"),typeof f.userUnit=="number"&&f.userUnit!==1&&Z("/UserUnit "+f.userUnit),pt.publish("putPage",{objId:te,pageContext:Ke[P],pageNumber:P,page:H}),Z("/Contents "+ce+" 0 R"),Z(">>"),Z("endobj");var xe=H.join(`
`);return q===L.ADVANCED&&(xe+=`
Q`),wr(ce,!0),kr({data:xe,filters:an(),objectId:ce}),Z("endobj"),te},Qn=p.__private__.putPages=function(){var f,P,H=[];for(f=1;f<=Pt;f++)Ke[f].objId=qt(),Ke[f].contentsObjId=qt();for(f=1;f<=Pt;f++)H.push(sn({number:f,data:Se[f],objId:Ke[f].objId,contentsObjId:Ke[f].contentsObjId,mediaBox:Ke[f].mediaBox,cropBox:Ke[f].cropBox,bleedBox:Ke[f].bleedBox,trimBox:Ke[f].trimBox,artBox:Ke[f].artBox,userUnit:Ke[f].userUnit,rootDictionaryObjId:gn,resourceDictionaryObjId:qr}));wr(gn,!0),Z("<</Type /Pages");var te="/Kids [";for(P=0;P<Pt;P++)te+=H[P]+" 0 R ";Z(te+"]"),Z("/Count "+Pt),Z(">>"),Z("endobj"),pt.publish("postPutPages")},xa=function(f){pt.publish("putFont",{font:f,out:Z,newObject:Ht,putStream:kr}),f.isAlreadyPutted!==!0&&(f.objectNumber=Ht(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Ya(f.postScriptName)),Z("/Subtype /Type1"),typeof f.encoding=="string"&&Z("/Encoding /"+f.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},ba=function(){for(var f in yt)yt.hasOwnProperty(f)&&(w===!1||w===!0&&y.hasOwnProperty(f))&&xa(yt[f])},va=function(f){f.objectNumber=Ht();var P=[];P.push({key:"Type",value:"/XObject"}),P.push({key:"Subtype",value:"/Form"}),P.push({key:"BBox",value:"["+[Q(f.x),Q(f.y),Q(f.x+f.width),Q(f.y+f.height)].join(" ")+"]"}),P.push({key:"Matrix",value:"["+f.matrix.toString()+"]"});var H=f.pages[1].join(`
`);kr({data:H,additionalKeyValues:P,objectId:f.objectNumber}),Z("endobj")},ya=function(){for(var f in Kt)Kt.hasOwnProperty(f)&&va(Kt[f])},$i=function(f,P){var H,te=[],ce=1/(P-1);for(H=0;H<1;H+=ce)te.push(H);if(te.push(1),f[0].offset!=0){var xe={offset:0,color:f[0].color};f.unshift(xe)}if(f[f.length-1].offset!=1){var _e={offset:1,color:f[f.length-1].color};f.push(_e)}for(var Te="",Ue=0,tt=0;tt<te.length;tt++){for(H=te[tt];H>f[Ue+1].offset;)Ue++;var Ze=f[Ue].offset,lt=(H-Ze)/(f[Ue+1].offset-Ze),kt=f[Ue].color,Ft=f[Ue+1].color;Te+=ee(Math.round((1-lt)*kt[0]+lt*Ft[0]).toString(16))+ee(Math.round((1-lt)*kt[1]+lt*Ft[1]).toString(16))+ee(Math.round((1-lt)*kt[2]+lt*Ft[2]).toString(16))}return Te.trim()},to=function(f,P){P||(P=21);var H=Ht(),te=$i(f.colors,P),ce=[];ce.push({key:"FunctionType",value:"0"}),ce.push({key:"Domain",value:"[0.0 1.0]"}),ce.push({key:"Size",value:"["+P+"]"}),ce.push({key:"BitsPerSample",value:"8"}),ce.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ce.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),kr({data:te,additionalKeyValues:ce,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:H}),Z("endobj"),f.objectNumber=Ht(),Z("<< /ShadingType "+f.type),Z("/ColorSpace /DeviceRGB");var xe="/Coords ["+Q(parseFloat(f.coords[0]))+" "+Q(parseFloat(f.coords[1]))+" ";f.type===2?xe+=Q(parseFloat(f.coords[2]))+" "+Q(parseFloat(f.coords[3])):xe+=Q(parseFloat(f.coords[2]))+" "+Q(parseFloat(f.coords[3]))+" "+Q(parseFloat(f.coords[4]))+" "+Q(parseFloat(f.coords[5])),Z(xe+="]"),f.matrix&&Z("/Matrix ["+f.matrix.toString()+"]"),Z("/Function "+H+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},ro=function(f,P){var H=qt(),te=Ht();P.push({resourcesOid:H,objectOid:te}),f.objectNumber=te;var ce=[];ce.push({key:"Type",value:"/Pattern"}),ce.push({key:"PatternType",value:"1"}),ce.push({key:"PaintType",value:"1"}),ce.push({key:"TilingType",value:"1"}),ce.push({key:"BBox",value:"["+f.boundingBox.map(Q).join(" ")+"]"}),ce.push({key:"XStep",value:Q(f.xStep)}),ce.push({key:"YStep",value:Q(f.yStep)}),ce.push({key:"Resources",value:H+" 0 R"}),f.matrix&&ce.push({key:"Matrix",value:"["+f.matrix.toString()+"]"}),kr({data:f.stream,additionalKeyValues:ce,objectId:f.objectNumber}),Z("endobj")},wa=function(f){var P;for(P in ft)ft.hasOwnProperty(P)&&(ft[P]instanceof ha?to(ft[P]):ft[P]instanceof Xa&&ro(ft[P],f))},Vi=function(f){for(var P in f.objectNumber=Ht(),Z("<<"),f)switch(P){case"opacity":Z("/ca "+Y(f[P]));break;case"stroke-opacity":Z("/CA "+Y(f[P]))}Z(">>"),Z("endobj")},no=function(){var f;for(f in Ct)Ct.hasOwnProperty(f)&&Vi(Ct[f])},ai=function(){for(var f in Z("/XObject <<"),Kt)Kt.hasOwnProperty(f)&&Kt[f].objectNumber>=0&&Z("/"+f+" "+Kt[f].objectNumber+" 0 R");pt.publish("putXobjectDict"),Z(">>")},ao=function(){nr.oid=Ht(),Z("<<"),Z("/Filter /Standard"),Z("/V "+nr.v),Z("/R "+nr.r),Z("/U <"+nr.toHexString(nr.U)+">"),Z("/O <"+nr.toHexString(nr.O)+">"),Z("/P "+nr.P),Z(">>"),Z("endobj")},Hi=function(){for(var f in Z("/Font <<"),yt)yt.hasOwnProperty(f)&&(w===!1||w===!0&&y.hasOwnProperty(f))&&Z("/"+f+" "+yt[f].objectNumber+" 0 R");Z(">>")},io=function(){if(Object.keys(ft).length>0){for(var f in Z("/Shading <<"),ft)ft.hasOwnProperty(f)&&ft[f]instanceof ha&&ft[f].objectNumber>=0&&Z("/"+f+" "+ft[f].objectNumber+" 0 R");pt.publish("putShadingPatternDict"),Z(">>")}},Na=function(f){if(Object.keys(ft).length>0){for(var P in Z("/Pattern <<"),ft)ft.hasOwnProperty(P)&&ft[P]instanceof p.TilingPattern&&ft[P].objectNumber>=0&&ft[P].objectNumber<f&&Z("/"+P+" "+ft[P].objectNumber+" 0 R");pt.publish("putTilingPatternDict"),Z(">>")}},so=function(){if(Object.keys(Ct).length>0){var f;for(f in Z("/ExtGState <<"),Ct)Ct.hasOwnProperty(f)&&Ct[f].objectNumber>=0&&Z("/"+f+" "+Ct[f].objectNumber+" 0 R");pt.publish("putGStateDict"),Z(">>")}},It=function(f){wr(f.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Hi(),io(),Na(f.objectOid),so(),ai(),Z(">>"),Z("endobj")},Wi=function(){var f=[];ba(),no(),ya(),wa(f),pt.publish("putResources"),f.forEach(It),It({resourcesOid:qr,objectOid:Number.MAX_SAFE_INTEGER}),pt.publish("postPutResources")},Gi=function(){pt.publish("putAdditionalObjects");for(var f=0;f<Le.length;f++){var P=Le[f];wr(P.objId,!0),Z(P.content),Z("endobj")}pt.publish("postPutAdditionalObjects")},Yi=function(f){Lt[f.fontName]=Lt[f.fontName]||{},Lt[f.fontName][f.fontStyle]=f.id},ii=function(f,P,H,te,ce){var xe={id:"F"+(Object.keys(yt).length+1).toString(10),postScriptName:f,fontName:P,fontStyle:H,encoding:te,isStandardFont:ce||!1,metadata:{}};return pt.publish("addFont",{font:xe,instance:this}),yt[xe.id]=xe,Yi(xe),xe.id},oo=function(f){for(var P=0,H=Ae.length;P<H;P++){var te=ii.call(this,f[P][0],f[P][1],f[P][2],Ae[P][3],!0);w===!1&&(y[te]=!0);var ce=f[P][0].split("-");Yi({id:te,fontName:ce[0],fontStyle:ce[1]||""})}pt.publish("addFonts",{fonts:yt,dictionary:Lt})},$r=function(f){return f.foo=function(){try{return f.apply(this,arguments)}catch(te){var P=te.stack||"";~P.indexOf(" at ")&&(P=P.split(" at ")[1]);var H="Error in function "+P.split(`
`)[0].split("<")[0]+": "+te.message;if(!Ge.console)throw new Error(H);Ge.console.error(H,te),Ge.alert&&alert(H)}},f.foo.bar=f,f.foo},ja=function(f,P){var H,te,ce,xe,_e,Te,Ue,tt,Ze;if(ce=(P=P||{}).sourceEncoding||"Unicode",_e=P.outputEncoding,(P.autoencode||_e)&&yt[it].metadata&&yt[it].metadata[ce]&&yt[it].metadata[ce].encoding&&(xe=yt[it].metadata[ce].encoding,!_e&&yt[it].encoding&&(_e=yt[it].encoding),!_e&&xe.codePages&&(_e=xe.codePages[0]),typeof _e=="string"&&(_e=xe[_e]),_e)){for(Ue=!1,Te=[],H=0,te=f.length;H<te;H++)(tt=_e[f.charCodeAt(H)])?Te.push(String.fromCharCode(tt)):Te.push(f[H]),Te[H].charCodeAt(0)>>8&&(Ue=!0);f=Te.join("")}for(H=f.length;Ue===void 0&&H!==0;)f.charCodeAt(H-1)>>8&&(Ue=!0),H--;if(!Ue)return f;for(Te=P.noBOM?[]:[254,255],H=0,te=f.length;H<te;H++){if((Ze=(tt=f.charCodeAt(H))>>8)>>8)throw new Error("Character at position "+H+" of string '"+f+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Te.push(Ze),Te.push(tt-(Ze<<8))}return String.fromCharCode.apply(void 0,Te)},pr=p.__private__.pdfEscape=p.pdfEscape=function(f,P){return ja(f,P).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},si=p.__private__.beginPage=function(f){Se[++Pt]=[],Ke[Pt]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(f[0]),topRightY:Number(f[1])}},Xi(Pt),be(Se[z])},Ji=function(f,P){var H,te,ce;switch(r=P||r,typeof f=="string"&&(H=v(f.toLowerCase()),Array.isArray(H)&&(te=H[0],ce=H[1])),Array.isArray(f)&&(te=f[0]*Be,ce=f[1]*Be),isNaN(te)&&(te=s[0],ce=s[1]),(te>14400||ce>14400)&&(Nt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),te=Math.min(14400,te),ce=Math.min(14400,ce)),s=[te,ce],r.substr(0,1)){case"l":ce>te&&(s=[ce,te]);break;case"p":te>ce&&(s=[ce,te])}si(s),rs(di),Z(Vr),hi!==0&&Z(hi+" J"),fi!==0&&Z(fi+" j"),pt.publish("addPage",{pageNumber:Pt})},lo=function(f){f>0&&f<=Pt&&(Se.splice(f,1),Ke.splice(f,1),Pt--,z>Pt&&(z=Pt),this.setPage(z))},Xi=function(f){f>0&&f<=Pt&&(z=f)},co=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Se.length-1},Ki=function(f,P,H){var te,ce=void 0;return H=H||{},f=f!==void 0?f:yt[it].fontName,P=P!==void 0?P:yt[it].fontStyle,te=f.toLowerCase(),Lt[te]!==void 0&&Lt[te][P]!==void 0?ce=Lt[te][P]:Lt[f]!==void 0&&Lt[f][P]!==void 0?ce=Lt[f][P]:H.disableWarning===!1&&Nt.warn("Unable to look up font label for font '"+f+"', '"+P+"'. Refer to getFontList() for available fonts."),ce||H.noFallback||(ce=Lt.times[P])==null&&(ce=Lt.times.normal),ce},uo=p.__private__.putInfo=function(){var f=Ht(),P=function(te){return te};for(var H in b!==null&&(P=nr.encryptor(f,0)),Z("<<"),Z("/Producer ("+pr(P("jsPDF "+$e.version))+")"),Ye)Ye.hasOwnProperty(H)&&Ye[H]&&Z("/"+H.substr(0,1).toUpperCase()+H.substr(1)+" ("+pr(P(Ye[H]))+")");Z("/CreationDate ("+pr(P(D))+")"),Z(">>"),Z("endobj")},oi=p.__private__.putCatalog=function(f){var P=(f=f||{}).rootDictionaryObjId||gn;switch(Ht(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+P+" 0 R"),Oe||(Oe="fullwidth"),Oe){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var H=""+Oe;H.substr(H.length-1)==="%"&&(Oe=parseInt(Oe)/100),typeof Oe=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+Y(Oe)+"]")}switch(at||(at="continuous"),at){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}Xe&&Z("/PageMode /"+Xe),pt.publish("putCatalog"),Z(">>"),Z("endobj")},ho=p.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(W+1)),Z("/Root "+W+" 0 R"),Z("/Info "+(W-1)+" 0 R"),b!==null&&Z("/Encrypt "+nr.oid+" 0 R"),Z("/ID [ <"+F+"> <"+F+"> ]"),Z(">>")},fo=p.__private__.putHeader=function(){Z("%PDF-"+_),Z("%ÂºÃŸÂ¬Ã ")},po=p.__private__.putXRef=function(){var f="0000000000";Z("xref"),Z("0 "+(W+1)),Z("0000000000 65535 f ");for(var P=1;P<=W;P++)typeof ne[P]=="function"?Z((f+ne[P]()).slice(-10)+" 00000 n "):ne[P]!==void 0?Z((f+ne[P]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},xn=p.__private__.buildDocument=function(){We(),be(de),pt.publish("buildDocument"),fo(),Qn(),Gi(),Wi(),b!==null&&ao(),uo(),oi();var f=ue;return po(),ho(),Z("startxref"),Z(""+f),Z("%%EOF"),be(Se[z]),de.join(`
`)},_a=p.__private__.getBlob=function(f){return new Blob([qe(f)],{type:"application/pdf"})},Sa=p.output=p.__private__.output=$r(function(f,P){switch(typeof(P=P||{})=="string"?P={filename:P}:P.filename=P.filename||"generated.pdf",f){case void 0:return xn();case"save":p.save(P.filename);break;case"arraybuffer":return qe(xn());case"blob":return _a(xn());case"bloburi":case"bloburl":if(Ge.URL!==void 0&&typeof Ge.URL.createObjectURL=="function")return Ge.URL&&Ge.URL.createObjectURL(_a(xn()))||void 0;Nt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var H="",te=xn();try{H=dl(te)}catch{H=dl(unescape(encodeURIComponent(te)))}return"data:application/pdf;filename="+P.filename+";base64,"+H;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ge)==="[object Window]"){var ce="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';P.pdfObjectUrl&&(ce=P.pdfObjectUrl,xe="");var _e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ce+'"'+xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(P)+");<\/script></body></html>",Te=Ge.open();return Te!==null&&Te.document.write(_e),Te}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ge)==="[object Window]"){var Ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(P.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+P.filename+'" width="500px" height="400px" /></body></html>',tt=Ge.open();if(tt!==null){tt.document.write(Ue);var Ze=this;tt.document.documentElement.querySelector("#pdfViewer").onload=function(){tt.document.title=P.filename,tt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ze.output("bloburl"))}}return tt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ge)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var lt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",P)+'"></iframe></body></html>',kt=Ge.open();if(kt!==null&&(kt.document.write(lt),kt.document.title=P.filename),kt||typeof safari>"u")return kt;break;case"datauri":case"dataurl":return Ge.document.location.href=this.output("datauristring",P);default:return null}}),Zi=function(f){return Array.isArray(Zn)===!0&&Zn.indexOf(f)>-1};switch(a){case"pt":Be=1;break;case"mm":Be=72/25.4;break;case"cm":Be=72/2.54;break;case"in":Be=72;break;case"px":Be=Zi("px_scaling")==1?.75:96/72;break;case"pc":case"em":Be=12;break;case"ex":Be=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Be=a}var nr=null;ve(),R();var mo=function(f){return b!==null?nr.encryptor(f,0):function(P){return P}},Qi=p.__private__.getPageInfo=p.getPageInfo=function(f){if(isNaN(f)||f%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ke[f].objId,pageNumber:f,pageContext:Ke[f]}},Je=p.__private__.getPageInfoByObjId=function(f){if(isNaN(f)||f%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var P in Ke)if(Ke[P].objId===f)break;return Qi(P)},go=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Ke[z].objId,pageNumber:z,pageContext:Ke[z]}};p.addPage=function(){return Ji.apply(this,arguments),this},p.setPage=function(){return Xi.apply(this,arguments),be.call(this,Se[z]),this},p.insertPage=function(f){return this.addPage(),this.movePage(z,f),this},p.movePage=function(f,P){var H,te;if(f>P){H=Se[f],te=Ke[f];for(var ce=f;ce>P;ce--)Se[ce]=Se[ce-1],Ke[ce]=Ke[ce-1];Se[P]=H,Ke[P]=te,this.setPage(P)}else if(f<P){H=Se[f],te=Ke[f];for(var xe=f;xe<P;xe++)Se[xe]=Se[xe+1],Ke[xe]=Ke[xe+1];Se[P]=H,Ke[P]=te,this.setPage(P)}return this},p.deletePage=function(){return lo.apply(this,arguments),this},p.__private__.text=p.text=function(f,P,H,te,ce){var xe,_e,Te,Ue,tt,Ze,lt,kt,Ft,zt=(te=te||{}).scope||this;if(typeof f=="number"&&typeof P=="number"&&(typeof H=="string"||Array.isArray(H))){var ar=H;H=P,P=f,f=ar}if(arguments[3]instanceof He?(X("The transform parameter of text() with a Matrix value"),Ft=ce):(Te=arguments[4],Ue=arguments[5],xt(lt=arguments[3])==="object"&&lt!==null||(typeof Te=="string"&&(Ue=Te,Te=null),typeof lt=="string"&&(Ue=lt,lt=null),typeof lt=="number"&&(Te=lt,lt=null),te={flags:lt,angle:Te,align:Ue})),isNaN(P)||isNaN(H)||f==null)throw new Error("Invalid arguments passed to jsPDF.text");if(f.length===0)return zt;var Gt="",Hr=!1,Nr=typeof te.lineHeightFactor=="number"?te.lineHeightFactor:ta,cn=zt.internal.scaleFactor;function ls(jt){return jt=jt.split("	").join(Array(te.TabLen||9).join(" ")),pr(jt,lt)}function bi(jt){for(var _t,Bt=jt.concat(),Wt=[],Nn=Bt.length;Nn--;)typeof(_t=Bt.shift())=="string"?Wt.push(_t):Array.isArray(jt)&&(_t.length===1||_t[1]===void 0&&_t[2]===void 0)?Wt.push(_t[0]):Wt.push([_t[0],_t[1],_t[2]]);return Wt}function vi(jt,_t){var Bt;if(typeof jt=="string")Bt=_t(jt)[0];else if(Array.isArray(jt)){for(var Wt,Nn,Ai=jt.concat(),qa=[],fs=Ai.length;fs--;)typeof(Wt=Ai.shift())=="string"?qa.push(_t(Wt)[0]):Array.isArray(Wt)&&typeof Wt[0]=="string"&&(Nn=_t(Wt[0],Wt[1],Wt[2]),qa.push([Nn[0],Nn[1],Nn[2]]));Bt=qa}return Bt}var Fa=!1,yi=!0;if(typeof f=="string")Fa=!0;else if(Array.isArray(f)){var wi=f.concat();_e=[];for(var Da,Zt=wi.length;Zt--;)(typeof(Da=wi.shift())!="string"||Array.isArray(Da)&&typeof Da[0]!="string")&&(yi=!1);Fa=yi}if(Fa===!1)throw new Error('Type of text must be string or Array. "'+f+'" is not recognized.');typeof f=="string"&&(f=f.match(/[\r?\n]/)?f.split(/\r\n|\r|\n/g):[f]);var Ea=Ce/zt.internal.scaleFactor,Ia=Ea*(Nr-1);switch(te.baseline){case"bottom":H-=Ia;break;case"top":H+=Ea-Ia;break;case"hanging":H+=Ea-2*Ia;break;case"middle":H+=Ea/2-Ia}if((Ze=te.maxWidth||0)>0&&(typeof f=="string"?f=zt.splitTextToSize(f,Ze):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(jt,_t){return jt.concat(zt.splitTextToSize(_t,Ze))},[]))),xe={text:f,x:P,y:H,options:te,mutex:{pdfEscape:pr,activeFontKey:it,fonts:yt,activeFontSize:Ce}},pt.publish("preProcessText",xe),f=xe.text,Te=(te=xe.options).angle,!(Ft instanceof He)&&Te&&typeof Te=="number"){Te*=Math.PI/180,te.rotationDirection===0&&(Te=-Te),q===L.ADVANCED&&(Te=-Te);var Oa=Math.cos(Te),Ni=Math.sin(Te);Ft=new He(Oa,Ni,-Ni,Oa,0,0)}else Te&&Te instanceof He&&(Ft=Te);q!==L.ADVANCED||Ft||(Ft=nn),(tt=te.charSpace||ka)!==void 0&&(Gt+=Q(h(tt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(kt=te.horizontalScale)!==void 0&&(Gt+=Q(100*kt)+` Tz
`),te.lang;var mr=-1,Lo=te.renderingMode!==void 0?te.renderingMode:te.stroke,ji=zt.internal.getCurrentPageInfo().pageContext;switch(Lo){case 0:case!1:case"fill":mr=0;break;case 1:case!0:case"stroke":mr=1;break;case 2:case"fillThenStroke":mr=2;break;case 3:case"invisible":mr=3;break;case 4:case"fillAndAddForClipping":mr=4;break;case 5:case"strokeAndAddPathForClipping":mr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":mr=6;break;case 7:case"addToPathForClipping":mr=7}var cs=ji.usedRenderingMode!==void 0?ji.usedRenderingMode:-1;mr!==-1?Gt+=mr+` Tr
`:cs!==-1&&(Gt+=`0 Tr
`),mr!==-1&&(ji.usedRenderingMode=mr),Ue=te.align||"left";var Cr,Ba=Ce*Nr,ds=zt.internal.pageSize.getWidth(),us=yt[it];tt=te.charSpace||ka,Ze=te.maxWidth||0,lt=Object.assign({autoencode:!0,noBOM:!0},te.flags);var En=[],aa=function(jt){return zt.getStringUnitWidth(jt,{font:us,charSpace:tt,fontSize:Ce,doKerning:!1})*Ce/cn};if(Object.prototype.toString.call(f)==="[object Array]"){var gr;_e=bi(f),Ue!=="left"&&(Cr=_e.map(aa));var dr,In=0;if(Ue==="right"){P-=Cr[0],f=[],Zt=_e.length;for(var vn=0;vn<Zt;vn++)vn===0?(dr=ln(P),gr=bn(H)):(dr=h(In-Cr[vn]),gr=-Ba),f.push([_e[vn],dr,gr]),In=Cr[vn]}else if(Ue==="center"){P-=Cr[0]/2,f=[],Zt=_e.length;for(var yn=0;yn<Zt;yn++)yn===0?(dr=ln(P),gr=bn(H)):(dr=h((In-Cr[yn])/2),gr=-Ba),f.push([_e[yn],dr,gr]),In=Cr[yn]}else if(Ue==="left"){f=[],Zt=_e.length;for(var Ta=0;Ta<Zt;Ta++)f.push(_e[Ta])}else if(Ue==="justify"&&us.encoding==="Identity-H"){f=[],Zt=_e.length,Ze=Ze!==0?Ze:ds;for(var wn=0,Ot=0;Ot<Zt;Ot++)if(gr=Ot===0?bn(H):-Ba,dr=Ot===0?ln(P):wn,Ot<Zt-1){var _i=h((Ze-Cr[Ot])/(_e[Ot].split(" ").length-1)),ur=_e[Ot].split(" ");f.push([ur[0]+" ",dr,gr]),wn=0;for(var Pr=1;Pr<ur.length;Pr++){var Ma=(aa(ur[Pr-1]+" "+ur[Pr])-aa(ur[Pr]))*cn+_i;Pr==ur.length-1?f.push([ur[Pr],Ma,0]):f.push([ur[Pr]+" ",Ma,0]),wn-=Ma}}else f.push([_e[Ot],dr,gr]);f.push(["",wn,0])}else{if(Ue!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(f=[],Zt=_e.length,Ze=Ze!==0?Ze:ds,Ot=0;Ot<Zt;Ot++)gr=Ot===0?bn(H):-Ba,dr=Ot===0?ln(P):0,Ot<Zt-1?En.push(Q(h((Ze-Cr[Ot])/(_e[Ot].split(" ").length-1)))):En.push(0),f.push([_e[Ot],dr,gr])}}var hs=typeof te.R2L=="boolean"?te.R2L:ze;hs===!0&&(f=vi(f,function(jt,_t,Bt){return[jt.split("").reverse().join(""),_t,Bt]})),xe={text:f,x:P,y:H,options:te,mutex:{pdfEscape:pr,activeFontKey:it,fonts:yt,activeFontSize:Ce}},pt.publish("postProcessText",xe),f=xe.text,Hr=xe.mutex.isHex||!1;var Si=yt[it].encoding;Si!=="WinAnsiEncoding"&&Si!=="StandardEncoding"||(f=vi(f,function(jt,_t,Bt){return[ls(jt),_t,Bt]})),_e=bi(f),f=[];for(var ia,sa,On,oa=0,Ra=1,la=Array.isArray(_e[0])?Ra:oa,Bn="",Li=function(jt,_t,Bt){var Wt="";return Bt instanceof He?(Bt=typeof te.angle=="number"?Rr(Bt,new He(1,0,0,1,jt,_t)):Rr(new He(1,0,0,1,jt,_t),Bt),q===L.ADVANCED&&(Bt=Rr(new He(1,0,0,-1,0,0),Bt)),Wt=Bt.join(" ")+` Tm
`):Wt=Q(jt)+" "+Q(_t)+` Td
`,Wt},Fr=0;Fr<_e.length;Fr++){switch(Bn="",la){case Ra:On=(Hr?"<":"(")+_e[Fr][0]+(Hr?">":")"),ia=parseFloat(_e[Fr][1]),sa=parseFloat(_e[Fr][2]);break;case oa:On=(Hr?"<":"(")+_e[Fr]+(Hr?">":")"),ia=ln(P),sa=bn(H)}En!==void 0&&En[Fr]!==void 0&&(Bn=En[Fr]+` Tw
`),Fr===0?f.push(Bn+Li(ia,sa,Ft)+On):la===oa?f.push(Bn+On):la===Ra&&f.push(Bn+Li(ia,sa,Ft)+On)}f=la===oa?f.join(` Tj
T* `):f.join(` Tj
`),f+=` Tj
`;var Dr=`BT
/`;return Dr+=it+" "+Ce+` Tf
`,Dr+=Q(Ce*Nr)+` TL
`,Dr+=ra+`
`,Dr+=Gt,Dr+=f,Z(Dr+="ET"),y[it]=!0,zt};var xo=p.__private__.clip=p.clip=function(f){return Z(f==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return xo("evenodd")},p.__private__.discardPath=p.discardPath=function(){return Z("n"),this};var on=p.__private__.isValidStyle=function(f){var P=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(f)!==-1&&(P=!0),P};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(f){return on(f)&&(m=f),this};var es=p.__private__.getStyle=p.getStyle=function(f){var P=m;switch(f){case"D":case"S":P="S";break;case"F":P="f";break;case"FD":case"DF":P="B";break;case"f":case"f*":case"B":case"B*":P=f}return P},ts=p.close=function(){return Z("h"),this};p.stroke=function(){return Z("S"),this},p.fill=function(f){return La("f",f),this},p.fillEvenOdd=function(f){return La("f*",f),this},p.fillStroke=function(f){return La("B",f),this},p.fillStrokeEvenOdd=function(f){return La("B*",f),this};var La=function(f,P){xt(P)==="object"?vo(P,f):Z(f)},li=function(f){f===null||q===L.ADVANCED&&f===void 0||(f=es(f),Z(f))};function bo(f,P,H,te,ce){var xe=new Xa(P||this.boundingBox,H||this.xStep,te||this.yStep,this.gState,ce||this.matrix);xe.stream=this.stream;var _e=f+"$$"+this.cloneIndex+++"$$";return fr(_e,xe),xe}var vo=function(f,P){var H=Kn[f.key],te=ft[H];if(te instanceof ha)Z("q"),Z(yo(P)),te.gState&&p.setGState(te.gState),Z(f.matrix.toString()+" cm"),Z("/"+H+" sh"),Z("Q");else if(te instanceof Xa){var ce=new He(1,0,0,-1,0,Dn());f.matrix&&(ce=ce.multiply(f.matrix||nn),H=bo.call(te,f.key,f.boundingBox,f.xStep,f.yStep,ce).id),Z("q"),Z("/Pattern cs"),Z("/"+H+" scn"),te.gState&&p.setGState(te.gState),Z(P),Z("Q")}},yo=function(f){switch(f){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},ci=p.moveTo=function(f,P){return Z(Q(h(f))+" "+Q(S(P))+" m"),this},ea=p.lineTo=function(f,P){return Z(Q(h(f))+" "+Q(S(P))+" l"),this},Pn=p.curveTo=function(f,P,H,te,ce,xe){return Z([Q(h(f)),Q(S(P)),Q(h(H)),Q(S(te)),Q(h(ce)),Q(S(xe)),"c"].join(" ")),this};p.__private__.line=p.line=function(f,P,H,te,ce){if(isNaN(f)||isNaN(P)||isNaN(H)||isNaN(te)||!on(ce))throw new Error("Invalid arguments passed to jsPDF.line");return q===L.COMPAT?this.lines([[H-f,te-P]],f,P,[1,1],ce||"S"):this.lines([[H-f,te-P]],f,P,[1,1]).stroke()},p.__private__.lines=p.lines=function(f,P,H,te,ce,xe){var _e,Te,Ue,tt,Ze,lt,kt,Ft,zt,ar,Gt,Hr;if(typeof f=="number"&&(Hr=H,H=P,P=f,f=Hr),te=te||[1,1],xe=xe||!1,isNaN(P)||isNaN(H)||!Array.isArray(f)||!Array.isArray(te)||!on(ce)||typeof xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ci(P,H),_e=te[0],Te=te[1],tt=f.length,ar=P,Gt=H,Ue=0;Ue<tt;Ue++)(Ze=f[Ue]).length===2?(ar=Ze[0]*_e+ar,Gt=Ze[1]*Te+Gt,ea(ar,Gt)):(lt=Ze[0]*_e+ar,kt=Ze[1]*Te+Gt,Ft=Ze[2]*_e+ar,zt=Ze[3]*Te+Gt,ar=Ze[4]*_e+ar,Gt=Ze[5]*Te+Gt,Pn(lt,kt,Ft,zt,ar,Gt));return xe&&ts(),li(ce),this},p.path=function(f){for(var P=0;P<f.length;P++){var H=f[P],te=H.c;switch(H.op){case"m":ci(te[0],te[1]);break;case"l":ea(te[0],te[1]);break;case"c":Pn.apply(this,te);break;case"h":ts()}}return this},p.__private__.rect=p.rect=function(f,P,H,te,ce){if(isNaN(f)||isNaN(P)||isNaN(H)||isNaN(te)||!on(ce))throw new Error("Invalid arguments passed to jsPDF.rect");return q===L.COMPAT&&(te=-te),Z([Q(h(f)),Q(S(P)),Q(h(H)),Q(h(te)),"re"].join(" ")),li(ce),this},p.__private__.triangle=p.triangle=function(f,P,H,te,ce,xe,_e){if(isNaN(f)||isNaN(P)||isNaN(H)||isNaN(te)||isNaN(ce)||isNaN(xe)||!on(_e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[H-f,te-P],[ce-H,xe-te],[f-ce,P-xe]],f,P,[1,1],_e,!0),this},p.__private__.roundedRect=p.roundedRect=function(f,P,H,te,ce,xe,_e){if(isNaN(f)||isNaN(P)||isNaN(H)||isNaN(te)||isNaN(ce)||isNaN(xe)||!on(_e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Te=4/3*(Math.SQRT2-1);return ce=Math.min(ce,.5*H),xe=Math.min(xe,.5*te),this.lines([[H-2*ce,0],[ce*Te,0,ce,xe-xe*Te,ce,xe],[0,te-2*xe],[0,xe*Te,-ce*Te,xe,-ce,xe],[2*ce-H,0],[-ce*Te,0,-ce,-xe*Te,-ce,-xe],[0,2*xe-te],[0,-xe*Te,ce*Te,-xe,ce,-xe]],f+ce,P,[1,1],_e,!0),this},p.__private__.ellipse=p.ellipse=function(f,P,H,te,ce){if(isNaN(f)||isNaN(P)||isNaN(H)||isNaN(te)||!on(ce))throw new Error("Invalid arguments passed to jsPDF.ellipse");var xe=4/3*(Math.SQRT2-1)*H,_e=4/3*(Math.SQRT2-1)*te;return ci(f+H,P),Pn(f+H,P-_e,f+xe,P-te,f,P-te),Pn(f-xe,P-te,f-H,P-_e,f-H,P),Pn(f-H,P+_e,f-xe,P+te,f,P+te),Pn(f+xe,P+te,f+H,P+_e,f+H,P),li(ce),this},p.__private__.circle=p.circle=function(f,P,H,te){if(isNaN(f)||isNaN(P)||isNaN(H)||!on(te))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(f,P,H,H,te)},p.setFont=function(f,P,H){return H&&(P=$(P,H)),it=Ki(f,P,{disableWarning:!1}),this};var wo=p.__private__.getFont=p.getFont=function(){return yt[Ki.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var f,P,H={};for(f in Lt)if(Lt.hasOwnProperty(f))for(P in H[f]=[],Lt[f])Lt[f].hasOwnProperty(P)&&H[f].push(P);return H},p.addFont=function(f,P,H,te,ce){var xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&xe.indexOf(arguments[3])!==-1?ce=arguments[3]:arguments[3]&&xe.indexOf(arguments[3])==-1&&(H=$(H,te)),ce=ce||"Identity-H",ii.call(this,f,P,H,ce)};var ta,di=n.lineWidth||.200025,Aa=p.__private__.getLineWidth=p.getLineWidth=function(){return di},rs=p.__private__.setLineWidth=p.setLineWidth=function(f){return di=f,Z(Q(h(f))+" w"),this};p.__private__.setLineDash=$e.API.setLineDash=$e.API.setLineDashPattern=function(f,P){if(f=f||[],P=P||0,isNaN(P)||!Array.isArray(f))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return f=f.map(function(H){return Q(h(H))}).join(" "),P=Q(h(P)),Z("["+f+"] "+P+" d"),this};var ns=p.__private__.getLineHeight=p.getLineHeight=function(){return Ce*ta};p.__private__.getLineHeight=p.getLineHeight=function(){return Ce*ta};var as=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(f){return typeof(f=f||1.15)=="number"&&(ta=f),this},is=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return ta};as(n.lineHeight);var ln=p.__private__.getHorizontalCoordinate=function(f){return h(f)},bn=p.__private__.getVerticalCoordinate=function(f){return q===L.ADVANCED?f:Ke[z].mediaBox.topRightY-Ke[z].mediaBox.bottomLeftY-h(f)},No=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(f){return Q(ln(f))},Fn=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(f){return Q(bn(f))},Vr=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return zr(Vr)},p.__private__.setStrokeColor=p.setDrawColor=function(f,P,H,te){return Vr=Ur({ch1:f,ch2:P,ch3:H,ch4:te,pdfColorType:"draw",precision:2}),Z(Vr),this};var ui=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return zr(ui)},p.__private__.setFillColor=p.setFillColor=function(f,P,H,te){return ui=Ur({ch1:f,ch2:P,ch3:H,ch4:te,pdfColorType:"fill",precision:2}),Z(ui),this};var ra=n.textColor||"0 g",jo=p.__private__.getTextColor=p.getTextColor=function(){return zr(ra)};p.__private__.setTextColor=p.setTextColor=function(f,P,H,te){return ra=Ur({ch1:f,ch2:P,ch3:H,ch4:te,pdfColorType:"text",precision:3}),this};var ka=n.charSpace,_o=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(ka||0)};p.__private__.setCharSpace=p.setCharSpace=function(f){if(isNaN(f))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ka=f,this};var hi=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(f){var P=p.CapJoinStyles[f];if(P===void 0)throw new Error("Line cap style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return hi=P,Z(P+" J"),this};var fi=0;p.__private__.setLineJoin=p.setLineJoin=function(f){var P=p.CapJoinStyles[f];if(P===void 0)throw new Error("Line join style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return fi=P,Z(P+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(f){if(f=f||0,isNaN(f))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(Q(h(f))+" M"),this},p.GState=Vs,p.setGState=function(f){(f=typeof f=="string"?Ct[Mr[f]]:ss(null,f)).equals(mn)||(Z("/"+f.id+" gs"),mn=f)};var ss=function(f,P){if(!f||!Mr[f]){var H=!1;for(var te in Ct)if(Ct.hasOwnProperty(te)&&Ct[te].equals(P)){H=!0;break}if(H)P=Ct[te];else{var ce="GS"+(Object.keys(Ct).length+1).toString(10);Ct[ce]=P,P.id=ce}return f&&(Mr[f]=P.id),pt.publish("addGState",P),P}};p.addGState=function(f,P){return ss(f,P),this},p.saveGraphicsState=function(){return Z("q"),en.push({key:it,size:Ce,color:ra}),this},p.restoreGraphicsState=function(){Z("Q");var f=en.pop();return it=f.key,Ce=f.size,ra=f.color,mn=null,this},p.setCurrentTransformationMatrix=function(f){return Z(f.toString()+" cm"),this},p.comment=function(f){return Z("#"+f),this};var Ca=function(f,P){var H=f||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return H},set:function(xe){isNaN(xe)||(H=parseFloat(xe))}});var te=P||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return te},set:function(xe){isNaN(xe)||(te=parseFloat(xe))}});var ce="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ce},set:function(xe){ce=xe.toString()}}),this},pi=function(f,P,H,te){Ca.call(this,f,P),this.type="rect";var ce=H||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ce},set:function(_e){isNaN(_e)||(ce=parseFloat(_e))}});var xe=te||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return xe},set:function(_e){isNaN(_e)||(xe=parseFloat(_e))}}),this},mi=function(){this.page=Pt,this.currentPage=z,this.pages=Se.slice(0),this.pagesContext=Ke.slice(0),this.x=rr,this.y=ut,this.matrix=Tr,this.width=na(z),this.height=Dn(z),this.outputDestination=De,this.id="",this.objectNumber=-1};mi.prototype.restore=function(){Pt=this.page,z=this.currentPage,Ke=this.pagesContext,Se=this.pages,rr=this.x,ut=this.y,Tr=this.matrix,gi(z,this.width),xi(z,this.height),De=this.outputDestination};var os=function(f,P,H,te,ce){rn.push(new mi),Pt=z=0,Se=[],rr=f,ut=P,Tr=ce,si([H,te])},So=function(f){if(tn[f])rn.pop().restore();else{var P=new mi,H="Xo"+(Object.keys(Kt).length+1).toString(10);P.id=H,tn[f]=H,Kt[H]=P,pt.publish("addFormObject",P),rn.pop().restore()}};for(var Pa in p.beginFormObject=function(f,P,H,te,ce){return os(f,P,H,te,ce),this},p.endFormObject=function(f){return So(f),this},p.doFormObject=function(f,P){var H=Kt[tn[f]];return Z("q"),Z(P.toString()+" cm"),Z("/"+H.id+" Do"),Z("Q"),this},p.getFormObject=function(f){var P=Kt[tn[f]];return{x:P.x,y:P.y,width:P.width,height:P.height,matrix:P.matrix}},p.save=function(f,P){return f=f||"generated.pdf",(P=P||{}).returnPromise=P.returnPromise||!1,P.returnPromise===!1?(da(_a(xn()),f),typeof da.unload=="function"&&Ge.setTimeout&&setTimeout(da.unload,911),this):new Promise(function(H,te){try{var ce=da(_a(xn()),f);typeof da.unload=="function"&&Ge.setTimeout&&setTimeout(da.unload,911),H(ce)}catch(xe){te(xe.message)}})},$e.API)$e.API.hasOwnProperty(Pa)&&(Pa==="events"&&$e.API.events.length?function(f,P){var H,te,ce;for(ce=P.length-1;ce!==-1;ce--)H=P[ce][0],te=P[ce][1],f.subscribe.apply(f,[H].concat(typeof te=="function"?[te]:te))}(pt,$e.API.events):p[Pa]=$e.API[Pa]);var na=p.getPageWidth=function(f){return(Ke[f=f||z].mediaBox.topRightX-Ke[f].mediaBox.bottomLeftX)/Be},gi=p.setPageWidth=function(f,P){Ke[f].mediaBox.topRightX=P*Be+Ke[f].mediaBox.bottomLeftX},Dn=p.getPageHeight=function(f){return(Ke[f=f||z].mediaBox.topRightY-Ke[f].mediaBox.bottomLeftY)/Be},xi=p.setPageHeight=function(f,P){Ke[f].mediaBox.topRightY=P*Be+Ke[f].mediaBox.bottomLeftY};return p.internal={pdfEscape:pr,getStyle:es,getFont:wo,getFontSize:Ie,getCharSpace:_o,getTextColor:jo,getLineHeight:ns,getLineHeightFactor:is,getLineWidth:Aa,write:et,getHorizontalCoordinate:ln,getVerticalCoordinate:bn,getCoordinateString:No,getVerticalCoordinateString:Fn,collections:{},newObject:Ht,newAdditionalObject:ga,newObjectDeferred:qt,newObjectDeferredBegin:wr,getFilters:an,putStream:kr,events:pt,scaleFactor:Be,pageSize:{getWidth:function(){return na(z)},setWidth:function(f){gi(z,f)},getHeight:function(){return Dn(z)},setHeight:function(f){xi(z,f)}},encryptionOptions:b,encryption:nr,getEncryptor:mo,output:Sa,getNumberOfPages:co,pages:Se,out:Z,f2:Y,f3:I,getPageInfo:Qi,getPageInfoByObjId:Je,getCurrentPageInfo:go,getPDFVersion:j,Point:Ca,Rectangle:pi,Matrix:He,hasHotfix:Zi},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return na(z)},set:function(f){gi(z,f)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Dn(z)},set:function(f){xi(z,f)},enumerable:!0,configurable:!0}),oo.call(p,Ae),it="F1",Ji(s,r),pt.publish("initialized"),p}Ga.prototype.lsbFirstWord=function(n){return String.fromCharCode(n>>0&255,n>>8&255,n>>16&255,n>>24&255)},Ga.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ga.prototype.hexToBytes=function(n){for(var e=[],r=0;r<n.length;r+=2)e.push(String.fromCharCode(parseInt(n.substr(r,2),16)));return e.join("")},Ga.prototype.processOwnerPassword=function(n,e){return hl(ul(e).substr(0,5),n)},Ga.prototype.encryptor=function(n,e){var r=ul(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(a){return hl(r,a)}},Vs.prototype.equals=function(n){var e,r="id,objectNumber,equals";if(!n||xt(n)!==xt(this))return!1;var a=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;a++}for(e in n)n.hasOwnProperty(e)&&r.indexOf(e)<0&&a--;return a===0},$e.API={events:[]},$e.version="3.0.1";var Et=$e.API,jl=1,ma=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ha=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Qe=function(n){return n.toFixed(2)},Hn=function(n){return n.toFixed(5)};Et.__acroform__={};var yr=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},fc=function(n){return n*jl},un=function(n){var e=new sd,r=Re.internal.getHeight(n)||0,a=Re.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Qe(a)),Number(Qe(r))],e},hh=Et.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|=1<<e},fh=Et.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&=~(1<<e)},ph=Et.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},Tt=Et.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return ph(n,e-1)},Mt=Et.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return hh(n,e-1)},Rt=Et.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return fh(n,e-1)},mh=Et.__acroform__.calculateCoordinates=function(n,e){var r=e.internal.getHorizontalCoordinate,a=e.internal.getVerticalCoordinate,s=n[0],i=n[1],l=n[2],u=n[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=a(i+u)||0,c.upperRight_X=r(s+l)||0,c.upperRight_Y=a(i)||0,[Number(Qe(c.lowerLeft_X)),Number(Qe(c.lowerLeft_Y)),Number(Qe(c.upperRight_X)),Number(Qe(c.upperRight_Y))]},gh=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],r=n._V||n.DV,a=fl(n,r),s=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+s+" "+Qe(a.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=un(n);return i.scope=n.scope,i.stream=e.join(`
`),i}},fl=function(n,e){var r=n.fontSize===0?n.maxFontSize:n.fontSize,a={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=n.multiline?s.map(function(I){return I.split(`
`)}):s.map(function(I){return[I]});var i=r,l=Re.internal.getHeight(n)||0;l=l<0?-l:l;var u=Re.internal.getWidth(n)||0;u=u<0?-u:u;var c=function(I,h,g){if(I+1<s.length){var S=h+" "+s[I+1][0];return Is(S,n,g).width<=u-4}return!1};i++;e:for(;i>0;){e="",i--;var m,b,w=Is("3",n,i).height,y=n.multiline?l-i:(l-w)/2,p=y+=2,_=0,j=0,B=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Is(e,n,i=12).width+", FieldWidth:"+u+`
`;break}for(var v="",L=0,q=0;q<s.length;q++)if(s.hasOwnProperty(q)){var G=!1;if(s[q].length!==1&&B!==s[q].length-1){if((w+2)*(L+2)+2>l)continue e;v+=s[q][B],G=!0,j=q,q--}else{v=(v+=s[q][B]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var K=parseInt(q),$=c(K,v,i),Q=q>=s.length-1;if($&&!Q){v+=" ",B=0;continue}if($||Q){if(Q)j=K;else if(n.multiline&&(w+2)*(L+2)+2>l)continue e}else{if(!n.multiline||(w+2)*(L+2)+2>l)continue e;j=K}}for(var X="",se=_;se<=j;se++){var Y=s[se];if(n.multiline){if(se===j){X+=Y[B]+" ",B=(B+1)%Y.length;continue}if(se===_){X+=Y[Y.length-1]+" ";continue}}X+=Y[0]+" "}switch(X=X.substr(X.length-1)==" "?X.substr(0,X.length-1):X,b=Is(X,n,i).width,n.textAlign){case"right":m=u-b-2;break;case"center":m=(u-b)/2;break;case"left":default:m=2}e+=Qe(m)+" "+Qe(p)+` Td
`,e+="("+ma(X)+`) Tj
`,e+=-Qe(m)+` 0 Td
`,p=-(i+2),b=0,_=G?j:j+1,L++,v=""}break}return a.text=e,a.fontSize=i,a},Is=function(n,e,r){var a=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(n,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},xh={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},bh=function(n,e){var r={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(r)},vh=function(n,e){for(var r in n)if(n.hasOwnProperty(r)){var a=r,s=n[r];e.internal.newObjectDeferredBegin(s.objId,!0),xt(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete n[a]}},yh=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Zr.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(xh)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");jl=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new od,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in a)if(a.hasOwnProperty(s)){var i=a[s];i.objId=void 0,i.hasAnnotation&&bh(i,r)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(r){(function(a,s){var i=!a;for(var l in a||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var u=a[l],c=[],m=u.Rect;if(u.Rect&&(u.Rect=mh(u.Rect,s)),s.internal.newObjectDeferredBegin(u.objId,!0),u.DA=Re.createDefaultAppearanceStream(u),xt(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(c=u.getKeyValueListForStream()),u.Rect=m,u.hasAppearanceStream&&!u.appearanceStreamContent){var b=gh(u);c.push({key:"AP",value:"<</N "+b+">>"}),s.internal.acroformPlugin.xForms.push(b)}if(u.appearanceStreamContent){var w="";for(var y in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(y)){var p=u.appearanceStreamContent[y];if(w+="/"+y+" ",w+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var l in p)if(p.hasOwnProperty(l)){var _=p[l];typeof _=="function"&&(_=_.call(s,u)),w+="/"+l+" "+_+" ",s.internal.acroformPlugin.xForms.indexOf(_)>=0||s.internal.acroformPlugin.xForms.push(_)}}else typeof(_=p)=="function"&&(_=_.call(s,u)),w+="/"+l+" "+_,s.internal.acroformPlugin.xForms.indexOf(_)>=0||s.internal.acroformPlugin.xForms.push(_);w+=">>"}c.push({key:"AP",value:`<<
`+w+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:u.objId}),s.internal.out("endobj")}i&&vh(s.internal.acroformPlugin.xForms,s)})(r,n)}),n.internal.acroformPlugin.isInitialized=!0}},id=Et.__acroform__.arrayToPdfArray=function(n,e,r){var a=function(l){return l};if(Array.isArray(n)){for(var s="[",i=0;i<n.length;i++)switch(i!==0&&(s+=" "),xt(n[i])){case"boolean":case"number":case"object":s+=n[i].toString();break;case"string":n[i].substr(0,1)!=="/"?(e!==void 0&&r&&(a=r.internal.getEncryptor(e)),s+="("+ma(a(n[i].toString()))+")"):s+=n[i].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Xo=function(n,e,r){var a=function(s){return s};return e!==void 0&&r&&(a=r.internal.getEncryptor(e)),(n=n||"").toString(),n="("+ma(a(n))+")"},hn=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};hn.prototype.toString=function(){return this.objId+" 0 R"},hn.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},hn.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var a=e[r],s=this[a];s&&(Array.isArray(s)?n.push({key:a,value:id(s,this.objId,this.scope)}):s instanceof hn?(s.scope=this.scope,n.push({key:a,value:s.objId+" 0 R"})):typeof s!="function"&&n.push({key:a,value:s}))}return n};var sd=function(){hn.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){n=r.trim()},get:function(){return n||null}})};yr(sd,hn);var od=function(){hn.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ma(r(n))+")"}},set:function(r){n=r}})};yr(od,hn);var Zr=function n(){hn.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Tt(e,3)},set:function(v){v?this.F=Mt(e,3):this.F=Rt(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(v){a=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(v){a[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(v){a[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(v){a[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(v){a[3]=v}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Hs)return;i="FieldObject"+n.FieldNum++}var v=function(L){return L};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+ma(v(i))+")"},set:function(v){i=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(v){i=v}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/jl:m},set:function(v){m=v}});var b="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return b},set:function(v){b=v}});var w="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!w||this instanceof Hs||this instanceof fa))return Xo(w,this.objId,this.scope)},set:function(v){v=v.toString(),w=v}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Xt?y:Xo(y,this.objId,this.scope)},set:function(v){v=v.toString(),y=this instanceof Xt?v:v.substr(0,1)==="("?Ha(v.substr(1,v.length-2)):Ha(v)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xt?Ha(y.substr(1,y.length-1)):y},set:function(v){v=v.toString(),y=this instanceof Xt?"/"+v:v}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Xt?p:Xo(p,this.objId,this.scope)},set:function(v){v=v.toString(),p=this instanceof Xt?v:v.substr(0,1)==="("?Ha(v.substr(1,v.length-2)):Ha(v)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xt?Ha(p.substr(1,p.length-1)):p},set:function(v){v=v.toString(),p=this instanceof Xt?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var _,j=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return j},set:function(v){v=!!v,j=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(_)return _},set:function(v){_=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,1)},set:function(v){v?this.Ff=Mt(this.Ff,1):this.Ff=Rt(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,2)},set:function(v){v?this.Ff=Mt(this.Ff,2):this.Ff=Rt(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,3)},set:function(v){v?this.Ff=Mt(this.Ff,3):this.Ff=Rt(this.Ff,3)}});var B=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(B!==null)return B},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');B=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(B){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:B=2;break;case"center":case 1:B=1;break;case"left":case 0:default:B=0}}})};yr(Zr,hn);var Ka=function(){Zr.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(r){n=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return id(e,this.objId,this.scope)},set:function(r){var a,s;s=[],typeof(a=r)=="string"&&(s=function(i,l,u){u||(u=1);for(var c,m=[];c=l.exec(i);)m.push(c[u]);return m}(a,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,18)},set:function(r){r?this.Ff=Mt(this.Ff,18):this.Ff=Rt(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Mt(this.Ff,19):this.Ff=Rt(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,20)},set:function(r){r?(this.Ff=Mt(this.Ff,20),e.sort()):this.Ff=Rt(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,22)},set:function(r){r?this.Ff=Mt(this.Ff,22):this.Ff=Rt(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,23)},set:function(r){r?this.Ff=Mt(this.Ff,23):this.Ff=Rt(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,27)},set:function(r){r?this.Ff=Mt(this.Ff,27):this.Ff=Rt(this.Ff,27)}}),this.hasAppearanceStream=!1};yr(Ka,Zr);var Za=function(){Ka.call(this),this.fontName="helvetica",this.combo=!1};yr(Za,Ka);var Qa=function(){Za.call(this),this.combo=!0};yr(Qa,Za);var Ms=function(){Qa.call(this),this.edit=!0};yr(Ms,Qa);var Xt=function(){Zr.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,15)},set:function(r){r?this.Ff=Mt(this.Ff,15):this.Ff=Rt(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,16)},set:function(r){r?this.Ff=Mt(this.Ff,16):this.Ff=Rt(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,17)},set:function(r){r?this.Ff=Mt(this.Ff,17):this.Ff=Rt(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,26)},set:function(r){r?this.Ff=Mt(this.Ff,26):this.Ff=Rt(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var a,s=[];for(a in s.push("<<"),e)s.push("/"+a+" ("+ma(r(e[a]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){xt(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}})};yr(Xt,Zr);var Rs=function(){Xt.call(this),this.pushButton=!0};yr(Rs,Xt);var ei=function(){Xt.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};yr(ei,Xt);var Hs=function(){var n,e;Zr.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(u){return u};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,l=[];for(i in l.push("<<"),a)l.push("/"+i+" ("+ma(s(a[i]))+")");return l.push(">>"),l.join(`
`)},set:function(s){xt(s)==="object"&&(a=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(s){typeof s=="string"&&(a.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Re.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};yr(Hs,Zr),ei.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=n.createAppearanceStream(r.optionName),r.caption=n.getCA()}},ei.prototype.createOption=function(n){var e=new Hs;return e.Parent=this,e.optionName=n,this.Kids.push(e),wh.call(this.scope,e),e};var qs=function(){Xt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Re.CheckBox.createAppearanceStream()};yr(qs,Xt);var fa=function(){Zr.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,13)},set:function(e){e?this.Ff=Mt(this.Ff,13):this.Ff=Rt(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,21)},set:function(e){e?this.Ff=Mt(this.Ff,21):this.Ff=Rt(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,23)},set:function(e){e?this.Ff=Mt(this.Ff,23):this.Ff=Rt(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,24)},set:function(e){e?this.Ff=Mt(this.Ff,24):this.Ff=Rt(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,25)},set:function(e){e?this.Ff=Mt(this.Ff,25):this.Ff=Rt(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,26)},set:function(e){e?this.Ff=Mt(this.Ff,26):this.Ff=Rt(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};yr(fa,Zr);var zs=function(){fa.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Tt(this.Ff,14)},set:function(n){n?this.Ff=Mt(this.Ff,14):this.Ff=Rt(this.Ff,14)}}),this.password=!0};yr(zs,fa);var Re={CheckBox:{createAppearanceStream:function(){return{N:{On:Re.CheckBox.YesNormal},D:{On:Re.CheckBox.YesPushDown,Off:Re.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=un(n);e.scope=n.scope;var r=[],a=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),i=fl(n,n.caption);return r.push("0.749023 g"),r.push("0 0 "+Qe(Re.internal.getWidth(n))+" "+Qe(Re.internal.getHeight(n))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Qe(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(n){var e=un(n);e.scope=n.scope;var r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,a=n.scope.__private__.encodeColorString(n.color),s=[],i=Re.internal.getHeight(n),l=Re.internal.getWidth(n),u=fl(n,n.caption);return s.push("1 g"),s.push("0 0 "+Qe(l)+" "+Qe(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Qe(l-1)+" "+Qe(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Qe(u.fontSize)+" Tf "+a),s.push(u.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(n){var e=un(n);e.scope=n.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Qe(Re.internal.getWidth(n))+" "+Qe(Re.internal.getHeight(n))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:Re.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=Re.RadioButton.Circle.YesNormal,e.D[n]=Re.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=un(n);e.scope=n.scope;var r=[],a=Re.internal.getWidth(n)<=Re.internal.getHeight(n)?Re.internal.getWidth(n)/4:Re.internal.getHeight(n)/4;a=Number((.9*a).toFixed(5));var s=Re.internal.Bezier_C,i=Number((a*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Hn(Re.internal.getWidth(n)/2)+" "+Hn(Re.internal.getHeight(n)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(n){var e=un(n);e.scope=n.scope;var r=[],a=Re.internal.getWidth(n)<=Re.internal.getHeight(n)?Re.internal.getWidth(n)/4:Re.internal.getHeight(n)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Re.internal.Bezier_C).toFixed(5)),l=Number((a*Re.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Hn(Re.internal.getWidth(n)/2)+" "+Hn(Re.internal.getHeight(n)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Hn(Re.internal.getWidth(n)/2)+" "+Hn(Re.internal.getHeight(n)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=un(n);e.scope=n.scope;var r=[],a=Re.internal.getWidth(n)<=Re.internal.getHeight(n)?Re.internal.getWidth(n)/4:Re.internal.getHeight(n)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Re.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Hn(Re.internal.getWidth(n)/2)+" "+Hn(Re.internal.getHeight(n)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:Re.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=Re.RadioButton.Cross.YesNormal,e.D[n]=Re.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=un(n);e.scope=n.scope;var r=[],a=Re.internal.calculateCross(n);return r.push("q"),r.push("1 1 "+Qe(Re.internal.getWidth(n)-2)+" "+Qe(Re.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(Qe(a.x1.x)+" "+Qe(a.x1.y)+" m"),r.push(Qe(a.x2.x)+" "+Qe(a.x2.y)+" l"),r.push(Qe(a.x4.x)+" "+Qe(a.x4.y)+" m"),r.push(Qe(a.x3.x)+" "+Qe(a.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(n){var e=un(n);e.scope=n.scope;var r=Re.internal.calculateCross(n),a=[];return a.push("0.749023 g"),a.push("0 0 "+Qe(Re.internal.getWidth(n))+" "+Qe(Re.internal.getHeight(n))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Qe(Re.internal.getWidth(n)-2)+" "+Qe(Re.internal.getHeight(n)-2)+" re"),a.push("W"),a.push("n"),a.push(Qe(r.x1.x)+" "+Qe(r.x1.y)+" m"),a.push(Qe(r.x2.x)+" "+Qe(r.x2.y)+" l"),a.push(Qe(r.x4.x)+" "+Qe(r.x4.y)+" m"),a.push(Qe(r.x3.x)+" "+Qe(r.x3.y)+" l"),a.push("s"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(n){var e=un(n);e.scope=n.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Qe(Re.internal.getWidth(n))+" "+Qe(Re.internal.getHeight(n))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+r}};Re.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=Re.internal.getWidth(n),r=Re.internal.getHeight(n),a=Math.min(e,r);return{x1:{x:(e-a)/2,y:(r-a)/2+a},x2:{x:(e-a)/2+a,y:(r-a)/2},x3:{x:(e-a)/2,y:(r-a)/2},x4:{x:(e-a)/2+a,y:(r-a)/2+a}}}},Re.internal.getWidth=function(n){var e=0;return xt(n)==="object"&&(e=fc(n.Rect[2])),e},Re.internal.getHeight=function(n){var e=0;return xt(n)==="object"&&(e=fc(n.Rect[3])),e};var wh=Et.addField=function(n){if(yh(this,n),!(n instanceof Zr))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Et.AcroFormChoiceField=Ka,Et.AcroFormListBox=Za,Et.AcroFormComboBox=Qa,Et.AcroFormEditBox=Ms,Et.AcroFormButton=Xt,Et.AcroFormPushButton=Rs,Et.AcroFormRadioButton=ei,Et.AcroFormCheckBox=qs,Et.AcroFormTextField=fa,Et.AcroFormPasswordField=zs,Et.AcroFormAppearance=Re,Et.AcroForm={ChoiceField:Ka,ListBox:Za,ComboBox:Qa,EditBox:Ms,Button:Xt,PushButton:Rs,RadioButton:ei,CheckBox:qs,TextField:fa,PasswordField:zs,Appearance:Re},$e.AcroForm={ChoiceField:Ka,ListBox:Za,ComboBox:Qa,EditBox:Ms,Button:Xt,PushButton:Rs,RadioButton:ei,CheckBox:qs,TextField:fa,PasswordField:zs,Appearance:Re};function ld(n){return n.reduce(function(e,r,a){return e[r]=a,e},{})}(function(n){n.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=n.__addimage__.getImageFileTypeByImageData=function(I,h){var g,S,D,F,A,R=e;if((h=h||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if($(I))for(A in r)for(D=r[A],g=0;g<D.length;g+=1){for(F=!0,S=0;S<D[g].length;S+=1)if(D[g][S]!==void 0&&D[g][S]!==I[S]){F=!1;break}if(F===!0){R=A;break}}else for(A in r)for(D=r[A],g=0;g<D.length;g+=1){for(F=!0,S=0;S<D[g].length;S+=1)if(D[g][S]!==void 0&&D[g][S]!==I.charCodeAt(S)){F=!1;break}if(F===!0){R=A;break}}return R===e&&h!==e&&(R=h),R},s=function I(h){for(var g=this.internal.write,S=this.internal.putStream,D=(0,this.internal.getFilters)();D.indexOf("FlateEncode")!==-1;)D.splice(D.indexOf("FlateEncode"),1);h.objectId=this.internal.newObject();var F=[];if(F.push({key:"Type",value:"/XObject"}),F.push({key:"Subtype",value:"/Image"}),F.push({key:"Width",value:h.width}),F.push({key:"Height",value:h.height}),h.colorSpace===B.INDEXED?F.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(h.palette.length/3-1)+" "+("sMask"in h&&h.sMask!==void 0?h.objectId+2:h.objectId+1)+" 0 R]"}):(F.push({key:"ColorSpace",value:"/"+h.colorSpace}),h.colorSpace===B.DEVICE_CMYK&&F.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),F.push({key:"BitsPerComponent",value:h.bitsPerComponent}),"decodeParameters"in h&&h.decodeParameters!==void 0&&F.push({key:"DecodeParms",value:"<<"+h.decodeParameters+">>"}),"transparency"in h&&Array.isArray(h.transparency)){for(var A="",R=0,J=h.transparency.length;R<J;R++)A+=h.transparency[R]+" "+h.transparency[R]+" ";F.push({key:"Mask",value:"["+A+"]"})}h.sMask!==void 0&&F.push({key:"SMask",value:h.objectId+1+" 0 R"});var re=h.filter!==void 0?["/"+h.filter]:void 0;if(S({data:h.data,additionalKeyValues:F,alreadyAppliedFilters:re,objectId:h.objectId}),g("endobj"),"sMask"in h&&h.sMask!==void 0){var ve="/Predictor "+h.predictor+" /Colors 1 /BitsPerComponent "+h.bitsPerComponent+" /Columns "+h.width,k={width:h.width,height:h.height,colorSpace:"DeviceGray",bitsPerComponent:h.bitsPerComponent,decodeParameters:ve,data:h.sMask};"filter"in h&&(k.filter=h.filter),I.call(this,k)}if(h.colorSpace===B.INDEXED){var z=this.internal.newObject();S({data:X(new Uint8Array(h.palette)),objectId:z}),g("endobj")}},i=function(){var I=this.internal.collections.addImage_images;for(var h in I)s.call(this,I[h])},l=function(){var I,h=this.internal.collections.addImage_images,g=this.internal.write;for(var S in h)g("/I"+(I=h[S]).index,I.objectId,"0","R")},u=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},c=function(){var I=this.internal.collections.addImage_images;return u.call(this),I},m=function(){return Object.keys(this.internal.collections.addImage_images).length},b=function(I){return typeof n["process"+I.toUpperCase()]=="function"},w=function(I){return xt(I)==="object"&&I.nodeType===1},y=function(I,h){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var g=""+I.getAttribute("src");if(g.indexOf("data:image/")===0)return Mi(unescape(g).split("base64,").pop());var S=n.loadFile(g,!0);if(S!==void 0)return S}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var D;switch(h){case"PNG":D="image/png";break;case"WEBP":D="image/webp";break;case"JPEG":case"JPG":default:D="image/jpeg"}return Mi(I.toDataURL(D,1).split("base64,").pop())}},p=function(I){var h=this.internal.collections.addImage_images;if(h){for(var g in h)if(I===h[g].alias)return h[g]}},_=function(I,h,g){return I||h||(I=-96,h=-96),I<0&&(I=-1*g.width*72/I/this.internal.scaleFactor),h<0&&(h=-1*g.height*72/h/this.internal.scaleFactor),I===0&&(I=h*g.width/g.height),h===0&&(h=I*g.height/g.width),[I,h]},j=function(I,h,g,S,D,F){var A=_.call(this,g,S,D),R=this.internal.getCoordinateString,J=this.internal.getVerticalCoordinateString,re=c.call(this);if(g=A[0],S=A[1],re[D.index]=D,F){F*=Math.PI/180;var ve=Math.cos(F),k=Math.sin(F),z=function(ee){return ee.toFixed(4)},V=[z(ve),z(k),z(-1*k),z(ve),0,0,"cm"]}this.internal.write("q"),F?(this.internal.write([1,"0","0",1,R(I),J(h+S),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([R(g),"0","0",R(S),"0","0","cm"].join(" "))):this.internal.write([R(g),"0","0",R(S),R(I),J(h+S),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+D.index+" Do"),this.internal.write("Q")},B=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},L=n.__addimage__.sHashCode=function(I){var h,g,S=0;if(typeof I=="string")for(g=I.length,h=0;h<g;h++)S=(S<<5)-S+I.charCodeAt(h),S|=0;else if($(I))for(g=I.byteLength/2,h=0;h<g;h++)S=(S<<5)-S+I[h],S|=0;return S},q=n.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var h=!0;return I.length===0&&(h=!1),I.length%4!=0&&(h=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(h=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(h=!1),h},G=n.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var h=I.indexOf(",");return h<0?null:I.substring(0,h).trim().endsWith("base64")?I.substring(h+1):null},K=n.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};n.__addimage__.isArrayBuffer=function(I){return K()&&I instanceof ArrayBuffer};var $=n.__addimage__.isArrayBufferView=function(I){return K()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},Q=n.__addimage__.binaryStringToUint8Array=function(I){for(var h=I.length,g=new Uint8Array(h),S=0;S<h;S++)g[S]=I.charCodeAt(S);return g},X=n.__addimage__.arrayBufferToBinaryString=function(I){for(var h="",g=$(I)?I:new Uint8Array(I),S=0;S<g.length;S+=8192)h+=String.fromCharCode.apply(null,g.subarray(S,S+8192));return h};n.addImage=function(){var I,h,g,S,D,F,A,R,J;if(typeof arguments[1]=="number"?(h=e,g=arguments[1],S=arguments[2],D=arguments[3],F=arguments[4],A=arguments[5],R=arguments[6],J=arguments[7]):(h=arguments[1],g=arguments[2],S=arguments[3],D=arguments[4],F=arguments[5],A=arguments[6],R=arguments[7],J=arguments[8]),xt(I=arguments[0])==="object"&&!w(I)&&"imageData"in I){var re=I;I=re.imageData,h=re.format||h||e,g=re.x||g||0,S=re.y||S||0,D=re.w||re.width||D,F=re.h||re.height||F,A=re.alias||A,R=re.compression||R,J=re.rotation||re.angle||J}var ve=this.internal.getFilters();if(R===void 0&&ve.indexOf("FlateEncode")!==-1&&(R="SLOW"),isNaN(g)||isNaN(S))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var k=se.call(this,I,h,A,R);return j.call(this,g,S,D,F,k,J),this};var se=function(I,h,g,S){var D,F,A;if(typeof I=="string"&&a(I)===e){I=unescape(I);var R=Y(I,!1);(R!==""||(R=n.loadFile(I,!0))!==void 0)&&(I=R)}if(w(I)&&(I=y(I,h)),h=a(I,h),!b(h))throw new Error("addImage does not support files of type '"+h+"', please ensure that a plugin for '"+h+"' support is added.");if(((A=g)==null||A.length===0)&&(g=function(J){return typeof J=="string"||$(J)?L(J):$(J.data)?L(J.data):null}(I)),(D=p.call(this,g))||(K()&&(I instanceof Uint8Array||h==="RGBA"||(F=I,I=Q(I))),D=this["process"+h.toUpperCase()](I,m.call(this),g,function(J){return J&&typeof J=="string"&&(J=J.toUpperCase()),J in n.image_compression?J:v.NONE}(S),F)),!D)throw new Error("An unknown error occurred whilst processing the image.");return D},Y=n.__addimage__.convertBase64ToBinaryString=function(I,h){h=typeof h!="boolean"||h;var g,S="";if(typeof I=="string"){var D;g=(D=G(I))!==null&&D!==void 0?D:I;try{S=Mi(g)}catch(F){if(h)throw q(g)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+F.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return S};n.getImageProperties=function(I){var h,g,S="";if(w(I)&&(I=y(I)),typeof I=="string"&&a(I)===e&&((S=Y(I,!1))===""&&(S=n.loadFile(I)||""),I=S),g=a(I),!b(g))throw new Error("addImage does not support files of type '"+g+"', please ensure that a plugin for '"+g+"' support is added.");if(!K()||I instanceof Uint8Array||(I=Q(I)),!(h=this["process"+g.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return h.fileType=g,h}})($e.API),function(n){var e=function(r){if(r!==void 0&&r!="")return!0};$e.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(r){for(var a,s,i,l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),m=r.pageContext.annotations,b=!1,w=0;w<m.length&&!b;w++)switch((a=m[w]).type){case"link":(e(a.options.url)||e(a.options.pageNumber))&&(b=!0);break;case"reference":case"text":case"freetext":b=!0}if(b!=0){this.internal.write("/Annots [");for(var y=0;y<m.length;y++){a=m[y];var p=this.internal.pdfEscape,_=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var j=this.internal.newAdditionalObject(),B=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(j.objId),L=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+l(a.bounds.x)+" "+u(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+u(a.bounds.y)+"] ")+"/Contents ("+p(v(a.contents))+")",i+=" /Popup "+B.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+p(v(L))+") >>",j.content=i;var q=j.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+l(a.bounds.x+30)+" "+u(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+u(a.bounds.y)+"] ")+" /Parent "+q,a.open&&(i+=" /Open true"),i+=" >>",B.content=i,this.internal.write(j.objId,"0 R",B.objId,"0 R");break;case"freetext":s="/Rect ["+l(a.bounds.x)+" "+u(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+u(a.bounds.y+a.bounds.h)+"] ";var G=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+p(_(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+G+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var K=this.annotations._nameMap[a.options.name];a.options.pageNumber=K.page,a.options.top=K.y}else a.options.top||(a.options.top=0);if(s="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+p(_(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var $=u(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+$+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),n.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},n.link=function(r,a,s,i,l){var u=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:c(r),y:m(a),w:c(r+s),h:m(a+i)},options:l,type:"link"})},n.textWithLink=function(r,a,s,i){var l,u,c=this.getTextWidth(r),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){u=i.maxWidth;var b=this.splitTextToSize(r,u).length;l=Math.ceil(m*b)}else u=c,l=m;return this.text(r,a,s,i),s+=.2*m,i.align==="center"&&(a-=c/2),i.align==="right"&&(a-=c),this.link(a,s-m,u,l,i),c},n.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}($e.API),function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];n.__arabicParser__={};var i=n.__arabicParser__.isInArabicSubstitutionA=function(j){return e[j.charCodeAt(0)]!==void 0},l=n.__arabicParser__.isArabicLetter=function(j){return typeof j=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(j)},u=n.__arabicParser__.isArabicEndLetter=function(j){return l(j)&&i(j)&&e[j.charCodeAt(0)].length<=2},c=n.__arabicParser__.isArabicAlfLetter=function(j){return l(j)&&s.indexOf(j.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(j){return l(j)&&i(j)&&e[j.charCodeAt(0)].length>=1};var m=n.__arabicParser__.arabicLetterHasFinalForm=function(j){return l(j)&&i(j)&&e[j.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(j){return l(j)&&i(j)&&e[j.charCodeAt(0)].length>=3};var b=n.__arabicParser__.arabicLetterHasMedialForm=function(j){return l(j)&&i(j)&&e[j.charCodeAt(0)].length==4},w=n.__arabicParser__.resolveLigatures=function(j){var B=0,v=r,L="",q=0;for(B=0;B<j.length;B+=1)v[j.charCodeAt(B)]!==void 0?(q++,typeof(v=v[j.charCodeAt(B)])=="number"&&(L+=String.fromCharCode(v),v=r,q=0),B===j.length-1&&(v=r,L+=j.charAt(B-(q-1)),B-=q-1,q=0)):(v=r,L+=j.charAt(B-q),B-=q,q=0);return L};n.__arabicParser__.isArabicDiacritic=function(j){return j!==void 0&&a[j.charCodeAt(0)]!==void 0};var y=n.__arabicParser__.getCorrectForm=function(j,B,v){return l(j)?i(j)===!1?-1:!m(j)||!l(B)&&!l(v)||!l(v)&&u(B)||u(j)&&!l(B)||u(j)&&c(B)||u(j)&&u(B)?0:b(j)&&l(B)&&!u(B)&&l(v)&&m(v)?3:u(j)||!l(v)?1:2:-1},p=function(j){var B=0,v=0,L=0,q="",G="",K="",$=(j=j||"").split("\\s+"),Q=[];for(B=0;B<$.length;B+=1){for(Q.push(""),v=0;v<$[B].length;v+=1)q=$[B][v],G=$[B][v-1],K=$[B][v+1],l(q)?(L=y(q,G,K),Q[B]+=L!==-1?String.fromCharCode(e[q.charCodeAt(0)][L]):q):Q[B]+=q;Q[B]=w(Q[B])}return Q.join(" ")},_=n.__arabicParser__.processArabic=n.processArabic=function(){var j,B=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(B)){var L=0;for(v=[],L=0;L<B.length;L+=1)Array.isArray(B[L])?v.push([p(B[L][0]),B[L][1],B[L][2]]):v.push([p(B[L])]);j=v}else j=p(B);return typeof arguments[0]=="string"?j:(arguments[0].text=j,arguments[0])};n.events.push(["preProcessText",_])}($e.API),$e.API.autoPrint=function(n){var e;switch((n=n||{}).variant=n.variant||"non-conform",n.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(n){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(u){r=u}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(u){a=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(u){s=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(u){i=u}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(u){l=u}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,a){var s;if((r=r||"2d")!=="2d")return null;for(s in a)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=a[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}($e.API),function(n){var e={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(j){c=j}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(j){m=j}});var b=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return b},set:function(j){b=j}});var w=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return w},set:function(j){w=j}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(j){y=j}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(j){p=j}});var _=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return _},set:function(j){_=j}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(c){return a.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},n.getTextDimensions=function(c,m){a.call(this);var b=(m=m||{}).fontSize||this.getFontSize(),w=m.font||this.getFont(),y=m.scaleFactor||this.internal.scaleFactor,p=0,_=0,j=0,B=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=m.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(q,G){return q.concat(B.splitTextToSize(G,v))},[])):c=Array.isArray(c)?c:[c];for(var L=0;L<c.length;L++)p<(j=this.getStringUnitWidth(c[L],{font:w})*b)&&(p=j);return p!==0&&(_=c.length),{w:p/=y,h:Math.max((_*b*this.getLineHeightFactor()-b*(this.getLineHeightFactor()-1))/y,0)}},n.cellAddPage=function(){a.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=n.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var m=this.internal.__cell__.lastCell,b=this.internal.__cell__.padding,w=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===c.lineNumber?(c.x=(m.x||0)+(m.width||0),c.y=m.y||0):m.y+m.height+c.height+w.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=w.top,p&&y&&(this.printHeaderRow(c.lineNumber,!0),c.y+=y[0].height)):c.y=m.y+m.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-b,c.y+b,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+b,{align:"center",baseline:"top",maxWidth:c.width-b-b}):this.text(c.text,c.x+b,c.y+b,{align:"left",baseline:"top",maxWidth:c.width-b-b})),this.internal.__cell__.lastCell=c,this};n.table=function(c,m,b,w,y){if(a.call(this),!b)throw new Error("No data for PDF table.");var p,_,j,B,v=[],L=[],q=[],G={},K={},$=[],Q=[],X=(y=y||{}).autoSize||!1,se=y.printHeaders!==!1,Y=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,I=y.margins||Object.assign({width:this.getPageWidth()},e),h=typeof y.padding=="number"?y.padding:3,g=y.headerBackgroundColor||"#c8c8c8",S=y.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=se,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=Y,this.internal.__cell__.padding=h,this.internal.__cell__.headerBackgroundColor=g,this.internal.__cell__.headerTextColor=S,this.setFontSize(Y),w==null)L=v=Object.keys(b[0]),q=v.map(function(){return"left"});else if(Array.isArray(w)&&xt(w[0])==="object")for(v=w.map(function(re){return re.name}),L=w.map(function(re){return re.prompt||re.name||""}),q=w.map(function(re){return re.align||"left"}),p=0;p<w.length;p+=1)K[w[p].name]=w[p].width*(19.049976/25.4);else Array.isArray(w)&&typeof w[0]=="string"&&(L=v=w,q=v.map(function(){return"left"}));if(X||Array.isArray(w)&&typeof w[0]=="string")for(p=0;p<v.length;p+=1){for(G[B=v[p]]=b.map(function(re){return re[B]}),this.setFont(void 0,"bold"),$.push(this.getTextDimensions(L[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),_=G[B],this.setFont(void 0,"normal"),j=0;j<_.length;j+=1)$.push(this.getTextDimensions(_[j],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);K[B]=Math.max.apply(null,$)+h+h,$=[]}if(se){var D={};for(p=0;p<v.length;p+=1)D[v[p]]={},D[v[p]].text=L[p],D[v[p]].align=q[p];var F=u.call(this,D,K);Q=v.map(function(re){return new i(c,m,K[re],F,D[re].text,void 0,D[re].align)}),this.setTableHeaderRow(Q),this.printHeaderRow(1,!1)}var A=w.reduce(function(re,ve){return re[ve.name]=ve.align,re},{});for(p=0;p<b.length;p+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:p,data:b[p]},this);var R=u.call(this,b[p],K);for(j=0;j<v.length;j+=1){var J=b[p][v[j]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:p,col:j,data:J},this),l.call(this,new i(c,m,K[v[j]],R,J,p+2,A[v[j]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=m,this};var u=function(c,m){var b=this.internal.__cell__.padding,w=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(c).map(function(p){var _=c[p];return this.splitTextToSize(_.hasOwnProperty("text")?_.text:_,m[p]-b-b)},this).map(function(p){return this.getLineHeightFactor()*p.length*w/y+b+b},this).reduce(function(p,_){return Math.max(p,_)},0)};n.setTableHeaderRow=function(c){a.call(this),this.internal.__cell__.tableHeaderRow=c},n.printHeaderRow=function(c,m){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var b;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var w=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(w[0],w[1],w[2],w[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){b=this.internal.__cell__.tableHeaderRow[p].clone(),m&&(b.y=this.internal.__cell__.margins.top||0,y.push(b)),b.lineNumber=c;var _=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,b),this.setTextColor(_)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),r=!1}}($e.API);var cd={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},dd=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],pl=ld(dd),ud=[100,200,300,400,500,600,700,800,900],Nh=ld(ud);function ml(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return cd[i=i||"normal"]?i:"normal"}(n.style),a=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(n.weight),s=function(i){return typeof pl[i=i||"normal"]=="number"?i:"normal"}(n.stretch);return{family:e,style:r,weight:a,stretch:s,src:n.src||[],ref:n.ref||{name:e,style:[s,r,a].join(" ")}}}function pc(n,e,r,a){var s;for(s=r;s>=0&&s<e.length;s+=a)if(n[e[s]])return n[e[s]];for(s=r;s>=0&&s<e.length;s-=a)if(n[e[s]])return n[e[s]]}var jh={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},mc={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function gc(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function _h(n,e,r){for(var a=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},jh,r.genericFontFamilies||{}),i=null,l=null,u=0;u<e.length;++u)if(s[(i=ml(e[u])).family]&&(i.family=s[i.family]),n.hasOwnProperty(i.family)){l=n[i.family];break}if(!(l=l||n[a]))throw new Error("Could not find a font-family for the rule '"+gc(i)+"' and default family '"+a+"'.");if(l=function(c,m){if(m[c])return m[c];var b=pl[c],w=b<=pl.normal?-1:1,y=pc(m,dd,b,w);if(!y)throw new Error("Could not find a matching font-stretch value for "+c);return y}(i.stretch,l),l=function(c,m){if(m[c])return m[c];for(var b=cd[c],w=0;w<b.length;++w)if(m[b[w]])return m[b[w]];throw new Error("Could not find a matching font-style for "+c)}(i.style,l),!(l=function(c,m){if(m[c])return m[c];if(c===400&&m[500])return m[500];if(c===500&&m[400])return m[400];var b=Nh[c],w=pc(m,ud,b,c<400?-1:1);if(!w)throw new Error("Could not find a matching font-weight for value "+c);return w}(i.weight,l)))throw new Error("Failed to resolve a font for the rule '"+gc(i)+"'.");return l}function xc(n){return n.trimLeft()}function Sh(n,e){for(var r=0;r<n.length;){if(n.charAt(r)===e)return[n.substring(0,r),n.substring(r+1)];r+=1}return null}function Lh(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Os,bc,vc,Ko=["times"];(function(n){var e,r,a,s,i,l,u,c,m,b=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new c,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new l,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new l,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new w(this),e=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,l=this.internal.Point,u=this.internal.Rectangle,c=this.internal.Matrix,m=new b}]);var w=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=k;Object.defineProperty(this,"pdf",{get:function(){return z}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(be){V=!!be}});var ee=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ee},set:function(be){ee=!!be}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(be){isNaN(be)||(W=be)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(be){isNaN(be)||(ne=be)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(be){var Z;typeof be=="number"?Z=[be,be,be,be]:((Z=new Array(4))[0]=be[0],Z[1]=be.length>=2?be[1]:Z[0],Z[2]=be.length>=3?be[2]:Z[0],Z[3]=be.length>=4?be[3]:Z[1]),m.margin=Z}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(be){de=be}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(be){ue=be}});var Le=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Le},set:function(be){Le=be}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(be){be instanceof b&&(m=be)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(be){m.path=be}});var Se=[];Object.defineProperty(this,"ctxStack",{get:function(){return Se},set:function(be){Se=be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(be){var Z;Z=y(be),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(be){var Z=y(be);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(be){["butt","round","square"].indexOf(be)!==-1&&(this.ctx.lineCap=be,this.pdf.setLineCap(be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(be){isNaN(be)||(this.ctx.lineWidth=be,this.pdf.setLineWidth(be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(be){["bevel","round","miter"].indexOf(be)!==-1&&(this.ctx.lineJoin=be,this.pdf.setLineJoin(be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(be){isNaN(be)||(this.ctx.miterLimit=be,this.pdf.setMiterLimit(be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(be){this.ctx.textBaseline=be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(be){["right","end","center","left","start"].indexOf(be)!==-1&&(this.ctx.textAlign=be)}});var ke=null;function De(be,Z){if(ke===null){var et=function(qe){var Ae=[];return Object.keys(qe).forEach(function(Ce){qe[Ce].forEach(function(Oe){var Ie=null;switch(Oe){case"bold":Ie={family:Ce,weight:"bold"};break;case"italic":Ie={family:Ce,style:"italic"};break;case"bolditalic":Ie={family:Ce,weight:"bold",style:"italic"};break;case"":case"normal":Ie={family:Ce}}Ie!==null&&(Ie.ref={name:Ce,style:Oe},Ae.push(Ie))})}),Ae}(be.getFontList());ke=function(qe){for(var Ae={},Ce=0;Ce<qe.length;++Ce){var Oe=ml(qe[Ce]),Ie=Oe.family,ze=Oe.stretch,Xe=Oe.style,nt=Oe.weight;Ae[Ie]=Ae[Ie]||{},Ae[Ie][ze]=Ae[Ie][ze]||{},Ae[Ie][ze][Xe]=Ae[Ie][ze][Xe]||{},Ae[Ie][ze][Xe][nt]=Oe}return Ae}(et.concat(Z))}return ke}var We=null;Object.defineProperty(this,"fontFaces",{get:function(){return We},set:function(be){ke=null,We=be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(be){var Z;if(this.ctx.font=be,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(be))!==null){var et=Z[1];Z[2];var qe=Z[3],Ae=Z[4];Z[5];var Ce=Z[6],Oe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ae)[2];Ae=Math.floor(Oe==="px"?parseFloat(Ae)*this.pdf.internal.scaleFactor:Oe==="em"?parseFloat(Ae)*this.pdf.getFontSize():parseFloat(Ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ae);var Ie=function(Ye){var it,Be,rr=[],ut=Ye.trim();if(ut==="")return Ko;if(ut in mc)return[mc[ut]];for(;ut!=="";){switch(Be=null,it=(ut=xc(ut)).charAt(0)){case'"':case"'":Be=Sh(ut.substring(1),it);break;default:Be=Lh(ut)}if(Be===null||(rr.push(Be[0]),(ut=xc(Be[1]))!==""&&ut.charAt(0)!==","))return Ko;ut=ut.replace(/^,/,"")}return rr}(Ce);if(this.fontFaces){var ze=_h(De(this.pdf,this.fontFaces),Ie.map(function(Ye){return{family:Ye,stretch:"normal",weight:qe,style:et}}));this.pdf.setFont(ze.ref.name,ze.ref.style)}else{var Xe="";(qe==="bold"||parseInt(qe,10)>=700||et==="bold")&&(Xe="bold"),et==="italic"&&(Xe+="italic"),Xe.length===0&&(Xe="normal");for(var nt="",at={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ct=0;ct<Ie.length;ct++){if(this.pdf.internal.getFont(Ie[ct],Xe,{noFallback:!0,disableWarning:!0})!==void 0){nt=Ie[ct];break}if(Xe==="bolditalic"&&this.pdf.internal.getFont(Ie[ct],"bold",{noFallback:!0,disableWarning:!0})!==void 0)nt=Ie[ct],Xe="bold";else if(this.pdf.internal.getFont(Ie[ct],"normal",{noFallback:!0,disableWarning:!0})!==void 0){nt=Ie[ct],Xe="normal";break}}if(nt===""){for(var bt=0;bt<Ie.length;bt++)if(at[Ie[bt]]){nt=at[Ie[bt]];break}}nt=nt===""?"Times":nt,this.pdf.setFont(nt,Xe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(be){this.ctx.globalCompositeOperation=be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(be){this.ctx.globalAlpha=be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(be){this.ctx.lineDashOffset=be,ve.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(be){this.ctx.lineDash=be,ve.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(be){this.ctx.ignoreClearRect=!!be}})};w.prototype.setLineDash=function(k){this.lineDash=k},w.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},w.prototype.fill=function(){G.call(this,"fill",!1)},w.prototype.stroke=function(){G.call(this,"stroke",!1)},w.prototype.beginPath=function(){this.path=[{type:"begin"}]},w.prototype.moveTo=function(k,z){if(isNaN(k)||isNaN(z))throw Nt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new l(k,z));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new l(k,z)},w.prototype.closePath=function(){var k=new l(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&xt(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){k=new l(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(k.x,k.y)},w.prototype.lineTo=function(k,z){if(isNaN(k)||isNaN(z))throw Nt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new l(k,z));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new l(V.x,V.y)},w.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),G.call(this,null,!0)},w.prototype.quadraticCurveTo=function(k,z,V,ee){if(isNaN(V)||isNaN(ee)||isNaN(k)||isNaN(z))throw Nt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new l(V,ee)),ne=this.ctx.transform.applyToPoint(new l(k,z));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:W.x,y:W.y}),this.ctx.lastPoint=new l(W.x,W.y)},w.prototype.bezierCurveTo=function(k,z,V,ee,W,ne){if(isNaN(W)||isNaN(ne)||isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee))throw Nt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new l(W,ne)),ue=this.ctx.transform.applyToPoint(new l(k,z)),Le=this.ctx.transform.applyToPoint(new l(V,ee));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:Le.x,y2:Le.y,x:de.x,y:de.y}),this.ctx.lastPoint=new l(de.x,de.y)},w.prototype.arc=function(k,z,V,ee,W,ne){if(isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee)||isNaN(W))throw Nt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new l(k,z));k=de.x,z=de.y;var ue=this.ctx.transform.applyToPoint(new l(0,V)),Le=this.ctx.transform.applyToPoint(new l(0,0));V=Math.sqrt(Math.pow(ue.x-Le.x,2)+Math.pow(ue.y-Le.y,2))}Math.abs(W-ee)>=2*Math.PI&&(ee=0,W=2*Math.PI),this.path.push({type:"arc",x:k,y:z,radius:V,startAngle:ee,endAngle:W,counterclockwise:ne})},w.prototype.arcTo=function(k,z,V,ee,W){throw new Error("arcTo not implemented.")},w.prototype.rect=function(k,z,V,ee){if(isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee))throw Nt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,z),this.lineTo(k+V,z),this.lineTo(k+V,z+ee),this.lineTo(k,z+ee),this.lineTo(k,z),this.lineTo(k+V,z),this.lineTo(k,z)},w.prototype.fillRect=function(k,z,V,ee){if(isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee))throw Nt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,z,V,ee),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},w.prototype.strokeRect=function(k,z,V,ee){if(isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee))throw Nt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");_.call(this)||(this.beginPath(),this.rect(k,z,V,ee),this.stroke())},w.prototype.clearRect=function(k,z,V,ee){if(isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee))throw Nt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,z,V,ee))},w.prototype.save=function(k){k=typeof k!="boolean"||k;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var ee=new b(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ee}},w.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(z),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},w.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(k){var z,V,ee,W;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))z=0,V=0,ee=0,W=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(ne!==null)z=parseInt(ne[1]),V=parseInt(ne[2]),ee=parseInt(ne[3]),W=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)z=parseInt(ne[1]),V=parseInt(ne[2]),ee=parseInt(ne[3]),W=parseFloat(ne[4]);else{if(W=1,typeof k=="string"&&k.charAt(0)!=="#"){var de=new rd(k);k=de.ok?de.toHex():"#000000"}k.length===4?(z=k.substring(1,2),z+=z,V=k.substring(2,3),V+=V,ee=k.substring(3,4),ee+=ee):(z=k.substring(1,3),V=k.substring(3,5),ee=k.substring(5,7)),z=parseInt(z,16),V=parseInt(V,16),ee=parseInt(ee,16)}}return{r:z,g:V,b:ee,a:W,style:k}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},_=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};w.prototype.fillText=function(k,z,V,ee){if(isNaN(z)||isNaN(V)||typeof k!="string")throw Nt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ee=isNaN(ee)?void 0:ee,!p.call(this)){var W=R(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;h.call(this,{text:k,x:z,y:V,scale:ne,angle:W,align:this.textAlign,maxWidth:ee})}},w.prototype.strokeText=function(k,z,V,ee){if(isNaN(z)||isNaN(V)||typeof k!="string")throw Nt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!_.call(this)){ee=isNaN(ee)?void 0:ee;var W=R(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;h.call(this,{text:k,x:z,y:V,scale:ne,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:ee})}},w.prototype.measureText=function(k){if(typeof k!="string")throw Nt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,V=this.pdf.internal.scaleFactor,ee=z.internal.getFontSize(),W=z.getStringUnitWidth(k)*ee/z.internal.scaleFactor,ne=function(de){var ue=(de=de||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ue}}),this};return new ne({width:W*=Math.round(96*V/72*1e4)/1e4})},w.prototype.scale=function(k,z){if(isNaN(k)||isNaN(z))throw Nt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(k,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},w.prototype.rotate=function(k){if(isNaN(k))throw Nt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new c(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},w.prototype.translate=function(k,z){if(isNaN(k)||isNaN(z))throw Nt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,k,z);this.ctx.transform=this.ctx.transform.multiply(V)},w.prototype.transform=function(k,z,V,ee,W,ne){if(isNaN(k)||isNaN(z)||isNaN(V)||isNaN(ee)||isNaN(W)||isNaN(ne))throw Nt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new c(k,z,V,ee,W,ne);this.ctx.transform=this.ctx.transform.multiply(de)},w.prototype.setTransform=function(k,z,V,ee,W,ne){k=isNaN(k)?1:k,z=isNaN(z)?0:z,V=isNaN(V)?0:V,ee=isNaN(ee)?1:ee,W=isNaN(W)?0:W,ne=isNaN(ne)?0:ne,this.ctx.transform=new c(k,z,V,ee,W,ne)};var j=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};w.prototype.drawImage=function(k,z,V,ee,W,ne,de,ue,Le){var Se=this.pdf.getImageProperties(k),ke=1,De=1,We=1,be=1;ee!==void 0&&ue!==void 0&&(We=ue/ee,be=Le/W,ke=Se.width/ee*ue/ee,De=Se.height/W*Le/W),ne===void 0&&(ne=z,de=V,z=0,V=0),ee!==void 0&&ue===void 0&&(ue=ee,Le=W),ee===void 0&&ue===void 0&&(ue=Se.width,Le=Se.height);for(var Z,et=this.ctx.transform.decompose(),qe=R(et.rotate.shx),Ae=new c,Ce=(Ae=(Ae=(Ae=Ae.multiply(et.translate)).multiply(et.skew)).multiply(et.scale)).applyToRectangle(new u(ne-z*We,de-V*be,ee*ke,W*De)),Oe=B.call(this,Ce),Ie=[],ze=0;ze<Oe.length;ze+=1)Ie.indexOf(Oe[ze])===-1&&Ie.push(Oe[ze]);if(q(Ie),this.autoPaging)for(var Xe=Ie[0],nt=Ie[Ie.length-1],at=Xe;at<nt+1;at++){this.pdf.setPage(at);var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],bt=at===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Be=at===1?0:Ye+(at-2)*it;if(this.ctx.clip_path.length!==0){var rr=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(Z,this.posX+this.margin[3],-Be+bt+this.ctx.prevPageLastElemOffset),K.call(this,"fill",!0),this.path=rr}var ut=JSON.parse(JSON.stringify(Ce));ut=L([ut],this.posX+this.margin[3],-Be+bt+this.ctx.prevPageLastElemOffset)[0];var Tr=(at>Xe||at<nt)&&j.call(this);Tr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,it,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",ut.x,ut.y,ut.w,ut.h,null,null,qe),Tr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Ce.x,Ce.y,Ce.w,Ce.h,null,null,qe)};var B=function(k,z,V){var ee=[];z=z||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":ee.push(Math.floor((k.y+W)/V)+1);break;case"arc":ee.push(Math.floor((k.y+W-k.radius)/V)+1),ee.push(Math.floor((k.y+W+k.radius)/V)+1);break;case"qct":var ne=J(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);ee.push(Math.floor((ne.y+W)/V)+1),ee.push(Math.floor((ne.y+ne.h+W)/V)+1);break;case"bct":var de=re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);ee.push(Math.floor((de.y+W)/V)+1),ee.push(Math.floor((de.y+de.h+W)/V)+1);break;case"rect":ee.push(Math.floor((k.y+W)/V)+1),ee.push(Math.floor((k.y+k.h+W)/V)+1)}for(var ue=0;ue<ee.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<ee[ue];)v.call(this);return ee},v=function(){var k=this.fillStyle,z=this.strokeStyle,V=this.font,ee=this.lineCap,W=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=z,this.font=V,this.lineCap=ee,this.lineWidth=W,this.lineJoin=ne},L=function(k,z,V){for(var ee=0;ee<k.length;ee++)switch(k[ee].type){case"bct":k[ee].x2+=z,k[ee].y2+=V;case"qct":k[ee].x1+=z,k[ee].y1+=V;case"mt":case"lt":case"arc":default:k[ee].x+=z,k[ee].y+=V}return k},q=function(k){return k.sort(function(z,V){return z-V})},G=function(k,z){for(var V,ee,W=this.fillStyle,ne=this.strokeStyle,de=this.lineCap,ue=this.lineWidth,Le=Math.abs(ue*this.ctx.transform.scaleX),Se=this.lineJoin,ke=JSON.parse(JSON.stringify(this.path)),De=JSON.parse(JSON.stringify(this.path)),We=[],be=0;be<De.length;be++)if(De[be].x!==void 0)for(var Z=B.call(this,De[be]),et=0;et<Z.length;et+=1)We.indexOf(Z[et])===-1&&We.push(Z[et]);for(var qe=0;qe<We.length;qe++)for(;this.pdf.internal.getNumberOfPages()<We[qe];)v.call(this);if(q(We),this.autoPaging)for(var Ae=We[0],Ce=We[We.length-1],Oe=Ae;Oe<Ce+1;Oe++){this.pdf.setPage(Oe),this.fillStyle=W,this.strokeStyle=ne,this.lineCap=de,this.lineWidth=Le,this.lineJoin=Se;var Ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ze=Oe===1?this.posY+this.margin[0]:this.margin[0],Xe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=Oe===1?0:Xe+(Oe-2)*nt;if(this.ctx.clip_path.length!==0){var ct=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(V,this.posX+this.margin[3],-at+ze+this.ctx.prevPageLastElemOffset),K.call(this,k,!0),this.path=ct}if(ee=JSON.parse(JSON.stringify(ke)),this.path=L(ee,this.posX+this.margin[3],-at+ze+this.ctx.prevPageLastElemOffset),z===!1||Oe===0){var bt=(Oe>Ae||Oe<Ce)&&j.call(this);bt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ie,nt,null).clip().discardPath()),K.call(this,k,z),bt&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=Le,K.call(this,k,z),this.lineWidth=ue;this.path=ke},K=function(k,z){if((k!=="stroke"||z||!_.call(this))&&(k==="stroke"||z||!p.call(this))){for(var V,ee,W=[],ne=this.path,de=0;de<ne.length;de++){var ue=ne[de];switch(ue.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:ue,deltas:[],abs:[]});break;case"lt":var Le=W.length;if(ne[de-1]&&!isNaN(ne[de-1].x)&&(V=[ue.x-ne[de-1].x,ue.y-ne[de-1].y],Le>0)){for(;Le>=0;Le--)if(W[Le-1].close!==!0&&W[Le-1].begin!==!0){W[Le-1].deltas.push(V),W[Le-1].abs.push(ue);break}}break;case"bct":V=[ue.x1-ne[de-1].x,ue.y1-ne[de-1].y,ue.x2-ne[de-1].x,ue.y2-ne[de-1].y,ue.x-ne[de-1].x,ue.y-ne[de-1].y],W[W.length-1].deltas.push(V);break;case"qct":var Se=ne[de-1].x+2/3*(ue.x1-ne[de-1].x),ke=ne[de-1].y+2/3*(ue.y1-ne[de-1].y),De=ue.x+2/3*(ue.x1-ue.x),We=ue.y+2/3*(ue.y1-ue.y),be=ue.x,Z=ue.y;V=[Se-ne[de-1].x,ke-ne[de-1].y,De-ne[de-1].x,We-ne[de-1].y,be-ne[de-1].x,Z-ne[de-1].y],W[W.length-1].deltas.push(V);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(ue)}}ee=z?null:k==="stroke"?"stroke":"fill";for(var et=!1,qe=0;qe<W.length;qe++)if(W[qe].arc)for(var Ae=W[qe].abs,Ce=0;Ce<Ae.length;Ce++){var Oe=Ae[Ce];Oe.type==="arc"?X.call(this,Oe.x,Oe.y,Oe.radius,Oe.startAngle,Oe.endAngle,Oe.counterclockwise,void 0,z,!et):g.call(this,Oe.x,Oe.y),et=!0}else if(W[qe].close===!0)this.pdf.internal.out("h"),et=!1;else if(W[qe].begin!==!0){var Ie=W[qe].start.x,ze=W[qe].start.y;S.call(this,W[qe].deltas,Ie,ze),et=!0}ee&&se.call(this,ee),z&&Y.call(this)}},$=function(k){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-V;case"top":return k+z-V;case"hanging":return k+z-2*V;case"middle":return k+z/2-V;case"ideographic":return k;case"alphabetic":default:return k}},Q=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};w.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(z,V){this.colorStops.push([z,V])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},w.prototype.createPattern=function(){return this.createLinearGradient()},w.prototype.createRadialGradient=function(){return this.createLinearGradient()};var X=function(k,z,V,ee,W,ne,de,ue,Le){for(var Se=F.call(this,V,ee,W,ne),ke=0;ke<Se.length;ke++){var De=Se[ke];ke===0&&(Le?I.call(this,De.x1+k,De.y1+z):g.call(this,De.x1+k,De.y1+z)),D.call(this,k,z,De.x2,De.y2,De.x3,De.y3,De.x4,De.y4)}ue?Y.call(this):se.call(this,de)},se=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Y=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(k,z){this.pdf.internal.out(r(k)+" "+a(z)+" m")},h=function(k){var z;switch(k.align){case"right":case"end":z="right";break;case"center":z="center";break;case"left":case"start":default:z="left"}var V=this.pdf.getTextDimensions(k.text),ee=$.call(this,k.y),W=Q.call(this,ee)-V.h,ne=this.ctx.transform.applyToPoint(new l(k.x,ee)),de=this.ctx.transform.decompose(),ue=new c;ue=(ue=(ue=ue.multiply(de.translate)).multiply(de.skew)).multiply(de.scale);for(var Le,Se,ke,De=this.ctx.transform.applyToRectangle(new u(k.x,ee,V.w,V.h)),We=ue.applyToRectangle(new u(k.x,W,V.w,V.h)),be=B.call(this,We),Z=[],et=0;et<be.length;et+=1)Z.indexOf(be[et])===-1&&Z.push(be[et]);if(q(Z),this.autoPaging)for(var qe=Z[0],Ae=Z[Z.length-1],Ce=qe;Ce<Ae+1;Ce++){this.pdf.setPage(Ce);var Oe=Ce===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ze=this.pdf.internal.pageSize.height-this.margin[2],Xe=ze-this.margin[0],nt=this.pdf.internal.pageSize.width-this.margin[1],at=nt-this.margin[3],ct=Ce===1?0:Ie+(Ce-2)*Xe;if(this.ctx.clip_path.length!==0){var bt=this.path;Le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(Le,this.posX+this.margin[3],-1*ct+Oe),K.call(this,"fill",!0),this.path=bt}var Ye=L([JSON.parse(JSON.stringify(We))],this.posX+this.margin[3],-ct+Oe+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*k.scale),ke=this.lineWidth,this.lineWidth=ke*k.scale);var it=this.autoPaging!=="text";if(it||Ye.y+Ye.h<=ze){if(it||Ye.y>=Oe&&Ye.x<=nt){var Be=it?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||nt-Ye.x)[0],rr=L([JSON.parse(JSON.stringify(De))],this.posX+this.margin[3],-ct+Oe+this.ctx.prevPageLastElemOffset)[0],ut=it&&(Ce>qe||Ce<Ae)&&j.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,Xe,null).clip().discardPath()),this.pdf.text(Be,rr.x,rr.y,{angle:k.angle,align:z,renderingMode:k.renderingMode}),ut&&this.pdf.restoreGraphicsState()}}else Ye.y<ze&&(this.ctx.prevPageLastElemOffset+=ze-Ye.y);k.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=ke)}else k.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*k.scale),ke=this.lineWidth,this.lineWidth=ke*k.scale),this.pdf.text(k.text,ne.x+this.posX,ne.y+this.posY,{angle:k.angle,align:z,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=ke)},g=function(k,z,V,ee){V=V||0,ee=ee||0,this.pdf.internal.out(r(k+V)+" "+a(z+ee)+" l")},S=function(k,z,V){return this.pdf.lines(k,z,V,null,null)},D=function(k,z,V,ee,W,ne,de,ue){this.pdf.internal.out([e(s(V+k)),e(i(ee+z)),e(s(W+k)),e(i(ne+z)),e(s(de+k)),e(i(ue+z)),"c"].join(" "))},F=function(k,z,V,ee){for(var W=2*Math.PI,ne=Math.PI/2;z>V;)z-=W;var de=Math.abs(V-z);de<W&&ee&&(de=W-de);for(var ue=[],Le=ee?-1:1,Se=z;de>1e-5;){var ke=Se+Le*Math.min(de,ne);ue.push(A.call(this,k,Se,ke)),de-=Math.abs(ke-Se),Se=ke}return ue},A=function(k,z,V){var ee=(V-z)/2,W=k*Math.cos(ee),ne=k*Math.sin(ee),de=W,ue=-ne,Le=de*de+ue*ue,Se=Le+de*W+ue*ne,ke=4/3*(Math.sqrt(2*Le*Se)-Se)/(de*ne-ue*W),De=de-ke*ue,We=ue+ke*de,be=De,Z=-We,et=ee+z,qe=Math.cos(et),Ae=Math.sin(et);return{x1:k*Math.cos(z),y1:k*Math.sin(z),x2:De*qe-We*Ae,y2:De*Ae+We*qe,x3:be*qe-Z*Ae,y3:be*Ae+Z*qe,x4:k*Math.cos(V),y4:k*Math.sin(V)}},R=function(k){return 180*k/Math.PI},J=function(k,z,V,ee,W,ne){var de=k+.5*(V-k),ue=z+.5*(ee-z),Le=W+.5*(V-W),Se=ne+.5*(ee-ne),ke=Math.min(k,W,de,Le),De=Math.max(k,W,de,Le),We=Math.min(z,ne,ue,Se),be=Math.max(z,ne,ue,Se);return new u(ke,We,De-ke,be-We)},re=function(k,z,V,ee,W,ne,de,ue){var Le,Se,ke,De,We,be,Z,et,qe,Ae,Ce,Oe,Ie,ze,Xe=V-k,nt=ee-z,at=W-V,ct=ne-ee,bt=de-W,Ye=ue-ne;for(Se=0;Se<41;Se++)qe=(Z=(ke=k+(Le=Se/40)*Xe)+Le*((We=V+Le*at)-ke))+Le*(We+Le*(W+Le*bt-We)-Z),Ae=(et=(De=z+Le*nt)+Le*((be=ee+Le*ct)-De))+Le*(be+Le*(ne+Le*Ye-be)-et),Se==0?(Ce=qe,Oe=Ae,Ie=qe,ze=Ae):(Ce=Math.min(Ce,qe),Oe=Math.min(Oe,Ae),Ie=Math.max(Ie,qe),ze=Math.max(ze,Ae));return new u(Math.round(Ce),Math.round(Oe),Math.round(Ie-Ce),Math.round(ze-Oe))},ve=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,z,V=(k=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:z}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})($e.API),function(n){var e=function(i){var l,u,c,m,b,w,y,p,_,j;for(u=[],c=0,m=(i+=l="\0\0\0\0".slice(i.length%4||4)).length;m>c;c+=4)(b=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(w=(b=((b=((b=((b=(b-(j=b%85))/85)-(_=b%85))/85)-(p=b%85))/85)-(y=b%85))/85)%85,u.push(w+33,y+33,p+33,_+33,j+33)):u.push(122);return function(B,v){for(var L=v;L>0;L--)B.pop()}(u,l.length),String.fromCharCode.apply(String,u)+"~>"},r=function(i){var l,u,c,m,b,w=String,y="length",p=255,_="charCodeAt",j="slice",B="replace";for(i[j](-2),i=i[j](0,-2)[B](/\s/g,"")[B]("z","!!!!!"),c=[],m=0,b=(i+=l="uuuuu"[j](i[y]%5||5))[y];b>m;m+=5)u=52200625*(i[_](m)-33)+614125*(i[_](m+1)-33)+7225*(i[_](m+2)-33)+85*(i[_](m+3)-33)+(i[_](m+4)-33),c.push(p&u>>24,p&u>>16,p&u>>8,p&u);return function(v,L){for(var q=L;q>0;q--)v.pop()}(c,l[y]),w.fromCharCode.apply(w,c)},a=function(i){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),l.test(i)===!1)return"";for(var u="",c=0;c<i.length;c+=2)u+=String.fromCharCode("0x"+(i[c]+i[c+1]));return u},s=function(i){for(var l=new Uint8Array(i.length),u=i.length;u--;)l[u]=i.charCodeAt(u);return i=(l=cl(l)).reduce(function(c,m){return c+String.fromCharCode(m)},"")};n.processDataByFilters=function(i,l){var u=0,c=i||"",m=[];for(typeof(l=l||[])=="string"&&(l=[l]),u=0;u<l.length;u+=1)switch(l[u]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(b){return("0"+b.charCodeAt().toString(16)).slice(-2)}).join("")+">",m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[u]+'" is not implemented')}return{data:c,reverseChain:m.reverse().join(" ")}}}($e.API),function(n){n.loadFile=function(e,r,a){return function(s,i,l){i=i!==!1,l=typeof l=="function"?l:function(){};var u=void 0;try{u=function(c,m,b){var w=new XMLHttpRequest,y=0,p=function(_){var j=_.length,B=[],v=String.fromCharCode;for(y=0;y<j;y+=1)B.push(v(255&_.charCodeAt(y)));return B.join("")};if(w.open("GET",c,!m),w.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(w.onload=function(){w.status===200?b(p(this.responseText)):b(void 0)}),w.send(null),m&&w.status===200)return p(w.responseText)}(s,i,l)}catch{}return u}(e,r,a)},n.loadImageFile=n.loadFile}($e.API),function(n){function e(){return(Ge.html2canvas?Promise.resolve(Ge.html2canvas):ri(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Ge.DOMPurify?Promise.resolve(Ge.DOMPurify):ri(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var a=function(l){var u=xt(l);return u==="undefined"?"undefined":u==="string"||l instanceof String?"string":u==="number"||l instanceof Number?"number":u==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":u==="object"?"object":"unknown"},s=function(l,u){var c=document.createElement(l);for(var m in u.className&&(c.className=u.className),u.innerHTML&&u.dompurify&&(c.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)c.style[m]=u.style[m];return c},i=function l(u){var c=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),m=l.convert(Promise.resolve(),c);return m=(m=m.setProgress(1,l,1,[l])).set(u)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(l,u){return l.__proto__=u||i.prototype,l},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(l,u){return this.then(function(){switch(u=u||function(c){switch(a(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(r).then(function(c){return this.set({src:s("div",{innerHTML:l,dompurify:c})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},i.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=function c(m,b){for(var w=m.nodeType===3?document.createTextNode(m.nodeValue):m.cloneNode(!1),y=m.firstChild;y;y=y.nextSibling)b!==!0&&y.nodeType===1&&y.nodeName==="SCRIPT"||w.appendChild(c(y,b));return m.nodeType===1&&(m.nodeName==="CANVAS"?(w.width=m.width,w.height=m.height,w.getContext("2d").drawImage(m,0,0)):m.nodeName!=="TEXTAREA"&&m.nodeName!=="SELECT"||(w.value=m.value),w.addEventListener("load",function(){w.scrollTop=m.scrollTop,w.scrollLeft=m.scrollLeft},!0)),w}(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(u){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,u(this.prop.container,c)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(u){var c=this.opt.jsPDF,m=this.opt.fontFaces,b=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,w=Object.assign({async:!0,allowTaint:!0,scale:b,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete w.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=m,m)for(var y=0;y<m.length;++y){var p=m[y],_=p.src.find(function(j){return j.format==="truetype"});_&&c.addFont(_.url,p.ref.name,p.ref.style)}return w.windowHeight=w.windowHeight||0,w.windowHeight=w.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):w.windowHeight,c.context2d.save(!0),u(this.prop.container,w)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(l,u,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(l,u):this.outputPdf(l,u)},i.prototype.outputPdf=function(l,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,u)})},i.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},i.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(l){if(a(l)!=="object")return this;var u=Object.keys(l||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=l[c]};switch(c){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[c]=l[c]}}},this);return this.then(function(){return this.thenList(u)})},i.prototype.get=function(l,u){return this.then(function(){var c=l in i.template.prop?this.prop[l]:this.opt[l];return u?u(c):c})},i.prototype.setMargin=function(l){return this.then(function(){switch(a(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},i.prototype.setPageSize=function(l){function u(c,m){return Math.floor(c*m/72*96)}return this.then(function(){(l=l||$e.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:u(l.inner.width,l.k),height:u(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},i.prototype.setProgress=function(l,u,c,m){return l!=null&&(this.progress.val=l),u!=null&&(this.progress.state=u),c!=null&&(this.progress.n=c),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(l,u,c,m){return this.setProgress(l?this.progress.val+l:null,u||null,c?this.progress.n+c:null,m?this.progress.stack.concat(m):null)},i.prototype.then=function(l,u){var c=this;return this.thenCore(l,u,function(m,b){return c.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(w){return c.updateProgress(null,m),w}).then(m,b).then(function(w){return c.updateProgress(1),w})})},i.prototype.thenCore=function(l,u,c){c=c||Promise.prototype.then,l&&(l=l.bind(this)),u&&(u=u.bind(this));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),b=c.call(m,l,u);return i.convert(b,this.__proto__)},i.prototype.thenExternal=function(l,u){return Promise.prototype.then.call(this,l,u)},i.prototype.thenList=function(l){var u=this;return l.forEach(function(c){u=u.thenCore(c)}),u},i.prototype.catch=function(l){l&&(l=l.bind(this));var u=Promise.prototype.catch.call(this,l);return i.convert(u,this)},i.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},i.prototype.error=function(l){return this.then(function(){throw new Error(l)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,$e.getPageSize=function(l,u,c){if(xt(l)==="object"){var m=l;l=m.orientation,u=m.unit||u,c=m.format||c}u=u||"mm",c=c||"a4",l=(""+(l||"P")).toLowerCase();var b,w=(""+c).toLowerCase(),y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":b=1;break;case"mm":b=72/25.4;break;case"cm":b=72/2.54;break;case"in":b=72;break;case"px":b=.75;break;case"pc":case"em":b=12;break;case"ex":b=6;break;default:throw"Invalid unit: "+u}var p,_=0,j=0;if(y.hasOwnProperty(w))_=y[w][1]/b,j=y[w][0]/b;else try{_=c[1],j=c[0]}catch{throw new Error("Invalid format: "+c)}if(l==="p"||l==="portrait")l="p",j>_&&(p=j,j=_,_=p);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",_>j&&(p=j,j=_,_=p)}return{width:j,height:_,unit:u,k:b,orientation:l}},n.html=function(l,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(ml):null;var c=new i(u);return u.worker?c:c.from(l).doCallback()}}($e.API),$e.API.addJS=function(n){return vc=n,this.internal.events.subscribe("postPutResources",function(){Os=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Os+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),bc=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+vc+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Os!==void 0&&bc!==void 0&&this.internal.out("/Names <</JavaScript "+Os+" 0 R>>")}),this},function(n){var e;n.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var l=s[i],u=a.exec(l);if(u!=null){var c=u[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,b=[];for(i=0;i<m;i++){var w=r.internal.newObject();b.push(w);var y=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var p=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<b.length;i++)r.internal.write("(page_"+(i+1)+")"+b[i]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+p+" 0 R"),r.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,s,i){var l={title:s,options:i,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var s=0;s<a.children.length;s++)this.genIds_r(a.children[s])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var l=a.children[i];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var u=this.count=this.count_r({count:0},l);if(u>0&&this.line("/Count "+u),l.options&&l.options.pageNumber){var c=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var m=0;m<a.children.length;m++)this.renderItems(a.children[m])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,s){for(var i=0;i<s.children.length;i++)a.count++,this.count_r(a,s.children[i]);return a.count}}])}($e.API),function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(r,a,s,i,l,u){var c,m=this.decode.DCT_DECODE,b=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(w){for(var y,p=256*w.charCodeAt(4)+w.charCodeAt(5),_=w.length,j={width:0,height:0,numcomponents:1},B=4;B<_;B+=2){if(B+=p,e.indexOf(w.charCodeAt(B+1))!==-1){y=256*w.charCodeAt(B+5)+w.charCodeAt(B+6),j={width:256*w.charCodeAt(B+7)+w.charCodeAt(B+8),height:y,numcomponents:w.charCodeAt(B+9)};break}p=256*w.charCodeAt(B+2)+w.charCodeAt(B+3)}return j}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}b={data:r,width:c.width,height:c.height,colorSpace:u,bitsPerComponent:8,filter:m,index:a,alias:s}}return b}}($e.API);var Wa,Bs,yc,wc,Nc,Ah=function(){var n,e,r;function a(i){var l,u,c,m,b,w,y,p,_,j,B,v,L,q;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},w=null;;){switch(l=this.readUInt32(),_=(function(){var G,K;for(K=[],G=0;G<4;++G)K.push(String.fromCharCode(this.data[this.pos++]));return K}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":w&&this.animation.frames.push(w),this.pos+=4,w={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},b=this.readUInt16(),m=this.readUInt16()||100,w.delay=1e3*b/m,w.disposeOp=this.data[this.pos++],w.blendOp=this.data[this.pos++],w.data=[];break;case"IDAT":case"fdAT":for(_==="fdAT"&&(this.pos+=4,l-=4),i=(w!=null?w.data:void 0)||this.imgData,v=0;0<=l?v<l:v>l;0<=l?++v:--v)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((j=c-this.transparency.indexed.length)>0)for(L=0;0<=j?L<j:L>j;0<=j?++L:--L)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":y=(B=this.read(l)).indexOf(0),p=String.fromCharCode.apply(String,B.slice(0,y)),this.text[p]=String.fromCharCode.apply(String,B.slice(y+1));break;case"IEND":return w&&this.animation.frames.push(w),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(q=this.colorType)===4||q===6,u=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*u,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var l,u;for(u=[],l=0;0<=i?l<i:l>i;0<=i?++l:--l)u.push(this.data[this.pos++]);return u},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var l=this.pixelBitlength/8,u=new Uint8Array(this.width*this.height*l),c=0,m=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function b(w,y,p,_){var j,B,v,L,q,G,K,$,Q,X,se,Y,I,h,g,S,D,F,A,R,J,re=Math.ceil((m.width-w)/p),ve=Math.ceil((m.height-y)/_),k=m.width==re&&m.height==ve;for(h=l*re,Y=k?u:new Uint8Array(h*ve),G=i.length,I=0,B=0;I<ve&&c<G;){switch(i[c++]){case 0:for(L=D=0;D<h;L=D+=1)Y[B++]=i[c++];break;case 1:for(L=F=0;F<h;L=F+=1)j=i[c++],q=L<l?0:Y[B-l],Y[B++]=(j+q)%256;break;case 2:for(L=A=0;A<h;L=A+=1)j=i[c++],v=(L-L%l)/l,g=I&&Y[(I-1)*h+v*l+L%l],Y[B++]=(g+j)%256;break;case 3:for(L=R=0;R<h;L=R+=1)j=i[c++],v=(L-L%l)/l,q=L<l?0:Y[B-l],g=I&&Y[(I-1)*h+v*l+L%l],Y[B++]=(j+Math.floor((q+g)/2))%256;break;case 4:for(L=J=0;J<h;L=J+=1)j=i[c++],v=(L-L%l)/l,q=L<l?0:Y[B-l],I===0?g=S=0:(g=Y[(I-1)*h+v*l+L%l],S=v&&Y[(I-1)*h+(v-1)*l+L%l]),K=q+g-S,$=Math.abs(K-q),X=Math.abs(K-g),se=Math.abs(K-S),Q=$<=X&&$<=se?q:X<=se?g:S,Y[B++]=(j+Q)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!k){var z=((y+I*_)*m.width+w)*l,V=I*h;for(L=0;L<re;L+=1){for(var ee=0;ee<l;ee+=1)u[z++]=Y[V++];z+=(p-1)*l}}I++}}return i=ih(i),m.interlaceMethod==1?(b(0,0,8,8),b(4,0,8,8),b(0,4,4,8),b(2,0,4,4),b(0,2,2,4),b(1,0,2,2),b(0,1,1,2)):b(0,0,1,1),u},a.prototype.decodePalette=function(){var i,l,u,c,m,b,w,y,p;for(u=this.palette,b=this.transparency.indexed||[],m=new Uint8Array((b.length||0)+u.length),c=0,i=0,l=w=0,y=u.length;w<y;l=w+=3)m[c++]=u[l],m[c++]=u[l+1],m[c++]=u[l+2],m[c++]=(p=b[i++])!=null?p:255;return m},a.prototype.copyToImageData=function(i,l){var u,c,m,b,w,y,p,_,j,B,v;if(c=this.colors,j=null,u=this.hasAlphaChannel,this.palette.length&&(j=(v=this._decodedPalette)!=null?v:this._decodedPalette=this.decodePalette(),c=4,u=!0),_=(m=i.data||i).length,w=j||l,b=y=0,c===1)for(;b<_;)p=j?4*l[b/4]:y,B=w[p++],m[b++]=B,m[b++]=B,m[b++]=B,m[b++]=u?w[p++]:255,y=p;else for(;b<_;)p=j?4*l[b/4]:y,m[b++]=w[p++],m[b++]=w[p++],m[b++]=w[p++],m[b++]=u?w[p++]:255,y=p},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var s=function(){if(Object.prototype.toString.call(Ge)==="[object Window]"){try{e=Ge.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return s(),n=function(i){var l;if(s()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(l=new Image).src=e.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var l,u,c,m,b,w,y,p;if(this.animation){for(p=[],u=b=0,w=(y=this.animation.frames).length;b<w;u=++b)l=y[u],c=i.createImageData(l.width,l.height),m=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(c,m),l.imageData=c,p.push(l.image=n(c));return p}},a.prototype.renderFrame=function(i,l){var u,c,m;return u=(c=this.animation.frames)[l],m=c[l-1],l===0&&i.clearRect(0,0,this.width,this.height),(m!=null?m.disposeOp:void 0)===1?i.clearRect(m.xOffset,m.yOffset,m.width,m.height):(m!=null?m.disposeOp:void 0)===2&&i.putImageData(m.imageData,m.xOffset,m.yOffset),u.blendOp===0&&i.clearRect(u.xOffset,u.yOffset,u.width,u.height),i.drawImage(u.image,u.xOffset,u.yOffset)},a.prototype.animate=function(i){var l,u,c,m,b,w,y=this;return u=0,w=this.animation,m=w.numFrames,c=w.frames,b=w.numPlays,(l=function(){var p,_;if(p=u++%m,_=c[p],y.renderFrame(i,p),m>1&&u/m<b)return y.animation._timeout=setTimeout(l,_.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var l,u;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,l=i.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(u=l.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),l.putImageData(u,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function kh(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=n[e++]|n[e++]<<8,a=n[e++]|n[e++]<<8,s=n[e++],i=s>>7,l=1<<(7&s)+1;n[e++],n[e++];var u=null,c=null;i&&(u=e,c=l,e+=3*l);var m=!0,b=[],w=0,y=null,p=0,_=null;for(this.width=r,this.height=a;m&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,_=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((I=n[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var j=n[e++];w=n[e++]|n[e++]<<8,y=n[e++],!(1&j)&&(y=null),p=j>>2&7,e++;break;case 254:for(;;){if(!((I=n[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var B=n[e++]|n[e++]<<8,v=n[e++]|n[e++]<<8,L=n[e++]|n[e++]<<8,q=n[e++]|n[e++]<<8,G=n[e++],K=G>>6&1,$=1<<(7&G)+1,Q=u,X=c,se=!1;G>>7&&(se=!0,Q=e,X=$,e+=3*$);var Y=e;for(e++;;){var I;if(!((I=n[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}b.push({x:B,y:v,width:L,height:q,has_local_palette:se,palette_offset:Q,palette_size:X,data_offset:Y,data_length:e-Y,transparent_index:y,interlaced:!!K,delay:w,disposal:p});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return b.length},this.loopCount=function(){return _},this.frameInfo=function(h){if(h<0||h>=b.length)throw new Error("Frame index out of range.");return b[h]},this.decodeAndBlitFrameBGRA=function(h,g){var S=this.frameInfo(h),D=S.width*S.height,F=new Uint8Array(D);jc(n,S.data_offset,F,D);var A=S.palette_offset,R=S.transparent_index;R===null&&(R=256);var J=S.width,re=r-J,ve=J,k=4*(S.y*r+S.x),z=4*((S.y+S.height)*r+S.x),V=k,ee=4*re;S.interlaced===!0&&(ee+=4*r*7);for(var W=8,ne=0,de=F.length;ne<de;++ne){var ue=F[ne];if(ve===0&&(ve=J,(V+=ee)>=z&&(ee=4*re+4*r*(W-1),V=k+(J+re)*(W<<1),W>>=1)),ue===R)V+=4;else{var Le=n[A+3*ue],Se=n[A+3*ue+1],ke=n[A+3*ue+2];g[V++]=ke,g[V++]=Se,g[V++]=Le,g[V++]=255}--ve}},this.decodeAndBlitFrameRGBA=function(h,g){var S=this.frameInfo(h),D=S.width*S.height,F=new Uint8Array(D);jc(n,S.data_offset,F,D);var A=S.palette_offset,R=S.transparent_index;R===null&&(R=256);var J=S.width,re=r-J,ve=J,k=4*(S.y*r+S.x),z=4*((S.y+S.height)*r+S.x),V=k,ee=4*re;S.interlaced===!0&&(ee+=4*r*7);for(var W=8,ne=0,de=F.length;ne<de;++ne){var ue=F[ne];if(ve===0&&(ve=J,(V+=ee)>=z&&(ee=4*re+4*r*(W-1),V=k+(J+re)*(W<<1),W>>=1)),ue===R)V+=4;else{var Le=n[A+3*ue],Se=n[A+3*ue+1],ke=n[A+3*ue+2];g[V++]=Le,g[V++]=Se,g[V++]=ke,g[V++]=255}--ve}}}function jc(n,e,r,a){for(var s=n[e++],i=1<<s,l=i+1,u=l+1,c=s+1,m=(1<<c)-1,b=0,w=0,y=0,p=n[e++],_=new Int32Array(4096),j=null;;){for(;b<16&&p!==0;)w|=n[e++]<<b,b+=8,p===1?p=n[e++]:--p;if(b<c)break;var B=w&m;if(w>>=c,b-=c,B!==i){if(B===l)break;for(var v=B<u?B:j,L=0,q=v;q>i;)q=_[q]>>8,++L;var G=q;if(y+L+(v!==B?1:0)>a)return void Nt.log("Warning, gif stream longer than expected.");r[y++]=G;var K=y+=L;for(v!==B&&(r[y++]=G),q=v;L--;)q=_[q],r[--K]=255&q,q>>=8;j!==null&&u<4096&&(_[u++]=j<<8|G,u>=m+1&&c<12&&(++c,m=m<<1|1)),j=B}else u=l+1,m=(1<<(c=s+1))-1,j=null}return y!==a&&Nt.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Zo(n){var e,r,a,s,i,l=Math.floor,u=new Array(64),c=new Array(64),m=new Array(64),b=new Array(64),w=new Array(65535),y=new Array(65535),p=new Array(64),_=new Array(64),j=[],B=0,v=7,L=new Array(64),q=new Array(64),G=new Array(64),K=new Array(256),$=new Array(2048),Q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],X=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],se=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],h=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],g=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function F(k,z){for(var V=0,ee=0,W=new Array,ne=1;ne<=16;ne++){for(var de=1;de<=k[ne];de++)W[z[ee]]=[],W[z[ee]][0]=V,W[z[ee]][1]=ne,ee++,V++;V*=2}return W}function A(k){for(var z=k[0],V=k[1]-1;V>=0;)z&1<<V&&(B|=1<<v),V--,--v<0&&(B==255?(R(255),R(0)):R(B),v=7,B=0)}function R(k){j.push(k)}function J(k){R(k>>8&255),R(255&k)}function re(k,z,V,ee,W){for(var ne,de=W[0],ue=W[240],Le=function(Ae,Ce){var Oe,Ie,ze,Xe,nt,at,ct,bt,Ye,it,Be=0;for(Ye=0;Ye<8;++Ye){Oe=Ae[Be],Ie=Ae[Be+1],ze=Ae[Be+2],Xe=Ae[Be+3],nt=Ae[Be+4],at=Ae[Be+5],ct=Ae[Be+6];var rr=Oe+(bt=Ae[Be+7]),ut=Oe-bt,Tr=Ie+ct,yt=Ie-ct,Lt=ze+at,en=ze-at,ft=Xe+nt,Kn=Xe-nt,Ct=rr+ft,Mr=rr-ft,mn=Tr+Lt,Pt=Tr-Lt;Ae[Be]=Ct+mn,Ae[Be+4]=Ct-mn;var Ke=.707106781*(Pt+Mr);Ae[Be+2]=Mr+Ke,Ae[Be+6]=Mr-Ke;var pt=.382683433*((Ct=Kn+en)-(Pt=yt+ut)),Zn=.5411961*Ct+pt,Kt=1.306562965*Pt+pt,tn=.707106781*(mn=en+yt),rn=ut+tn,He=ut-tn;Ae[Be+5]=He+Zn,Ae[Be+3]=He-Zn,Ae[Be+1]=rn+Kt,Ae[Be+7]=rn-Kt,Be+=8}for(Be=0,Ye=0;Ye<8;++Ye){Oe=Ae[Be],Ie=Ae[Be+8],ze=Ae[Be+16],Xe=Ae[Be+24],nt=Ae[Be+32],at=Ae[Be+40],ct=Ae[Be+48];var Rr=Oe+(bt=Ae[Be+56]),nn=Oe-bt,fr=Ie+ct,Ht=Ie-ct,qt=ze+at,wr=ze-at,ga=Xe+nt,gn=Xe-nt,qr=Rr+ga,zr=Rr-ga,Ur=fr+qt,an=fr-qt;Ae[Be]=qr+Ur,Ae[Be+32]=qr-Ur;var kr=.707106781*(an+zr);Ae[Be+16]=zr+kr,Ae[Be+48]=zr-kr;var sn=.382683433*((qr=gn+wr)-(an=Ht+nn)),Qn=.5411961*qr+sn,xa=1.306562965*an+sn,ba=.707106781*(Ur=wr+Ht),va=nn+ba,ya=nn-ba;Ae[Be+40]=ya+Qn,Ae[Be+24]=ya-Qn,Ae[Be+8]=va+xa,Ae[Be+56]=va-xa,Be++}for(Ye=0;Ye<64;++Ye)it=Ae[Ye]*Ce[Ye],p[Ye]=it>0?it+.5|0:it-.5|0;return p}(k,z),Se=0;Se<64;++Se)_[Q[Se]]=Le[Se];var ke=_[0]-V;V=_[0],ke==0?A(ee[0]):(A(ee[y[ne=32767+ke]]),A(w[ne]));for(var De=63;De>0&&_[De]==0;)De--;if(De==0)return A(de),V;for(var We,be=1;be<=De;){for(var Z=be;_[be]==0&&be<=De;)++be;var et=be-Z;if(et>=16){We=et>>4;for(var qe=1;qe<=We;++qe)A(ue);et&=15}ne=32767+_[be],A(W[(et<<4)+y[ne]]),A(w[ne]),be++}return De!=63&&A(de),V}function ve(k){k=Math.min(Math.max(k,1),100),i!=k&&(function(z){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ee=0;ee<64;ee++){var W=l((V[ee]*z+50)/100);W=Math.min(Math.max(W,1),255),u[Q[ee]]=W}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var ue=l((ne[de]*z+50)/100);ue=Math.min(Math.max(ue,1),255),c[Q[de]]=ue}for(var Le=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,ke=0;ke<8;ke++)for(var De=0;De<8;De++)m[Se]=1/(u[Q[Se]]*Le[ke]*Le[De]*8),b[Se]=1/(c[Q[Se]]*Le[ke]*Le[De]*8),Se++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),i=k)}this.encode=function(k,z){z&&ve(z),j=new Array,B=0,v=7,J(65496),J(65504),J(16),R(74),R(70),R(73),R(70),R(0),R(1),R(1),R(0),J(1),J(1),R(0),R(0),function(){J(65499),J(132),R(0);for(var Ie=0;Ie<64;Ie++)R(u[Ie]);R(1);for(var ze=0;ze<64;ze++)R(c[ze])}(),function(Ie,ze){J(65472),J(17),R(8),J(ze),J(Ie),R(3),R(1),R(17),R(0),R(2),R(17),R(1),R(3),R(17),R(1)}(k.width,k.height),function(){J(65476),J(418),R(0);for(var Ie=0;Ie<16;Ie++)R(X[Ie+1]);for(var ze=0;ze<=11;ze++)R(se[ze]);R(16);for(var Xe=0;Xe<16;Xe++)R(Y[Xe+1]);for(var nt=0;nt<=161;nt++)R(I[nt]);R(1);for(var at=0;at<16;at++)R(h[at+1]);for(var ct=0;ct<=11;ct++)R(g[ct]);R(17);for(var bt=0;bt<16;bt++)R(S[bt+1]);for(var Ye=0;Ye<=161;Ye++)R(D[Ye])}(),J(65498),J(12),R(3),R(1),R(0),R(2),R(17),R(3),R(17),R(0),R(63),R(0);var V=0,ee=0,W=0;B=0,v=7,this.encode.displayName="_encode_";for(var ne,de,ue,Le,Se,ke,De,We,be,Z=k.data,et=k.width,qe=k.height,Ae=4*et,Ce=0;Ce<qe;){for(ne=0;ne<Ae;){for(Se=Ae*Ce+ne,De=-1,We=0,be=0;be<64;be++)ke=Se+(We=be>>3)*Ae+(De=4*(7&be)),Ce+We>=qe&&(ke-=Ae*(Ce+1+We-qe)),ne+De>=Ae&&(ke-=ne+De-Ae+4),de=Z[ke++],ue=Z[ke++],Le=Z[ke++],L[be]=($[de]+$[ue+256>>0]+$[Le+512>>0]>>16)-128,q[be]=($[de+768>>0]+$[ue+1024>>0]+$[Le+1280>>0]>>16)-128,G[be]=($[de+1280>>0]+$[ue+1536>>0]+$[Le+1792>>0]>>16)-128;V=re(L,m,V,e,a),ee=re(q,b,ee,r,s),W=re(G,b,W,r,s),ne+=32}Ce+=8}if(v>=0){var Oe=[];Oe[1]=v+1,Oe[0]=(1<<v+1)-1,A(Oe)}return J(65497),new Uint8Array(j)},n=n||50,function(){for(var k=String.fromCharCode,z=0;z<256;z++)K[z]=k(z)}(),e=F(X,se),r=F(h,g),a=F(Y,I),s=F(S,D),function(){for(var k=1,z=2,V=1;V<=15;V++){for(var ee=k;ee<z;ee++)y[32767+ee]=V,w[32767+ee]=[],w[32767+ee][1]=V,w[32767+ee][0]=ee;for(var W=-(z-1);W<=-k;W++)y[32767+W]=V,w[32767+W]=[],w[32767+W][1]=V,w[32767+W][0]=z-1+W;k<<=1,z<<=1}}(),function(){for(var k=0;k<256;k++)$[k]=19595*k,$[k+256>>0]=38470*k,$[k+512>>0]=7471*k+32768,$[k+768>>0]=-11059*k,$[k+1024>>0]=-21709*k,$[k+1280>>0]=32768*k+8421375,$[k+1536>>0]=-27439*k,$[k+1792>>0]=-5329*k}(),ve(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Jr(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function _c(n){function e(X){if(!X)throw Error("assert :P")}function r(X,se,Y){for(var I=0;4>I;I++)if(X[se+I]!=Y.charCodeAt(I))return!0;return!1}function a(X,se,Y,I,h){for(var g=0;g<h;g++)X[se+g]=Y[I+g]}function s(X,se,Y,I){for(var h=0;h<I;h++)X[se+h]=Y}function i(X){return new Int32Array(X)}function l(X,se){for(var Y=[],I=0;I<X;I++)Y.push(new se);return Y}function u(X,se){var Y=[];return function I(h,g,S){for(var D=S[g],F=0;F<D&&(h.push(S.length>g+1?[]:new se),!(S.length<g+1));F++)I(h[F],g+1,S)}(Y,0,X),Y}var c=function(){var X=this;function se(o,d){for(var x=1<<d-1>>>0;o&x;)x>>>=1;return x?(o&x-1)+x:o}function Y(o,d,x,N,C){e(!(N%x));do o[d+(N-=x)]=C;while(0<N)}function I(o,d,x,N,C){if(e(2328>=C),512>=C)var E=i(512);else if((E=i(C))==null)return 0;return function(O,T,M,U,ae,he){var fe,le,Ne=T,ge=1<<M,ie=i(16),oe=i(16);for(e(ae!=0),e(U!=null),e(O!=null),e(0<M),le=0;le<ae;++le){if(15<U[le])return 0;++ie[U[le]]}if(ie[0]==ae)return 0;for(oe[1]=0,fe=1;15>fe;++fe){if(ie[fe]>1<<fe)return 0;oe[fe+1]=oe[fe]+ie[fe]}for(le=0;le<ae;++le)fe=U[le],0<U[le]&&(he[oe[fe]++]=le);if(oe[15]==1)return(U=new h).g=0,U.value=he[0],Y(O,Ne,1,ge,U),ge;var ye,je=-1,we=ge-1,Me=0,Pe=1,Ve=1,Ee=1<<M;for(le=0,fe=1,ae=2;fe<=M;++fe,ae<<=1){if(Pe+=Ve<<=1,0>(Ve-=ie[fe]))return 0;for(;0<ie[fe];--ie[fe])(U=new h).g=fe,U.value=he[le++],Y(O,Ne+Me,ae,Ee,U),Me=se(Me,fe)}for(fe=M+1,ae=2;15>=fe;++fe,ae<<=1){if(Pe+=Ve<<=1,0>(Ve-=ie[fe]))return 0;for(;0<ie[fe];--ie[fe]){if(U=new h,(Me&we)!=je){for(Ne+=Ee,ye=1<<(je=fe)-M;15>je&&!(0>=(ye-=ie[je]));)++je,ye<<=1;ge+=Ee=1<<(ye=je-M),O[T+(je=Me&we)].g=ye+M,O[T+je].value=Ne-T-je}U.g=fe-M,U.value=he[le++],Y(O,Ne+(Me>>M),ae,Ee,U),Me=se(Me,fe)}}return Pe!=2*oe[15]-1?0:ge}(o,d,x,N,C,E)}function h(){this.value=this.g=0}function g(){this.value=this.g=0}function S(){this.G=l(5,h),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Zt,g)}function D(o,d,x,N){e(o!=null),e(d!=null),e(2147483648>N),o.Ca=254,o.I=0,o.b=-8,o.Ka=0,o.oa=d,o.pa=x,o.Jd=d,o.Yc=x+N,o.Zc=4<=N?x+N-4+1:x,ne(o)}function F(o,d){for(var x=0;0<d--;)x|=ue(o,128)<<d;return x}function A(o,d){var x=F(o,d);return de(o)?-x:x}function R(o,d,x,N){var C,E=0;for(e(o!=null),e(d!=null),e(4294967288>N),o.Sb=N,o.Ra=0,o.u=0,o.h=0,4<N&&(N=4),C=0;C<N;++C)E+=d[x+C]<<8*C;o.Ra=E,o.bb=N,o.oa=d,o.pa=x}function J(o){for(;8<=o.u&&o.bb<o.Sb;)o.Ra>>>=8,o.Ra+=o.oa[o.pa+o.bb]<<Oa-8>>>0,++o.bb,o.u-=8;V(o)&&(o.h=1,o.u=0)}function re(o,d){if(e(0<=d),!o.h&&d<=Ia){var x=z(o)&Ea[d];return o.u+=d,J(o),x}return o.h=1,o.u=0}function ve(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function z(o){return o.Ra>>>(o.u&Oa-1)>>>0}function V(o){return e(o.bb<=o.Sb),o.h||o.bb==o.Sb&&o.u>Oa}function ee(o,d){o.u=d,o.h=V(o)}function W(o){o.u>=Ni&&(e(o.u>=Ni),J(o))}function ne(o){e(o!=null&&o.oa!=null),o.pa<o.Zc?(o.I=(o.oa[o.pa++]|o.I<<8)>>>0,o.b+=8):(e(o!=null&&o.oa!=null),o.pa<o.Yc?(o.b+=8,o.I=o.oa[o.pa++]|o.I<<8):o.Ka?o.b=0:(o.I<<=8,o.b+=8,o.Ka=1))}function de(o){return F(o,1)}function ue(o,d){var x=o.Ca;0>o.b&&ne(o);var N=o.b,C=x*d>>>8,E=(o.I>>>N>C)+0;for(E?(x-=C,o.I-=C+1<<N>>>0):x=C+1,N=x,C=0;256<=N;)C+=8,N>>=8;return N=7^C+mr[N],o.b-=N,o.Ca=(x<<N)-1,E}function Le(o,d,x){o[d+0]=x>>24&255,o[d+1]=x>>16&255,o[d+2]=x>>8&255,o[d+3]=x>>0&255}function Se(o,d){return o[d+0]<<0|o[d+1]<<8}function ke(o,d){return Se(o,d)|o[d+2]<<16}function De(o,d){return Se(o,d)|Se(o,d+2)<<16}function We(o,d){var x=1<<d;return e(o!=null),e(0<d),o.X=i(x),o.X==null?0:(o.Mb=32-d,o.Xa=d,1)}function be(o,d){e(o!=null),e(d!=null),e(o.Xa==d.Xa),a(d.X,0,o.X,0,1<<d.Xa)}function Z(){this.X=[],this.Xa=this.Mb=0}function et(o,d,x,N){e(x!=null),e(N!=null);var C=x[0],E=N[0];return C==0&&(C=(o*E+d/2)/d),E==0&&(E=(d*C+o/2)/o),0>=C||0>=E?0:(x[0]=C,N[0]=E,1)}function qe(o,d){return o+(1<<d)-1>>>d}function Ae(o,d){return((4278255360&o)+(4278255360&d)>>>0&4278255360)+((16711935&o)+(16711935&d)>>>0&16711935)>>>0}function Ce(o,d){X[d]=function(x,N,C,E,O,T,M){var U;for(U=0;U<O;++U){var ae=X[o](T[M+U-1],C,E+U);T[M+U]=Ae(x[N+U],ae)}}}function Oe(){this.ud=this.hd=this.jd=0}function Ie(o,d){return((4278124286&(o^d))>>>1)+(o&d)>>>0}function ze(o){return 0<=o&&256>o?o:0>o?0:255<o?255:void 0}function Xe(o,d){return ze(o+(o-d+.5>>1))}function nt(o,d,x){return Math.abs(d-x)-Math.abs(o-x)}function at(o,d,x,N,C,E,O){for(N=E[O-1],x=0;x<C;++x)E[O+x]=N=Ae(o[d+x],N)}function ct(o,d,x,N,C){var E;for(E=0;E<x;++E){var O=o[d+E],T=O>>8&255,M=16711935&(M=(M=16711935&O)+((T<<16)+T));N[C+E]=(4278255360&O)+M>>>0}}function bt(o,d){d.jd=o>>0&255,d.hd=o>>8&255,d.ud=o>>16&255}function Ye(o,d,x,N,C,E){var O;for(O=0;O<N;++O){var T=d[x+O],M=T>>>8,U=T,ae=255&(ae=(ae=T>>>16)+((o.jd<<24>>24)*(M<<24>>24)>>>5));U=255&(U=(U=U+((o.hd<<24>>24)*(M<<24>>24)>>>5))+((o.ud<<24>>24)*(ae<<24>>24)>>>5)),C[E+O]=(4278255360&T)+(ae<<16)+U}}function it(o,d,x,N,C){X[d]=function(E,O,T,M,U,ae,he,fe,le){for(M=he;M<fe;++M)for(he=0;he<le;++he)U[ae++]=C(T[N(E[O++])])},X[o]=function(E,O,T,M,U,ae,he){var fe=8>>E.b,le=E.Ea,Ne=E.K[0],ge=E.w;if(8>fe)for(E=(1<<E.b)-1,ge=(1<<fe)-1;O<T;++O){var ie,oe=0;for(ie=0;ie<le;++ie)ie&E||(oe=N(M[U++])),ae[he++]=C(Ne[oe&ge]),oe>>=fe}else X["VP8LMapColor"+x](M,U,Ne,ge,ae,he,O,T,le)}}function Be(o,d,x,N,C){for(x=d+x;d<x;){var E=o[d++];N[C++]=E>>16&255,N[C++]=E>>8&255,N[C++]=E>>0&255}}function rr(o,d,x,N,C){for(x=d+x;d<x;){var E=o[d++];N[C++]=E>>16&255,N[C++]=E>>8&255,N[C++]=E>>0&255,N[C++]=E>>24&255}}function ut(o,d,x,N,C){for(x=d+x;d<x;){var E=(O=o[d++])>>16&240|O>>12&15,O=O>>0&240|O>>28&15;N[C++]=E,N[C++]=O}}function Tr(o,d,x,N,C){for(x=d+x;d<x;){var E=(O=o[d++])>>16&248|O>>13&7,O=O>>5&224|O>>3&31;N[C++]=E,N[C++]=O}}function yt(o,d,x,N,C){for(x=d+x;d<x;){var E=o[d++];N[C++]=E>>0&255,N[C++]=E>>8&255,N[C++]=E>>16&255}}function Lt(o,d,x,N,C,E){if(E==0)for(x=d+x;d<x;)Le(N,((E=o[d++])[0]>>24|E[1]>>8&65280|E[2]<<8&16711680|E[3]<<24)>>>0),C+=32;else a(N,C,o,d,x)}function en(o,d){X[d][0]=X[o+"0"],X[d][1]=X[o+"1"],X[d][2]=X[o+"2"],X[d][3]=X[o+"3"],X[d][4]=X[o+"4"],X[d][5]=X[o+"5"],X[d][6]=X[o+"6"],X[d][7]=X[o+"7"],X[d][8]=X[o+"8"],X[d][9]=X[o+"9"],X[d][10]=X[o+"10"],X[d][11]=X[o+"11"],X[d][12]=X[o+"12"],X[d][13]=X[o+"13"],X[d][14]=X[o+"0"],X[d][15]=X[o+"0"]}function ft(o){return o==Co||o==Po||o==vs||o==Fo}function Kn(){this.eb=[],this.size=this.A=this.fb=0}function Ct(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Mr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Kn,this.f.kb=new Ct,this.sd=null}function mn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Pt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ke(o){return alert("todo:WebPSamplerProcessPlane"),o.T}function pt(o,d){var x=o.T,N=d.ba.f.RGBA,C=N.eb,E=N.fb+o.ka*N.A,O=Ir[d.ba.S],T=o.y,M=o.O,U=o.f,ae=o.N,he=o.ea,fe=o.W,le=d.cc,Ne=d.dc,ge=d.Mc,ie=d.Nc,oe=o.ka,ye=o.ka+o.T,je=o.U,we=je+1>>1;for(oe==0?O(T,M,null,null,U,ae,he,fe,U,ae,he,fe,C,E,null,null,je):(O(d.ec,d.fc,T,M,le,Ne,ge,ie,U,ae,he,fe,C,E-N.A,C,E,je),++x);oe+2<ye;oe+=2)le=U,Ne=ae,ge=he,ie=fe,ae+=o.Rc,fe+=o.Rc,E+=2*N.A,O(T,(M+=2*o.fa)-o.fa,T,M,le,Ne,ge,ie,U,ae,he,fe,C,E-N.A,C,E,je);return M+=o.fa,o.j+ye<o.o?(a(d.ec,d.fc,T,M,je),a(d.cc,d.dc,U,ae,we),a(d.Mc,d.Nc,he,fe,we),x--):1&ye||O(T,M,null,null,U,ae,he,fe,U,ae,he,fe,C,E+N.A,null,null,je),x}function Zn(o,d,x){var N=o.F,C=[o.J];if(N!=null){var E=o.U,O=d.ba.S,T=O==bs||O==vs;d=d.ba.f.RGBA;var M=[0],U=o.ka;M[0]=o.T,o.Kb&&(U==0?--M[0]:(--U,C[0]-=o.width),o.j+o.ka+o.T==o.o&&(M[0]=o.o-o.j-U));var ae=d.eb;U=d.fb+U*d.A,o=_t(N,C[0],o.width,E,M,ae,U+(T?0:3),d.A),e(x==M),o&&ft(O)&&Dr(ae,U,T,E,M,d.A)}return 0}function Kt(o){var d=o.ma,x=d.ba.S,N=11>x,C=x==gs||x==xs||x==bs||x==ko||x==12||ft(x);if(d.memory=null,d.Ib=null,d.Jb=null,d.Nd=null,!yi(d.Oa,o,C?11:12))return 0;if(C&&ft(x)&&_e(),o.da)alert("todo:use_scaling");else{if(N){if(d.Ib=Ke,o.Kb){if(x=o.U+1>>1,d.memory=i(o.U+2*x),d.memory==null)return 0;d.ec=d.memory,d.fc=0,d.cc=d.ec,d.dc=d.fc+o.U,d.Mc=d.cc,d.Nc=d.dc+x,d.Ib=pt,_e()}}else alert("todo:EmitYUV");C&&(d.Jb=Zn,N&&ce())}if(N&&!Bl){for(o=0;256>o;++o)Qd[o]=89858*(o-128)+ws>>ys,ru[o]=-22014*(o-128)+ws,tu[o]=-45773*(o-128),eu[o]=113618*(o-128)+ws>>ys;for(o=Ci;o<Io;++o)d=76283*(o-16)+ws>>ys,nu[o-Ci]=Nr(d,255),au[o-Ci]=Nr(d+8>>4,15);Bl=1}return 1}function tn(o){var d=o.ma,x=o.U,N=o.T;return e(!(1&o.ka)),0>=x||0>=N?0:(x=d.Ib(o,d),d.Jb!=null&&d.Jb(o,d,x),d.Dc+=x,1)}function rn(o){o.ma.memory=null}function He(o,d,x,N){return re(o,8)!=47?0:(d[0]=re(o,14)+1,x[0]=re(o,14)+1,N[0]=re(o,1),re(o,3)!=0?0:!o.h)}function Rr(o,d){if(4>o)return o+1;var x=o-2>>1;return(2+(1&o)<<x)+re(d,x)+1}function nn(o,d){return 120<d?d-120:1<=(x=((x=Rd[d-1])>>4)*o+(8-(15&x)))?x:1;var x}function fr(o,d,x){var N=z(x),C=o[d+=255&N].g-8;return 0<C&&(ee(x,x.u+8),N=z(x),d+=o[d].value,d+=N&(1<<C)-1),ee(x,x.u+o[d].g),o[d].value}function Ht(o,d,x){return x.g+=o.g,x.value+=o.value<<d>>>0,e(8>=x.g),o.g}function qt(o,d,x){var N=o.xc;return e((d=N==0?0:o.vc[o.md*(x>>N)+(d>>N)])<o.Wb),o.Ya[d]}function wr(o,d,x,N){var C=o.ab,E=o.c*d,O=o.C;d=O+d;var T=x,M=N;for(N=o.Ta,x=o.Ua;0<C--;){var U=o.gc[C],ae=O,he=d,fe=T,le=M,Ne=(M=N,T=x,U.Ea);switch(e(ae<he),e(he<=U.nc),U.hc){case 2:cs(fe,le,(he-ae)*Ne,M,T);break;case 0:var ge=ae,ie=he,oe=M,ye=T,je=(Ee=U).Ea;ge==0&&(Lo(fe,le,null,null,1,oe,ye),at(fe,le+1,0,0,je-1,oe,ye+1),le+=je,ye+=je,++ge);for(var we=1<<Ee.b,Me=we-1,Pe=qe(je,Ee.b),Ve=Ee.K,Ee=Ee.w+(ge>>Ee.b)*Pe;ge<ie;){var ht=Ve,mt=Ee,dt=1;for(ji(fe,le,oe,ye-je,1,oe,ye);dt<je;){var st=(dt&~Me)+we;st>je&&(st=je),(0,En[ht[mt++]>>8&15])(fe,le+ +dt,oe,ye+dt-je,st-dt,oe,ye+dt),dt=st}le+=je,ye+=je,++ge&Me||(Ee+=Pe)}he!=U.nc&&a(M,T-Ne,M,T+(he-ae-1)*Ne,Ne);break;case 1:for(Ne=fe,ie=le,je=(fe=U.Ea)-(ye=fe&~(oe=(le=1<<U.b)-1)),ge=qe(fe,U.b),we=U.K,U=U.w+(ae>>U.b)*ge;ae<he;){for(Me=we,Pe=U,Ve=new Oe,Ee=ie+ye,ht=ie+fe;ie<Ee;)bt(Me[Pe++],Ve),aa(Ve,Ne,ie,le,M,T),ie+=le,T+=le;ie<ht&&(bt(Me[Pe++],Ve),aa(Ve,Ne,ie,je,M,T),ie+=je,T+=je),++ae&oe||(U+=ge)}break;case 3:if(fe==M&&le==T&&0<U.b){for(ie=M,fe=Ne=T+(he-ae)*Ne-(ye=(he-ae)*qe(U.Ea,U.b)),le=M,oe=T,ge=[],ye=(je=ye)-1;0<=ye;--ye)ge[ye]=le[oe+ye];for(ye=je-1;0<=ye;--ye)ie[fe+ye]=ge[ye];Cr(U,ae,he,M,Ne,M,T)}else Cr(U,ae,he,fe,le,M,T)}T=N,M=x}M!=x&&a(N,x,T,M,E)}function ga(o,d){var x=o.V,N=o.Ba+o.c*o.C,C=d-o.C;if(e(d<=o.l.o),e(16>=C),0<C){var E=o.l,O=o.Ta,T=o.Ua,M=E.width;if(wr(o,C,x,N),C=T=[T],e((x=o.C)<(N=d)),e(E.v<E.va),N>E.o&&(N=E.o),x<E.j){var U=E.j-x;x=E.j,C[0]+=U*M}if(x>=N?x=0:(C[0]+=4*E.v,E.ka=x-E.j,E.U=E.va-E.v,E.T=N-x,x=1),x){if(T=T[0],11>(x=o.ca).S){var ae=x.f.RGBA,he=(N=x.S,C=E.U,E=E.T,U=ae.eb,ae.A),fe=E;for(ae=ae.fb+o.Ma*ae.A;0<fe--;){var le=O,Ne=T,ge=C,ie=U,oe=ae;switch(N){case ms:gr(le,Ne,ge,ie,oe);break;case gs:dr(le,Ne,ge,ie,oe);break;case Co:dr(le,Ne,ge,ie,oe),Dr(ie,oe,0,ge,1,0);break;case Ll:yn(le,Ne,ge,ie,oe);break;case xs:Lt(le,Ne,ge,ie,oe,1);break;case Po:Lt(le,Ne,ge,ie,oe,1),Dr(ie,oe,0,ge,1,0);break;case bs:Lt(le,Ne,ge,ie,oe,0);break;case vs:Lt(le,Ne,ge,ie,oe,0),Dr(ie,oe,1,ge,1,0);break;case ko:In(le,Ne,ge,ie,oe);break;case Fo:In(le,Ne,ge,ie,oe),jt(ie,oe,ge,1,0);break;case Al:vn(le,Ne,ge,ie,oe);break;default:e(0)}T+=M,ae+=he}o.Ma+=E}else alert("todo:EmitRescaledRowsYUVA");e(o.Ma<=x.height)}}o.C=d,e(o.C<=o.i)}function gn(o){var d;if(0<o.ua)return 0;for(d=0;d<o.Wb;++d){var x=o.Ya[d].G,N=o.Ya[d].H;if(0<x[1][N[1]+0].g||0<x[2][N[2]+0].g||0<x[3][N[3]+0].g)return 0}return 1}function qr(o,d,x,N,C,E){if(o.Z!=0){var O=o.qd,T=o.rd;for(e(Mn[o.Z]!=null);d<x;++d)Mn[o.Z](O,T,N,C,N,C,E),O=N,T=C,C+=E;o.qd=O,o.rd=T}}function zr(o,d){var x=o.l.ma,N=x.Z==0||x.Z==1?o.l.j:o.C;if(N=o.C<N?N:o.C,e(d<=o.l.o),d>N){var C=o.l.width,E=x.ca,O=x.tb+C*N,T=o.V,M=o.Ba+o.c*N,U=o.gc;e(o.ab==1),e(U[0].hc==3),ds(U[0],N,d,T,M,E,O),qr(x,N,d,E,O,C)}o.C=o.Ma=d}function Ur(o,d,x,N,C,E,O){var T=o.$/N,M=o.$%N,U=o.m,ae=o.s,he=x+o.$,fe=he;C=x+N*C;var le=x+N*E,Ne=280+ae.ua,ge=o.Pb?T:16777216,ie=0<ae.ua?ae.Wa:null,oe=ae.wc,ye=he<le?qt(ae,M,T):null;e(o.C<E),e(le<=C);var je=!1;e:for(;;){for(;je||he<le;){var we=0;if(T>=ge){var Me=he-x;e((ge=o).Pb),ge.wd=ge.m,ge.xd=Me,0<ge.s.ua&&be(ge.s.Wa,ge.s.vb),ge=T+zd}if(M&oe||(ye=qt(ae,M,T)),e(ye!=null),ye.Qb&&(d[he]=ye.qb,je=!0),!je)if(W(U),ye.jc){we=U,Me=d;var Pe=he,Ve=ye.pd[z(we)&Zt-1];e(ye.jc),256>Ve.g?(ee(we,we.u+Ve.g),Me[Pe]=Ve.value,we=0):(ee(we,we.u+Ve.g-256),e(256<=Ve.value),we=Ve.value),we==0&&(je=!0)}else we=fr(ye.G[0],ye.H[0],U);if(U.h)break;if(je||256>we){if(!je)if(ye.nd)d[he]=(ye.qb|we<<8)>>>0;else{if(W(U),je=fr(ye.G[1],ye.H[1],U),W(U),Me=fr(ye.G[2],ye.H[2],U),Pe=fr(ye.G[3],ye.H[3],U),U.h)break;d[he]=(Pe<<24|je<<16|we<<8|Me)>>>0}if(je=!1,++he,++M>=N&&(M=0,++T,O!=null&&T<=E&&!(T%16)&&O(o,T),ie!=null))for(;fe<he;)we=d[fe++],ie.X[(506832829*we&4294967295)>>>ie.Mb]=we}else if(280>we){if(we=Rr(we-256,U),Me=fr(ye.G[4],ye.H[4],U),W(U),Me=nn(N,Me=Rr(Me,U)),U.h)break;if(he-x<Me||C-he<we)break e;for(Pe=0;Pe<we;++Pe)d[he+Pe]=d[he+Pe-Me];for(he+=we,M+=we;M>=N;)M-=N,++T,O!=null&&T<=E&&!(T%16)&&O(o,T);if(e(he<=C),M&oe&&(ye=qt(ae,M,T)),ie!=null)for(;fe<he;)we=d[fe++],ie.X[(506832829*we&4294967295)>>>ie.Mb]=we}else{if(!(we<Ne))break e;for(je=we-280,e(ie!=null);fe<he;)we=d[fe++],ie.X[(506832829*we&4294967295)>>>ie.Mb]=we;we=he,e(!(je>>>(Me=ie).Xa)),d[we]=Me.X[je],je=!0}je||e(U.h==V(U))}if(o.Pb&&U.h&&he<C)e(o.m.h),o.a=5,o.m=o.wd,o.$=o.xd,0<o.s.ua&&be(o.s.vb,o.s.Wa);else{if(U.h)break e;O!=null&&O(o,T>E?E:T),o.a=0,o.$=he-x}return 1}return o.a=3,0}function an(o){e(o!=null),o.vc=null,o.yc=null,o.Ya=null;var d=o.Wa;d!=null&&(d.X=null),o.vb=null,e(o!=null)}function kr(){var o=new So;return o==null?null:(o.a=0,o.xb=Pl,en("Predictor","VP8LPredictors"),en("Predictor","VP8LPredictors_C"),en("PredictorAdd","VP8LPredictorsAdd"),en("PredictorAdd","VP8LPredictorsAdd_C"),cs=ct,aa=Ye,gr=Be,dr=rr,In=ut,vn=Tr,yn=yt,X.VP8LMapColor32b=Ba,X.VP8LMapColor8b=us,o)}function sn(o,d,x,N,C){var E=1,O=[o],T=[d],M=N.m,U=N.s,ae=null,he=0;e:for(;;){if(x)for(;E&&re(M,1);){var fe=O,le=T,Ne=N,ge=1,ie=Ne.m,oe=Ne.gc[Ne.ab],ye=re(ie,2);if(Ne.Oc&1<<ye)E=0;else{switch(Ne.Oc|=1<<ye,oe.hc=ye,oe.Ea=fe[0],oe.nc=le[0],oe.K=[null],++Ne.ab,e(4>=Ne.ab),ye){case 0:case 1:oe.b=re(ie,3)+2,ge=sn(qe(oe.Ea,oe.b),qe(oe.nc,oe.b),0,Ne,oe.K),oe.K=oe.K[0];break;case 3:var je,we=re(ie,8)+1,Me=16<we?0:4<we?1:2<we?2:3;if(fe[0]=qe(oe.Ea,Me),oe.b=Me,je=ge=sn(we,1,0,Ne,oe.K)){var Pe,Ve=we,Ee=oe,ht=1<<(8>>Ee.b),mt=i(ht);if(mt==null)je=0;else{var dt=Ee.K[0],st=Ee.w;for(mt[0]=Ee.K[0][0],Pe=1;Pe<1*Ve;++Pe)mt[Pe]=Ae(dt[st+Pe],mt[Pe-1]);for(;Pe<4*ht;++Pe)mt[Pe]=0;Ee.K[0]=null,Ee.K[0]=mt,je=1}}ge=je;break;case 2:break;default:e(0)}E=ge}}if(O=O[0],T=T[0],E&&re(M,1)&&!(E=1<=(he=re(M,4))&&11>=he)){N.a=3;break e}var wt;if(wt=E)t:{var vt,rt,Ut,xr=N,$t=O,br=T,gt=he,_r=x,Sr=xr.m,Yt=xr.s,Qt=[null],hr=1,Or=0,dn=qd[gt];r:for(;;){if(_r&&re(Sr,1)){var Jt=re(Sr,3)+2,_n=qe($t,Jt),ca=qe(br,Jt),za=_n*ca;if(!sn(_n,ca,0,xr,Qt))break r;for(Qt=Qt[0],Yt.xc=Jt,vt=0;vt<za;++vt){var Rn=Qt[vt]>>8&65535;Qt[vt]=Rn,Rn>=hr&&(hr=Rn+1)}}if(Sr.h)break r;for(rt=0;5>rt;++rt){var Dt=kl[rt];!rt&&0<gt&&(Dt+=1<<gt),Or<Dt&&(Or=Dt)}var Oo=l(hr*dn,h),Rl=hr,ql=l(Rl,S);if(ql==null)var js=null;else e(65536>=Rl),js=ql;var Pi=i(Or);if(js==null||Pi==null||Oo==null){xr.a=1;break r}var _s=Oo;for(vt=Ut=0;vt<hr;++vt){var Gr=js[vt],Ua=Gr.G,$a=Gr.H,zl=0,Ss=1,Ul=0;for(rt=0;5>rt;++rt){Dt=kl[rt],Ua[rt]=_s,$a[rt]=Ut,!rt&&0<gt&&(Dt+=1<<gt);a:{var Ls,Bo=Dt,As=xr,Fi=Pi,ou=_s,lu=Ut,To=0,qn=As.m,cu=re(qn,1);if(s(Fi,0,0,Bo),cu){var du=re(qn,1)+1,uu=re(qn,1),$l=re(qn,uu==0?1:8);Fi[$l]=1,du==2&&(Fi[$l=re(qn,8)]=1);var ks=1}else{var Vl=i(19),Hl=re(qn,4)+4;if(19<Hl){As.a=3;var Cs=0;break a}for(Ls=0;Ls<Hl;++Ls)Vl[Md[Ls]]=re(qn,3);var Mo=void 0,Di=void 0,Wl=As,hu=Vl,Ps=Bo,Gl=Fi,Ro=0,zn=Wl.m,Yl=8,Jl=l(128,h);n:for(;I(Jl,0,7,hu,19);){if(re(zn,1)){var fu=2+2*re(zn,3);if((Mo=2+re(zn,fu))>Ps)break n}else Mo=Ps;for(Di=0;Di<Ps&&Mo--;){W(zn);var Xl=Jl[0+(127&z(zn))];ee(zn,zn.u+Xl.g);var Va=Xl.value;if(16>Va)Gl[Di++]=Va,Va!=0&&(Yl=Va);else{var pu=Va==16,Kl=Va-16,mu=Bd[Kl],Zl=re(zn,Od[Kl])+mu;if(Di+Zl>Ps)break n;for(var gu=pu?Yl:0;0<Zl--;)Gl[Di++]=gu}}Ro=1;break n}Ro||(Wl.a=3),ks=Ro}(ks=ks&&!qn.h)&&(To=I(ou,lu,8,Fi,Bo)),ks&&To!=0?Cs=To:(As.a=3,Cs=0)}if(Cs==0)break r;if(Ss&&Td[rt]==1&&(Ss=_s[Ut].g==0),zl+=_s[Ut].g,Ut+=Cs,3>=rt){var Ei,qo=Pi[0];for(Ei=1;Ei<Dt;++Ei)Pi[Ei]>qo&&(qo=Pi[Ei]);Ul+=qo}}if(Gr.nd=Ss,Gr.Qb=0,Ss&&(Gr.qb=(Ua[3][$a[3]+0].value<<24|Ua[1][$a[1]+0].value<<16|Ua[2][$a[2]+0].value)>>>0,zl==0&&256>Ua[0][$a[0]+0].value&&(Gr.Qb=1,Gr.qb+=Ua[0][$a[0]+0].value<<8)),Gr.jc=!Gr.Qb&&6>Ul,Gr.jc){var Fs,Sn=Gr;for(Fs=0;Fs<Zt;++Fs){var Un=Fs,$n=Sn.pd[Un],Ds=Sn.G[0][Sn.H[0]+Un];256<=Ds.value?($n.g=Ds.g+256,$n.value=Ds.value):($n.g=0,$n.value=0,Un>>=Ht(Ds,8,$n),Un>>=Ht(Sn.G[1][Sn.H[1]+Un],16,$n),Un>>=Ht(Sn.G[2][Sn.H[2]+Un],0,$n),Ht(Sn.G[3][Sn.H[3]+Un],24,$n))}}}Yt.vc=Qt,Yt.Wb=hr,Yt.Ya=js,Yt.yc=Oo,wt=1;break t}wt=0}if(!(E=wt)){N.a=3;break e}if(0<he){if(U.ua=1<<he,!We(U.Wa,he)){N.a=1,E=0;break e}}else U.ua=0;var zo=N,Ql=O,xu=T,Uo=zo.s,$o=Uo.xc;if(zo.c=Ql,zo.i=xu,Uo.md=qe(Ql,$o),Uo.wc=$o==0?-1:(1<<$o)-1,x){N.xb=Yd;break e}if((ae=i(O*T))==null){N.a=1,E=0;break e}E=(E=Ur(N,ae,0,O,T,T,null))&&!M.h;break e}return E?(C!=null?C[0]=ae:(e(ae==null),e(x)),N.$=0,x||an(U)):an(U),E}function Qn(o,d){var x=o.c*o.i,N=x+d+16*d;return e(o.c<=d),o.V=i(N),o.V==null?(o.Ta=null,o.Ua=0,o.a=1,0):(o.Ta=o.V,o.Ua=o.Ba+x+d,1)}function xa(o,d){var x=o.C,N=d-x,C=o.V,E=o.Ba+o.c*x;for(e(d<=o.l.o);0<N;){var O=16<N?16:N,T=o.l.ma,M=o.l.width,U=M*O,ae=T.ca,he=T.tb+M*x,fe=o.Ta,le=o.Ua;wr(o,O,C,E),Bt(fe,le,ae,he,U),qr(T,x,x+O,ae,he,M),N-=O,C+=O*o.c,x+=O}e(x==d),o.C=o.Ma=d}function ba(){this.ub=this.yd=this.td=this.Rb=0}function va(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ya(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function $i(){this.Yb=function(){var o=[];return function d(x,N,C){for(var E=C[N],O=0;O<E&&(x.push(C.length>N+1?[]:0),!(C.length<N+1));O++)d(x[O],N+1,C)}(o,0,[3,11]),o}()}function to(){this.jb=i(3),this.Wc=u([4,8],$i),this.Xc=u([4,17],$i)}function ro(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function wa(){this.ld=this.La=this.dd=this.tc=0}function Vi(){this.Na=this.la=0}function no(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ai(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ao(){this.uc=this.M=this.Nb=0,this.wa=Array(new wa),this.Y=0,this.ya=Array(new ai),this.aa=0,this.l=new Na}function Hi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function io(){this.cb=this.a=0,this.sc="",this.m=new ve,this.Od=new ba,this.Kc=new va,this.ed=new ro,this.Qa=new ya,this.Ic=this.$c=this.Aa=0,this.D=new ao,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,ve),this.ia=0,this.pb=l(4,no),this.Pa=new to,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Hi),this.Hd=0,this.rb=Array(new Vi),this.sb=0,this.wa=Array(new wa),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ai),this.L=this.aa=0,this.gd=u([4,2],wa),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Na(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function so(){var o=new io;return o!=null&&(o.a=0,o.sc="OK",o.cb=0,o.Xb=0,ki||(ki=Yi)),o}function It(o,d,x){return o.a==0&&(o.a=d,o.sc=x,o.cb=0),0}function Wi(o,d,x){return 3<=x&&o[d+0]==157&&o[d+1]==1&&o[d+2]==42}function Gi(o,d){if(o==null)return 0;if(o.a=0,o.sc="OK",d==null)return It(o,2,"null VP8Io passed to VP8GetHeaders()");var x=d.data,N=d.w,C=d.ha;if(4>C)return It(o,7,"Truncated header.");var E=x[N+0]|x[N+1]<<8|x[N+2]<<16,O=o.Od;if(O.Rb=!(1&E),O.td=E>>1&7,O.yd=E>>4&1,O.ub=E>>5,3<O.td)return It(o,3,"Incorrect keyframe parameters.");if(!O.yd)return It(o,4,"Frame not displayable.");N+=3,C-=3;var T=o.Kc;if(O.Rb){if(7>C)return It(o,7,"cannot parse picture header");if(!Wi(x,N,C))return It(o,3,"Bad code word");T.c=16383&(x[N+4]<<8|x[N+3]),T.Td=x[N+4]>>6,T.i=16383&(x[N+6]<<8|x[N+5]),T.Ud=x[N+6]>>6,N+=7,C-=7,o.za=T.c+15>>4,o.Ub=T.i+15>>4,d.width=T.c,d.height=T.i,d.Da=0,d.j=0,d.v=0,d.va=d.width,d.o=d.height,d.da=0,d.ib=d.width,d.hb=d.height,d.U=d.width,d.T=d.height,s((E=o.Pa).jb,0,255,E.jb.length),e((E=o.Qa)!=null),E.Cb=0,E.Bb=0,E.Fb=1,s(E.Zb,0,0,E.Zb.length),s(E.Lb,0,0,E.Lb)}if(O.ub>C)return It(o,7,"bad partition length");D(E=o.m,x,N,O.ub),N+=O.ub,C-=O.ub,O.Rb&&(T.Ld=de(E),T.Kd=de(E)),T=o.Qa;var M,U=o.Pa;if(e(E!=null),e(T!=null),T.Cb=de(E),T.Cb){if(T.Bb=de(E),de(E)){for(T.Fb=de(E),M=0;4>M;++M)T.Zb[M]=de(E)?A(E,7):0;for(M=0;4>M;++M)T.Lb[M]=de(E)?A(E,6):0}if(T.Bb)for(M=0;3>M;++M)U.jb[M]=de(E)?F(E,8):255}else T.Bb=0;if(E.Ka)return It(o,3,"cannot parse segment header");if((T=o.ed).zd=de(E),T.Tb=F(E,6),T.wb=F(E,3),T.Pc=de(E),T.Pc&&de(E)){for(U=0;4>U;++U)de(E)&&(T.vd[U]=A(E,6));for(U=0;4>U;++U)de(E)&&(T.od[U]=A(E,6))}if(o.L=T.Tb==0?0:T.zd?1:2,E.Ka)return It(o,3,"cannot parse filter header");var ae=C;if(C=M=N,N=M+ae,T=ae,o.Xb=(1<<F(o.m,2))-1,ae<3*(U=o.Xb))x=7;else{for(M+=3*U,T-=3*U,ae=0;ae<U;++ae){var he=x[C+0]|x[C+1]<<8|x[C+2]<<16;he>T&&(he=T),D(o.Jc[+ae],x,M,he),M+=he,T-=he,C+=3}D(o.Jc[+U],x,M,T),x=M<N?0:5}if(x!=0)return It(o,x,"cannot parse partitions");for(x=F(M=o.m,7),C=de(M)?A(M,4):0,N=de(M)?A(M,4):0,T=de(M)?A(M,4):0,U=de(M)?A(M,4):0,M=de(M)?A(M,4):0,ae=o.Qa,he=0;4>he;++he){if(ae.Cb){var fe=ae.Zb[he];ae.Fb||(fe+=x)}else{if(0<he){o.pb[he]=o.pb[0];continue}fe=x}var le=o.pb[he];le.Sc[0]=Do[Nr(fe+C,127)],le.Sc[1]=Eo[Nr(fe+0,127)],le.Eb[0]=2*Do[Nr(fe+N,127)],le.Eb[1]=101581*Eo[Nr(fe+T,127)]>>16,8>le.Eb[1]&&(le.Eb[1]=8),le.Qc[0]=Do[Nr(fe+U,117)],le.Qc[1]=Eo[Nr(fe+M,127)],le.lc=fe+M}if(!O.Rb)return It(o,4,"Not a key frame.");for(de(E),O=o.Pa,x=0;4>x;++x){for(C=0;8>C;++C)for(N=0;3>N;++N)for(T=0;11>T;++T)U=ue(E,Wd[x][C][N][T])?F(E,8):Vd[x][C][N][T],O.Wc[x][C].Yb[N][T]=U;for(C=0;17>C;++C)O.Xc[x][C]=O.Wc[x][Gd[C]]}return o.kc=de(E),o.kc&&(o.Bd=F(E,8)),o.cb=1}function Yi(o,d,x,N,C,E,O){var T=d[C].Yb[x];for(x=0;16>C;++C){if(!ue(o,T[x+0]))return C;for(;!ue(o,T[x+1]);)if(T=d[++C].Yb[0],x=0,C==16)return 16;var M=d[C+1].Yb;if(ue(o,T[x+2])){var U=o,ae=0;if(ue(U,(fe=T)[(he=x)+3]))if(ue(U,fe[he+6])){for(T=0,he=2*(ae=ue(U,fe[he+8]))+(fe=ue(U,fe[he+9+ae])),ae=0,fe=Ud[he];fe[T];++T)ae+=ae+ue(U,fe[T]);ae+=3+(8<<he)}else ue(U,fe[he+7])?(ae=7+2*ue(U,165),ae+=ue(U,145)):ae=5+ue(U,159);else ae=ue(U,fe[he+4])?3+ue(U,fe[he+5]):2;T=M[2]}else ae=1,T=M[1];M=O+$d[C],0>(U=o).b&&ne(U);var he,fe=U.b,le=(he=U.Ca>>1)-(U.I>>fe)>>31;--U.b,U.Ca+=le,U.Ca|=1,U.I-=(he+1&le)<<fe,E[M]=((ae^le)-le)*N[(0<C)+0]}return 16}function ii(o){var d=o.rb[o.sb-1];d.la=0,d.Na=0,s(o.zc,0,0,o.zc.length),o.ja=0}function oo(o,d){if(o==null)return 0;if(d==null)return It(o,2,"NULL VP8Io parameter in VP8Decode().");if(!o.cb&&!Gi(o,d))return 0;if(e(o.cb),d.ac==null||d.ac(d)){d.ob&&(o.L=0);var x=Ns[o.L];if(o.L==2?(o.yb=0,o.zb=0):(o.yb=d.v-x>>4,o.zb=d.j-x>>4,0>o.yb&&(o.yb=0),0>o.zb&&(o.zb=0)),o.Va=d.o+15+x>>4,o.Hb=d.va+15+x>>4,o.Hb>o.za&&(o.Hb=o.za),o.Va>o.Ub&&(o.Va=o.Ub),0<o.L){var N=o.ed;for(x=0;4>x;++x){var C;if(o.Qa.Cb){var E=o.Qa.Lb[x];o.Qa.Fb||(E+=N.Tb)}else E=N.Tb;for(C=0;1>=C;++C){var O=o.gd[x][C],T=E;if(N.Pc&&(T+=N.vd[0],C&&(T+=N.od[0])),0<(T=0>T?0:63<T?63:T)){var M=T;0<N.wb&&(M=4<N.wb?M>>2:M>>1)>9-N.wb&&(M=9-N.wb),1>M&&(M=1),O.dd=M,O.tc=2*T+M,O.ld=40<=T?2:15<=T?1:0}else O.tc=0;O.La=C}}}x=0}else It(o,6,"Frame setup failed"),x=o.a;if(x=x==0){if(x){o.$c=0,0<o.Aa||(o.Ic=su);e:{x=o.Ic,N=4*(M=o.za);var U=32*M,ae=M+1,he=0<o.L?M*(0<o.Aa?2:1):0,fe=(o.Aa==2?2:1)*M;if((O=N+832+(C=3*(16*x+Ns[o.L])/2*U)+(E=o.Fa!=null&&0<o.Fa.length?o.Kc.c*o.Kc.i:0))!=O)x=0;else{if(O>o.Vb){if(o.Vb=0,o.Ec=i(O),o.Fc=0,o.Ec==null){x=It(o,1,"no memory during frame initialization.");break e}o.Vb=O}O=o.Ec,T=o.Fc,o.Ac=O,o.Bc=T,T+=N,o.Gd=l(U,Hi),o.Hd=0,o.rb=l(ae+1,Vi),o.sb=1,o.wa=he?l(he,wa):null,o.Y=0,o.D.Nb=0,o.D.wa=o.wa,o.D.Y=o.Y,0<o.Aa&&(o.D.Y+=M),e(!0),o.oc=O,o.pc=T,T+=832,o.ya=l(fe,ai),o.aa=0,o.D.ya=o.ya,o.D.aa=o.aa,o.Aa==2&&(o.D.aa+=M),o.R=16*M,o.B=8*M,M=(U=Ns[o.L])*o.R,U=U/2*o.B,o.sa=O,o.ta=T+M,o.qa=o.sa,o.ra=o.ta+16*x*o.R+U,o.Ha=o.qa,o.Ia=o.ra+8*x*o.B+U,o.$c=0,T+=C,o.mb=E?O:null,o.nb=E?T:null,e(T+E<=o.Fc+o.Vb),ii(o),s(o.Ac,o.Bc,0,N),x=1}}if(x){if(d.ka=0,d.y=o.sa,d.O=o.ta,d.f=o.qa,d.N=o.ra,d.ea=o.Ha,d.Vd=o.Ia,d.fa=o.R,d.Rc=o.B,d.F=null,d.J=0,!fs){for(x=-255;255>=x;++x)Wt[255+x]=0>x?-x:x;for(x=-1020;1020>=x;++x)Nn[1020+x]=-128>x?-128:127<x?127:x;for(x=-112;112>=x;++x)Ai[112+x]=-16>x?-16:15<x?15:x;for(x=-255;510>=x;++x)qa[255+x]=0>x?0:255<x?255:x;fs=1}Ta=uo,wn=lo,_i=Xi,ur=co,Pr=Ki,Ot=Ji,Ma=ui,hs=ra,Si=_o,ia=hi,sa=jo,On=ka,oa=fi,Ra=ss,la=is,Bn=ln,Li=bn,Fr=No,Wr[0]=on,Wr[1]=ho,Wr[2]=go,Wr[3]=xo,Wr[4]=es,Wr[5]=La,Wr[6]=ts,Wr[7]=li,Wr[8]=vo,Wr[9]=bo,Tn[0]=Zi,Tn[1]=po,Tn[2]=xn,Tn[3]=_a,Tn[4]=nr,Tn[5]=mo,Tn[6]=Qi,jn[0]=Pn,jn[1]=fo,jn[2]=yo,jn[3]=ci,jn[4]=ta,jn[5]=wo,jn[6]=di,x=1}else x=0}x&&(x=function(le,Ne){for(le.M=0;le.M<le.Va;++le.M){var ge,ie=le.Jc[le.M&le.Xb],oe=le.m,ye=le;for(ge=0;ge<ye.za;++ge){var je=oe,we=ye,Me=we.Ac,Pe=we.Bc+4*ge,Ve=we.zc,Ee=we.ya[we.aa+ge];if(we.Qa.Bb?Ee.$b=ue(je,we.Pa.jb[0])?2+ue(je,we.Pa.jb[2]):ue(je,we.Pa.jb[1]):Ee.$b=0,we.kc&&(Ee.Ad=ue(je,we.Bd)),Ee.Za=!ue(je,145)+0,Ee.Za){var ht=Ee.Ob,mt=0;for(we=0;4>we;++we){var dt,st=Ve[0+we];for(dt=0;4>dt;++dt){st=Hd[Me[Pe+dt]][st];for(var wt=Cl[ue(je,st[0])];0<wt;)wt=Cl[2*wt+ue(je,st[wt])];st=-wt,Me[Pe+dt]=st}a(ht,mt,Me,Pe,4),mt+=4,Ve[0+we]=st}}else st=ue(je,156)?ue(je,128)?1:3:ue(je,163)?2:0,Ee.Ob[0]=st,s(Me,Pe,st,4),s(Ve,0,st,4);Ee.Dd=ue(je,142)?ue(je,114)?ue(je,183)?1:3:2:0}if(ye.m.Ka)return It(le,7,"Premature end-of-partition0 encountered.");for(;le.ja<le.za;++le.ja){if(ye=ie,je=(oe=le).rb[oe.sb-1],Me=oe.rb[oe.sb+oe.ja],ge=oe.ya[oe.aa+oe.ja],Pe=oe.kc?ge.Ad:0)je.la=Me.la=0,ge.Za||(je.Na=Me.Na=0),ge.Hc=0,ge.Gc=0,ge.ia=0;else{var vt,rt;if(je=Me,Me=ye,Pe=oe.Pa.Xc,Ve=oe.ya[oe.aa+oe.ja],Ee=oe.pb[Ve.$b],we=Ve.ad,ht=0,mt=oe.rb[oe.sb-1],st=dt=0,s(we,ht,0,384),Ve.Za)var Ut=0,xr=Pe[3];else{wt=i(16);var $t=je.Na+mt.Na;if($t=ki(Me,Pe[1],$t,Ee.Eb,0,wt,0),je.Na=mt.Na=(0<$t)+0,1<$t)Ta(wt,0,we,ht);else{var br=wt[0]+3>>3;for(wt=0;256>wt;wt+=16)we[ht+wt]=br}Ut=1,xr=Pe[0]}var gt=15&je.la,_r=15&mt.la;for(wt=0;4>wt;++wt){var Sr=1&_r;for(br=rt=0;4>br;++br)gt=gt>>1|(Sr=($t=ki(Me,xr,$t=Sr+(1&gt),Ee.Sc,Ut,we,ht))>Ut)<<7,rt=rt<<2|(3<$t?3:1<$t?2:we[ht+0]!=0),ht+=16;gt>>=4,_r=_r>>1|Sr<<7,dt=(dt<<8|rt)>>>0}for(xr=gt,Ut=_r>>4,vt=0;4>vt;vt+=2){for(rt=0,gt=je.la>>4+vt,_r=mt.la>>4+vt,wt=0;2>wt;++wt){for(Sr=1&_r,br=0;2>br;++br)$t=Sr+(1&gt),gt=gt>>1|(Sr=0<($t=ki(Me,Pe[2],$t,Ee.Qc,0,we,ht)))<<3,rt=rt<<2|(3<$t?3:1<$t?2:we[ht+0]!=0),ht+=16;gt>>=2,_r=_r>>1|Sr<<5}st|=rt<<4*vt,xr|=gt<<4<<vt,Ut|=(240&_r)<<vt}je.la=xr,mt.la=Ut,Ve.Hc=dt,Ve.Gc=st,Ve.ia=43690&st?0:Ee.ia,Pe=!(dt|st)}if(0<oe.L&&(oe.wa[oe.Y+oe.ja]=oe.gd[ge.$b][ge.Za],oe.wa[oe.Y+oe.ja].La|=!Pe),ye.Ka)return It(le,7,"Premature end-of-file encountered.")}if(ii(le),oe=Ne,ye=1,ge=(ie=le).D,je=0<ie.L&&ie.M>=ie.zb&&ie.M<=ie.Va,ie.Aa==0)e:{if(ge.M=ie.M,ge.uc=je,vi(ie,ge),ye=1,ge=(rt=ie.D).Nb,je=(st=Ns[ie.L])*ie.R,Me=st/2*ie.B,wt=16*ge*ie.R,br=8*ge*ie.B,Pe=ie.sa,Ve=ie.ta-je+wt,Ee=ie.qa,we=ie.ra-Me+br,ht=ie.Ha,mt=ie.Ia-Me+br,_r=(gt=rt.M)==0,dt=gt>=ie.Va-1,ie.Aa==2&&vi(ie,rt),rt.uc)for(Sr=($t=ie).D.M,e($t.D.uc),rt=$t.yb;rt<$t.Hb;++rt){Ut=rt,xr=Sr;var Yt=(Qt=(Dt=$t).D).Nb;vt=Dt.R;var Qt=Qt.wa[Qt.Y+Ut],hr=Dt.sa,Or=Dt.ta+16*Yt*vt+16*Ut,dn=Qt.dd,Jt=Qt.tc;if(Jt!=0)if(e(3<=Jt),Dt.L==1)0<Ut&&Bn(hr,Or,vt,Jt+4),Qt.La&&Fr(hr,Or,vt,Jt),0<xr&&la(hr,Or,vt,Jt+4),Qt.La&&Li(hr,Or,vt,Jt);else{var _n=Dt.B,ca=Dt.qa,za=Dt.ra+8*Yt*_n+8*Ut,Rn=Dt.Ha,Dt=Dt.Ia+8*Yt*_n+8*Ut;Yt=Qt.ld,0<Ut&&(hs(hr,Or,vt,Jt+4,dn,Yt),ia(ca,za,Rn,Dt,_n,Jt+4,dn,Yt)),Qt.La&&(On(hr,Or,vt,Jt,dn,Yt),Ra(ca,za,Rn,Dt,_n,Jt,dn,Yt)),0<xr&&(Ma(hr,Or,vt,Jt+4,dn,Yt),Si(ca,za,Rn,Dt,_n,Jt+4,dn,Yt)),Qt.La&&(sa(hr,Or,vt,Jt,dn,Yt),oa(ca,za,Rn,Dt,_n,Jt,dn,Yt))}}if(ie.ia&&alert("todo:DitherRow"),oe.put!=null){if(rt=16*gt,gt=16*(gt+1),_r?(oe.y=ie.sa,oe.O=ie.ta+wt,oe.f=ie.qa,oe.N=ie.ra+br,oe.ea=ie.Ha,oe.W=ie.Ia+br):(rt-=st,oe.y=Pe,oe.O=Ve,oe.f=Ee,oe.N=we,oe.ea=ht,oe.W=mt),dt||(gt-=st),gt>oe.o&&(gt=oe.o),oe.F=null,oe.J=null,ie.Fa!=null&&0<ie.Fa.length&&rt<gt&&(oe.J=xi(ie,oe,rt,gt-rt),oe.F=ie.mb,oe.F==null&&oe.F.length==0)){ye=It(ie,3,"Could not decode alpha data.");break e}rt<oe.j&&(st=oe.j-rt,rt=oe.j,e(!(1&st)),oe.O+=ie.R*st,oe.N+=ie.B*(st>>1),oe.W+=ie.B*(st>>1),oe.F!=null&&(oe.J+=oe.width*st)),rt<gt&&(oe.O+=oe.v,oe.N+=oe.v>>1,oe.W+=oe.v>>1,oe.F!=null&&(oe.J+=oe.v),oe.ka=rt-oe.j,oe.U=oe.va-oe.v,oe.T=gt-rt,ye=oe.put(oe))}ge+1!=ie.Ic||dt||(a(ie.sa,ie.ta-je,Pe,Ve+16*ie.R,je),a(ie.qa,ie.ra-Me,Ee,we+8*ie.B,Me),a(ie.Ha,ie.Ia-Me,ht,mt+8*ie.B,Me))}if(!ye)return It(le,6,"Output aborted.")}return 1}(o,d)),d.bc!=null&&d.bc(d),x&=1}return x?(o.cb=0,x):0}function $r(o,d,x,N,C){C=o[d+x+32*N]+(C>>3),o[d+x+32*N]=-256&C?0>C?0:255:C}function ja(o,d,x,N,C,E){$r(o,d,0,x,N+C),$r(o,d,1,x,N+E),$r(o,d,2,x,N-E),$r(o,d,3,x,N-C)}function pr(o){return(20091*o>>16)+o}function si(o,d,x,N){var C,E=0,O=i(16);for(C=0;4>C;++C){var T=o[d+0]+o[d+8],M=o[d+0]-o[d+8],U=(35468*o[d+4]>>16)-pr(o[d+12]),ae=pr(o[d+4])+(35468*o[d+12]>>16);O[E+0]=T+ae,O[E+1]=M+U,O[E+2]=M-U,O[E+3]=T-ae,E+=4,d++}for(C=E=0;4>C;++C)T=(o=O[E+0]+4)+O[E+8],M=o-O[E+8],U=(35468*O[E+4]>>16)-pr(O[E+12]),$r(x,N,0,0,T+(ae=pr(O[E+4])+(35468*O[E+12]>>16))),$r(x,N,1,0,M+U),$r(x,N,2,0,M-U),$r(x,N,3,0,T-ae),E++,N+=32}function Ji(o,d,x,N){var C=o[d+0]+4,E=35468*o[d+4]>>16,O=pr(o[d+4]),T=35468*o[d+1]>>16;ja(x,N,0,C+O,o=pr(o[d+1]),T),ja(x,N,1,C+E,o,T),ja(x,N,2,C-E,o,T),ja(x,N,3,C-O,o,T)}function lo(o,d,x,N,C){si(o,d,x,N),C&&si(o,d+16,x,N+4)}function Xi(o,d,x,N){wn(o,d+0,x,N,1),wn(o,d+32,x,N+128,1)}function co(o,d,x,N){var C;for(o=o[d+0]+4,C=0;4>C;++C)for(d=0;4>d;++d)$r(x,N,d,C,o)}function Ki(o,d,x,N){o[d+0]&&ur(o,d+0,x,N),o[d+16]&&ur(o,d+16,x,N+4),o[d+32]&&ur(o,d+32,x,N+128),o[d+48]&&ur(o,d+48,x,N+128+4)}function uo(o,d,x,N){var C,E=i(16);for(C=0;4>C;++C){var O=o[d+0+C]+o[d+12+C],T=o[d+4+C]+o[d+8+C],M=o[d+4+C]-o[d+8+C],U=o[d+0+C]-o[d+12+C];E[0+C]=O+T,E[8+C]=O-T,E[4+C]=U+M,E[12+C]=U-M}for(C=0;4>C;++C)O=(o=E[0+4*C]+3)+E[3+4*C],T=E[1+4*C]+E[2+4*C],M=E[1+4*C]-E[2+4*C],U=o-E[3+4*C],x[N+0]=O+T>>3,x[N+16]=U+M>>3,x[N+32]=O-T>>3,x[N+48]=U-M>>3,N+=64}function oi(o,d,x){var N,C=d-32,E=jr,O=255-o[C-1];for(N=0;N<x;++N){var T,M=E,U=O+o[d-1];for(T=0;T<x;++T)o[d+T]=M[U+o[C+T]];d+=32}}function ho(o,d){oi(o,d,4)}function fo(o,d){oi(o,d,8)}function po(o,d){oi(o,d,16)}function xn(o,d){var x;for(x=0;16>x;++x)a(o,d+32*x,o,d-32,16)}function _a(o,d){var x;for(x=16;0<x;--x)s(o,d,o[d-1],16),d+=32}function Sa(o,d,x){var N;for(N=0;16>N;++N)s(d,x+32*N,o,16)}function Zi(o,d){var x,N=16;for(x=0;16>x;++x)N+=o[d-1+32*x]+o[d+x-32];Sa(N>>5,o,d)}function nr(o,d){var x,N=8;for(x=0;16>x;++x)N+=o[d-1+32*x];Sa(N>>4,o,d)}function mo(o,d){var x,N=8;for(x=0;16>x;++x)N+=o[d+x-32];Sa(N>>4,o,d)}function Qi(o,d){Sa(128,o,d)}function Je(o,d,x){return o+2*d+x+2>>2}function go(o,d){var x,N=d-32;for(N=new Uint8Array([Je(o[N-1],o[N+0],o[N+1]),Je(o[N+0],o[N+1],o[N+2]),Je(o[N+1],o[N+2],o[N+3]),Je(o[N+2],o[N+3],o[N+4])]),x=0;4>x;++x)a(o,d+32*x,N,0,N.length)}function xo(o,d){var x=o[d-1],N=o[d-1+32],C=o[d-1+64],E=o[d-1+96];Le(o,d+0,16843009*Je(o[d-1-32],x,N)),Le(o,d+32,16843009*Je(x,N,C)),Le(o,d+64,16843009*Je(N,C,E)),Le(o,d+96,16843009*Je(C,E,E))}function on(o,d){var x,N=4;for(x=0;4>x;++x)N+=o[d+x-32]+o[d-1+32*x];for(N>>=3,x=0;4>x;++x)s(o,d+32*x,N,4)}function es(o,d){var x=o[d-1+0],N=o[d-1+32],C=o[d-1+64],E=o[d-1-32],O=o[d+0-32],T=o[d+1-32],M=o[d+2-32],U=o[d+3-32];o[d+0+96]=Je(N,C,o[d-1+96]),o[d+1+96]=o[d+0+64]=Je(x,N,C),o[d+2+96]=o[d+1+64]=o[d+0+32]=Je(E,x,N),o[d+3+96]=o[d+2+64]=o[d+1+32]=o[d+0+0]=Je(O,E,x),o[d+3+64]=o[d+2+32]=o[d+1+0]=Je(T,O,E),o[d+3+32]=o[d+2+0]=Je(M,T,O),o[d+3+0]=Je(U,M,T)}function ts(o,d){var x=o[d+1-32],N=o[d+2-32],C=o[d+3-32],E=o[d+4-32],O=o[d+5-32],T=o[d+6-32],M=o[d+7-32];o[d+0+0]=Je(o[d+0-32],x,N),o[d+1+0]=o[d+0+32]=Je(x,N,C),o[d+2+0]=o[d+1+32]=o[d+0+64]=Je(N,C,E),o[d+3+0]=o[d+2+32]=o[d+1+64]=o[d+0+96]=Je(C,E,O),o[d+3+32]=o[d+2+64]=o[d+1+96]=Je(E,O,T),o[d+3+64]=o[d+2+96]=Je(O,T,M),o[d+3+96]=Je(T,M,M)}function La(o,d){var x=o[d-1+0],N=o[d-1+32],C=o[d-1+64],E=o[d-1-32],O=o[d+0-32],T=o[d+1-32],M=o[d+2-32],U=o[d+3-32];o[d+0+0]=o[d+1+64]=E+O+1>>1,o[d+1+0]=o[d+2+64]=O+T+1>>1,o[d+2+0]=o[d+3+64]=T+M+1>>1,o[d+3+0]=M+U+1>>1,o[d+0+96]=Je(C,N,x),o[d+0+64]=Je(N,x,E),o[d+0+32]=o[d+1+96]=Je(x,E,O),o[d+1+32]=o[d+2+96]=Je(E,O,T),o[d+2+32]=o[d+3+96]=Je(O,T,M),o[d+3+32]=Je(T,M,U)}function li(o,d){var x=o[d+0-32],N=o[d+1-32],C=o[d+2-32],E=o[d+3-32],O=o[d+4-32],T=o[d+5-32],M=o[d+6-32],U=o[d+7-32];o[d+0+0]=x+N+1>>1,o[d+1+0]=o[d+0+64]=N+C+1>>1,o[d+2+0]=o[d+1+64]=C+E+1>>1,o[d+3+0]=o[d+2+64]=E+O+1>>1,o[d+0+32]=Je(x,N,C),o[d+1+32]=o[d+0+96]=Je(N,C,E),o[d+2+32]=o[d+1+96]=Je(C,E,O),o[d+3+32]=o[d+2+96]=Je(E,O,T),o[d+3+64]=Je(O,T,M),o[d+3+96]=Je(T,M,U)}function bo(o,d){var x=o[d-1+0],N=o[d-1+32],C=o[d-1+64],E=o[d-1+96];o[d+0+0]=x+N+1>>1,o[d+2+0]=o[d+0+32]=N+C+1>>1,o[d+2+32]=o[d+0+64]=C+E+1>>1,o[d+1+0]=Je(x,N,C),o[d+3+0]=o[d+1+32]=Je(N,C,E),o[d+3+32]=o[d+1+64]=Je(C,E,E),o[d+3+64]=o[d+2+64]=o[d+0+96]=o[d+1+96]=o[d+2+96]=o[d+3+96]=E}function vo(o,d){var x=o[d-1+0],N=o[d-1+32],C=o[d-1+64],E=o[d-1+96],O=o[d-1-32],T=o[d+0-32],M=o[d+1-32],U=o[d+2-32];o[d+0+0]=o[d+2+32]=x+O+1>>1,o[d+0+32]=o[d+2+64]=N+x+1>>1,o[d+0+64]=o[d+2+96]=C+N+1>>1,o[d+0+96]=E+C+1>>1,o[d+3+0]=Je(T,M,U),o[d+2+0]=Je(O,T,M),o[d+1+0]=o[d+3+32]=Je(x,O,T),o[d+1+32]=o[d+3+64]=Je(N,x,O),o[d+1+64]=o[d+3+96]=Je(C,N,x),o[d+1+96]=Je(E,C,N)}function yo(o,d){var x;for(x=0;8>x;++x)a(o,d+32*x,o,d-32,8)}function ci(o,d){var x;for(x=0;8>x;++x)s(o,d,o[d-1],8),d+=32}function ea(o,d,x){var N;for(N=0;8>N;++N)s(d,x+32*N,o,8)}function Pn(o,d){var x,N=8;for(x=0;8>x;++x)N+=o[d+x-32]+o[d-1+32*x];ea(N>>4,o,d)}function wo(o,d){var x,N=4;for(x=0;8>x;++x)N+=o[d+x-32];ea(N>>3,o,d)}function ta(o,d){var x,N=4;for(x=0;8>x;++x)N+=o[d-1+32*x];ea(N>>3,o,d)}function di(o,d){ea(128,o,d)}function Aa(o,d,x){var N=o[d-x],C=o[d+0],E=3*(C-N)+Ao[1020+o[d-2*x]-o[d+x]],O=ps[112+(E+4>>3)];o[d-x]=jr[255+N+ps[112+(E+3>>3)]],o[d+0]=jr[255+C-O]}function rs(o,d,x,N){var C=o[d+0],E=o[d+x];return Er[255+o[d-2*x]-o[d-x]]>N||Er[255+E-C]>N}function ns(o,d,x,N){return 4*Er[255+o[d-x]-o[d+0]]+Er[255+o[d-2*x]-o[d+x]]<=N}function as(o,d,x,N,C){var E=o[d-3*x],O=o[d-2*x],T=o[d-x],M=o[d+0],U=o[d+x],ae=o[d+2*x],he=o[d+3*x];return 4*Er[255+T-M]+Er[255+O-U]>N?0:Er[255+o[d-4*x]-E]<=C&&Er[255+E-O]<=C&&Er[255+O-T]<=C&&Er[255+he-ae]<=C&&Er[255+ae-U]<=C&&Er[255+U-M]<=C}function is(o,d,x,N){var C=2*N+1;for(N=0;16>N;++N)ns(o,d+N,x,C)&&Aa(o,d+N,x)}function ln(o,d,x,N){var C=2*N+1;for(N=0;16>N;++N)ns(o,d+N*x,1,C)&&Aa(o,d+N*x,1)}function bn(o,d,x,N){var C;for(C=3;0<C;--C)is(o,d+=4*x,x,N)}function No(o,d,x,N){var C;for(C=3;0<C;--C)ln(o,d+=4,x,N)}function Fn(o,d,x,N,C,E,O,T){for(E=2*E+1;0<C--;){if(as(o,d,x,E,O))if(rs(o,d,x,T))Aa(o,d,x);else{var M=o,U=d,ae=x,he=M[U-2*ae],fe=M[U-ae],le=M[U+0],Ne=M[U+ae],ge=M[U+2*ae],ie=27*(ye=Ao[1020+3*(le-fe)+Ao[1020+he-Ne]])+63>>7,oe=18*ye+63>>7,ye=9*ye+63>>7;M[U-3*ae]=jr[255+M[U-3*ae]+ye],M[U-2*ae]=jr[255+he+oe],M[U-ae]=jr[255+fe+ie],M[U+0]=jr[255+le-ie],M[U+ae]=jr[255+Ne-oe],M[U+2*ae]=jr[255+ge-ye]}d+=N}}function Vr(o,d,x,N,C,E,O,T){for(E=2*E+1;0<C--;){if(as(o,d,x,E,O))if(rs(o,d,x,T))Aa(o,d,x);else{var M=o,U=d,ae=x,he=M[U-ae],fe=M[U+0],le=M[U+ae],Ne=ps[112+((ge=3*(fe-he))+4>>3)],ge=ps[112+(ge+3>>3)],ie=Ne+1>>1;M[U-2*ae]=jr[255+M[U-2*ae]+ie],M[U-ae]=jr[255+he+ge],M[U+0]=jr[255+fe-Ne],M[U+ae]=jr[255+le-ie]}d+=N}}function ui(o,d,x,N,C,E){Fn(o,d,x,1,16,N,C,E)}function ra(o,d,x,N,C,E){Fn(o,d,1,x,16,N,C,E)}function jo(o,d,x,N,C,E){var O;for(O=3;0<O;--O)Vr(o,d+=4*x,x,1,16,N,C,E)}function ka(o,d,x,N,C,E){var O;for(O=3;0<O;--O)Vr(o,d+=4,1,x,16,N,C,E)}function _o(o,d,x,N,C,E,O,T){Fn(o,d,C,1,8,E,O,T),Fn(x,N,C,1,8,E,O,T)}function hi(o,d,x,N,C,E,O,T){Fn(o,d,1,C,8,E,O,T),Fn(x,N,1,C,8,E,O,T)}function fi(o,d,x,N,C,E,O,T){Vr(o,d+4*C,C,1,8,E,O,T),Vr(x,N+4*C,C,1,8,E,O,T)}function ss(o,d,x,N,C,E,O,T){Vr(o,d+4,1,C,8,E,O,T),Vr(x,N+4,1,C,8,E,O,T)}function Ca(){this.ba=new Mr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Pt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function pi(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function mi(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function os(){this.ua=0,this.Wa=new Z,this.vb=new Z,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new S,this.yc=new h}function So(){this.xb=this.a=0,this.l=new Na,this.ca=new Mr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new os,this.ab=0,this.gc=l(4,mi),this.Oc=0}function Pa(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Na,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function na(o,d,x,N,C,E,O){for(o=o==null?0:o[d+0],d=0;d<O;++d)C[E+d]=o+x[N+d]&255,o=C[E+d]}function gi(o,d,x,N,C,E,O){var T;if(o==null)na(null,null,x,N,C,E,O);else for(T=0;T<O;++T)C[E+T]=o[d+T]+x[N+T]&255}function Dn(o,d,x,N,C,E,O){if(o==null)na(null,null,x,N,C,E,O);else{var T,M=o[d+0],U=M,ae=M;for(T=0;T<O;++T)U=ae+(M=o[d+T])-U,ae=x[N+T]+(-256&U?0>U?0:255:U)&255,U=M,C[E+T]=ae}}function xi(o,d,x,N){var C=d.width,E=d.o;if(e(o!=null&&d!=null),0>x||0>=N||x+N>E)return null;if(!o.Cc){if(o.ga==null){var O;if(o.ga=new Pa,(O=o.ga==null)||(O=d.width*d.o,e(o.Gb.length==0),o.Gb=i(O),o.Uc=0,o.Gb==null?O=0:(o.mb=o.Gb,o.nb=o.Uc,o.rc=null,O=1),O=!O),!O){O=o.ga;var T=o.Fa,M=o.P,U=o.qc,ae=o.mb,he=o.nb,fe=M+1,le=U-1,Ne=O.l;if(e(T!=null&&ae!=null&&d!=null),Mn[0]=null,Mn[1]=na,Mn[2]=gi,Mn[3]=Dn,O.ca=ae,O.tb=he,O.c=d.width,O.i=d.height,e(0<O.c&&0<O.i),1>=U)d=0;else if(O.$a=T[M+0]>>0&3,O.Z=T[M+0]>>2&3,O.Lc=T[M+0]>>4&3,M=T[M+0]>>6&3,0>O.$a||1<O.$a||4<=O.Z||1<O.Lc||M)d=0;else if(Ne.put=tn,Ne.ac=Kt,Ne.bc=rn,Ne.ma=O,Ne.width=d.width,Ne.height=d.height,Ne.Da=d.Da,Ne.v=d.v,Ne.va=d.va,Ne.j=d.j,Ne.o=d.o,O.$a)e:{e(O.$a==1),d=kr();t:for(;;){if(d==null){d=0;break e}if(e(O!=null),O.mc=d,d.c=O.c,d.i=O.i,d.l=O.l,d.l.ma=O,d.l.width=O.c,d.l.height=O.i,d.a=0,R(d.m,T,fe,le),!sn(O.c,O.i,1,d,null)||(d.ab==1&&d.gc[0].hc==3&&gn(d.s)?(O.ic=1,T=d.c*d.i,d.Ta=null,d.Ua=0,d.V=i(T),d.Ba=0,d.V==null?(d.a=1,d=0):d=1):(O.ic=0,d=Qn(d,O.c)),!d))break t;d=1;break e}O.mc=null,d=0}else d=le>=O.c*O.i;O=!d}if(O)return null;o.ga.Lc!=1?o.Ga=0:N=E-x}e(o.ga!=null),e(x+N<=E);e:{if(d=(T=o.ga).c,E=T.l.o,T.$a==0){if(fe=o.rc,le=o.Vc,Ne=o.Fa,M=o.P+1+x*d,U=o.mb,ae=o.nb+x*d,e(M<=o.P+o.qc),T.Z!=0)for(e(Mn[T.Z]!=null),O=0;O<N;++O)Mn[T.Z](fe,le,Ne,M,U,ae,d),fe=U,le=ae,ae+=d,M+=d;else for(O=0;O<N;++O)a(U,ae,Ne,M,d),fe=U,le=ae,ae+=d,M+=d;o.rc=fe,o.Vc=le}else{if(e(T.mc!=null),d=x+N,e((O=T.mc)!=null),e(d<=O.i),O.C>=d)d=1;else if(T.ic||ce(),T.ic){T=O.V,fe=O.Ba,le=O.c;var ge=O.i,ie=(Ne=1,M=O.$/le,U=O.$%le,ae=O.m,he=O.s,O.$),oe=le*ge,ye=le*d,je=he.wc,we=ie<ye?qt(he,U,M):null;e(ie<=oe),e(d<=ge),e(gn(he));t:for(;;){for(;!ae.h&&ie<ye;){if(U&je||(we=qt(he,U,M)),e(we!=null),W(ae),256>(ge=fr(we.G[0],we.H[0],ae)))T[fe+ie]=ge,++ie,++U>=le&&(U=0,++M<=d&&!(M%16)&&zr(O,M));else{if(!(280>ge)){Ne=0;break t}ge=Rr(ge-256,ae);var Me,Pe=fr(we.G[4],we.H[4],ae);if(W(ae),!(ie>=(Pe=nn(le,Pe=Rr(Pe,ae)))&&oe-ie>=ge)){Ne=0;break t}for(Me=0;Me<ge;++Me)T[fe+ie+Me]=T[fe+ie+Me-Pe];for(ie+=ge,U+=ge;U>=le;)U-=le,++M<=d&&!(M%16)&&zr(O,M);ie<ye&&U&je&&(we=qt(he,U,M))}e(ae.h==V(ae))}zr(O,M>d?d:M);break t}!Ne||ae.h&&ie<oe?(Ne=0,O.a=ae.h?5:3):O.$=ie,d=Ne}else d=Ur(O,O.V,O.Ba,O.c,O.i,d,xa);if(!d){N=0;break e}}x+N>=E&&(o.Cc=1),N=1}if(!N)return null;if(o.Cc&&((N=o.ga)!=null&&(N.mc=null),o.ga=null,0<o.Ga))return alert("todo:WebPDequantizeLevels"),null}return o.nb+x*C}function f(o,d,x,N,C,E){for(;0<C--;){var O,T=o,M=d+(x?1:0),U=o,ae=d+(x?0:3);for(O=0;O<N;++O){var he=U[ae+4*O];he!=255&&(he*=32897,T[M+4*O+0]=T[M+4*O+0]*he>>23,T[M+4*O+1]=T[M+4*O+1]*he>>23,T[M+4*O+2]=T[M+4*O+2]*he>>23)}d+=E}}function P(o,d,x,N,C){for(;0<N--;){var E;for(E=0;E<x;++E){var O=o[d+2*E+0],T=15&(U=o[d+2*E+1]),M=4369*T,U=(240&U|U>>4)*M>>16;o[d+2*E+0]=(240&O|O>>4)*M>>16&240|(15&O|O<<4)*M>>16>>4&15,o[d+2*E+1]=240&U|T}d+=C}}function H(o,d,x,N,C,E,O,T){var M,U,ae=255;for(U=0;U<C;++U){for(M=0;M<N;++M){var he=o[d+M];E[O+4*M]=he,ae&=he}d+=x,O+=T}return ae!=255}function te(o,d,x,N,C){var E;for(E=0;E<C;++E)x[N+E]=o[d+E]>>8}function ce(){Dr=f,jt=P,_t=H,Bt=te}function xe(o,d,x){X[o]=function(N,C,E,O,T,M,U,ae,he,fe,le,Ne,ge,ie,oe,ye,je){var we,Me=je-1>>1,Pe=T[M+0]|U[ae+0]<<16,Ve=he[fe+0]|le[Ne+0]<<16;e(N!=null);var Ee=3*Pe+Ve+131074>>2;for(d(N[C+0],255&Ee,Ee>>16,ge,ie),E!=null&&(Ee=3*Ve+Pe+131074>>2,d(E[O+0],255&Ee,Ee>>16,oe,ye)),we=1;we<=Me;++we){var ht=T[M+we]|U[ae+we]<<16,mt=he[fe+we]|le[Ne+we]<<16,dt=Pe+ht+Ve+mt+524296,st=dt+2*(ht+Ve)>>3;Ee=st+Pe>>1,Pe=(dt=dt+2*(Pe+mt)>>3)+ht>>1,d(N[C+2*we-1],255&Ee,Ee>>16,ge,ie+(2*we-1)*x),d(N[C+2*we-0],255&Pe,Pe>>16,ge,ie+(2*we-0)*x),E!=null&&(Ee=dt+Ve>>1,Pe=st+mt>>1,d(E[O+2*we-1],255&Ee,Ee>>16,oe,ye+(2*we-1)*x),d(E[O+2*we+0],255&Pe,Pe>>16,oe,ye+(2*we+0)*x)),Pe=ht,Ve=mt}1&je||(Ee=3*Pe+Ve+131074>>2,d(N[C+je-1],255&Ee,Ee>>16,ge,ie+(je-1)*x),E!=null&&(Ee=3*Ve+Pe+131074>>2,d(E[O+je-1],255&Ee,Ee>>16,oe,ye+(je-1)*x)))}}function _e(){Ir[ms]=Jd,Ir[gs]=Fl,Ir[Ll]=Xd,Ir[xs]=Dl,Ir[bs]=El,Ir[ko]=Il,Ir[Al]=Kd,Ir[Co]=Fl,Ir[Po]=Dl,Ir[vs]=El,Ir[Fo]=Il}function Te(o){return o&~Zd?0>o?0:255:o>>Ol}function Ue(o,d){return Te((19077*o>>8)+(26149*d>>8)-14234)}function tt(o,d,x){return Te((19077*o>>8)-(6419*d>>8)-(13320*x>>8)+8708)}function Ze(o,d){return Te((19077*o>>8)+(33050*d>>8)-17685)}function lt(o,d,x,N,C){N[C+0]=Ue(o,x),N[C+1]=tt(o,d,x),N[C+2]=Ze(o,d)}function kt(o,d,x,N,C){N[C+0]=Ze(o,d),N[C+1]=tt(o,d,x),N[C+2]=Ue(o,x)}function Ft(o,d,x,N,C){var E=tt(o,d,x);d=E<<3&224|Ze(o,d)>>3,N[C+0]=248&Ue(o,x)|E>>5,N[C+1]=d}function zt(o,d,x,N,C){var E=240&Ze(o,d)|15;N[C+0]=240&Ue(o,x)|tt(o,d,x)>>4,N[C+1]=E}function ar(o,d,x,N,C){N[C+0]=255,lt(o,d,x,N,C+1)}function Gt(o,d,x,N,C){kt(o,d,x,N,C),N[C+3]=255}function Hr(o,d,x,N,C){lt(o,d,x,N,C),N[C+3]=255}function Nr(o,d){return 0>o?0:o>d?d:o}function cn(o,d,x){X[o]=function(N,C,E,O,T,M,U,ae,he){for(var fe=ae+(-2&he)*x;ae!=fe;)d(N[C+0],E[O+0],T[M+0],U,ae),d(N[C+1],E[O+0],T[M+0],U,ae+x),C+=2,++O,++M,ae+=2*x;1&he&&d(N[C+0],E[O+0],T[M+0],U,ae)}}function ls(o,d,x){return x==0?o==0?d==0?6:5:d==0?4:0:x}function bi(o,d,x,N,C){switch(o>>>30){case 3:wn(d,x,N,C,0);break;case 2:Ot(d,x,N,C);break;case 1:ur(d,x,N,C)}}function vi(o,d){var x,N,C=d.M,E=d.Nb,O=o.oc,T=o.pc+40,M=o.oc,U=o.pc+584,ae=o.oc,he=o.pc+600;for(x=0;16>x;++x)O[T+32*x-1]=129;for(x=0;8>x;++x)M[U+32*x-1]=129,ae[he+32*x-1]=129;for(0<C?O[T-1-32]=M[U-1-32]=ae[he-1-32]=129:(s(O,T-32-1,127,21),s(M,U-32-1,127,9),s(ae,he-32-1,127,9)),N=0;N<o.za;++N){var fe=d.ya[d.aa+N];if(0<N){for(x=-1;16>x;++x)a(O,T+32*x-4,O,T+32*x+12,4);for(x=-1;8>x;++x)a(M,U+32*x-4,M,U+32*x+4,4),a(ae,he+32*x-4,ae,he+32*x+4,4)}var le=o.Gd,Ne=o.Hd+N,ge=fe.ad,ie=fe.Hc;if(0<C&&(a(O,T-32,le[Ne].y,0,16),a(M,U-32,le[Ne].f,0,8),a(ae,he-32,le[Ne].ea,0,8)),fe.Za){var oe=O,ye=T-32+16;for(0<C&&(N>=o.za-1?s(oe,ye,le[Ne].y[15],4):a(oe,ye,le[Ne+1].y,0,4)),x=0;4>x;x++)oe[ye+128+x]=oe[ye+256+x]=oe[ye+384+x]=oe[ye+0+x];for(x=0;16>x;++x,ie<<=2)oe=O,ye=T+Tl[x],Wr[fe.Ob[x]](oe,ye),bi(ie,ge,16*+x,oe,ye)}else if(oe=ls(N,C,fe.Ob[0]),Tn[oe](O,T),ie!=0)for(x=0;16>x;++x,ie<<=2)bi(ie,ge,16*+x,O,T+Tl[x]);for(x=fe.Gc,oe=ls(N,C,fe.Dd),jn[oe](M,U),jn[oe](ae,he),ie=ge,oe=M,ye=U,255&(fe=x>>0)&&(170&fe?_i(ie,256,oe,ye):Pr(ie,256,oe,ye)),fe=ae,ie=he,255&(x>>=8)&&(170&x?_i(ge,320,fe,ie):Pr(ge,320,fe,ie)),C<o.Ub-1&&(a(le[Ne].y,0,O,T+480,16),a(le[Ne].f,0,M,U+224,8),a(le[Ne].ea,0,ae,he+224,8)),x=8*E*o.B,le=o.sa,Ne=o.ta+16*N+16*E*o.R,ge=o.qa,fe=o.ra+8*N+x,ie=o.Ha,oe=o.Ia+8*N+x,x=0;16>x;++x)a(le,Ne+x*o.R,O,T+32*x,16);for(x=0;8>x;++x)a(ge,fe+x*o.B,M,U+32*x,8),a(ie,oe+x*o.B,ae,he+32*x,8)}}function Fa(o,d,x,N,C,E,O,T,M){var U=[0],ae=[0],he=0,fe=M!=null?M.kd:0,le=M??new pi;if(o==null||12>x)return 7;le.data=o,le.w=d,le.ha=x,d=[d],x=[x],le.gb=[le.gb];e:{var Ne=d,ge=x,ie=le.gb;if(e(o!=null),e(ge!=null),e(ie!=null),ie[0]=0,12<=ge[0]&&!r(o,Ne[0],"RIFF")){if(r(o,Ne[0]+8,"WEBP")){ie=3;break e}var oe=De(o,Ne[0]+4);if(12>oe||4294967286<oe){ie=3;break e}if(fe&&oe>ge[0]-8){ie=7;break e}ie[0]=oe,Ne[0]+=12,ge[0]-=12}ie=0}if(ie!=0)return ie;for(oe=0<le.gb[0],x=x[0];;){e:{var ye=o;ge=d,ie=x;var je=U,we=ae,Me=Ne=[0];if((Ee=he=[he])[0]=0,8>ie[0])ie=7;else{if(!r(ye,ge[0],"VP8X")){if(De(ye,ge[0]+4)!=10){ie=3;break e}if(18>ie[0]){ie=7;break e}var Pe=De(ye,ge[0]+8),Ve=1+ke(ye,ge[0]+12);if(2147483648<=Ve*(ye=1+ke(ye,ge[0]+15))){ie=3;break e}Me!=null&&(Me[0]=Pe),je!=null&&(je[0]=Ve),we!=null&&(we[0]=ye),ge[0]+=18,ie[0]-=18,Ee[0]=1}ie=0}}if(he=he[0],Ne=Ne[0],ie!=0)return ie;if(ge=!!(2&Ne),!oe&&he)return 3;if(E!=null&&(E[0]=!!(16&Ne)),O!=null&&(O[0]=ge),T!=null&&(T[0]=0),O=U[0],Ne=ae[0],he&&ge&&M==null){ie=0;break}if(4>x){ie=7;break}if(oe&&he||!oe&&!he&&!r(o,d[0],"ALPH")){x=[x],le.na=[le.na],le.P=[le.P],le.Sa=[le.Sa];e:{Pe=o,ie=d,oe=x;var Ee=le.gb;je=le.na,we=le.P,Me=le.Sa,Ve=22,e(Pe!=null),e(oe!=null),ye=ie[0];var ht=oe[0];for(e(je!=null),e(Me!=null),je[0]=null,we[0]=null,Me[0]=0;;){if(ie[0]=ye,oe[0]=ht,8>ht){ie=7;break e}var mt=De(Pe,ye+4);if(4294967286<mt){ie=3;break e}var dt=8+mt+1&-2;if(Ve+=dt,0<Ee&&Ve>Ee){ie=3;break e}if(!r(Pe,ye,"VP8 ")||!r(Pe,ye,"VP8L")){ie=0;break e}if(ht[0]<dt){ie=7;break e}r(Pe,ye,"ALPH")||(je[0]=Pe,we[0]=ye+8,Me[0]=mt),ye+=dt,ht-=dt}}if(x=x[0],le.na=le.na[0],le.P=le.P[0],le.Sa=le.Sa[0],ie!=0)break}x=[x],le.Ja=[le.Ja],le.xa=[le.xa];e:if(Ee=o,ie=d,oe=x,je=le.gb[0],we=le.Ja,Me=le.xa,Pe=ie[0],ye=!r(Ee,Pe,"VP8 "),Ve=!r(Ee,Pe,"VP8L"),e(Ee!=null),e(oe!=null),e(we!=null),e(Me!=null),8>oe[0])ie=7;else{if(ye||Ve){if(Ee=De(Ee,Pe+4),12<=je&&Ee>je-12){ie=3;break e}if(fe&&Ee>oe[0]-8){ie=7;break e}we[0]=Ee,ie[0]+=8,oe[0]-=8,Me[0]=Ve}else Me[0]=5<=oe[0]&&Ee[Pe+0]==47&&!(Ee[Pe+4]>>5),we[0]=oe[0];ie=0}if(x=x[0],le.Ja=le.Ja[0],le.xa=le.xa[0],d=d[0],ie!=0)break;if(4294967286<le.Ja)return 3;if(T==null||ge||(T[0]=le.xa?2:1),O=[O],Ne=[Ne],le.xa){if(5>x){ie=7;break}T=O,fe=Ne,ge=E,o==null||5>x?o=0:5<=x&&o[d+0]==47&&!(o[d+4]>>5)?(oe=[0],Ee=[0],je=[0],R(we=new k,o,d,x),He(we,oe,Ee,je)?(T!=null&&(T[0]=oe[0]),fe!=null&&(fe[0]=Ee[0]),ge!=null&&(ge[0]=je[0]),o=1):o=0):o=0}else{if(10>x){ie=7;break}T=Ne,o==null||10>x||!Wi(o,d+3,x-3)?o=0:(fe=o[d+0]|o[d+1]<<8|o[d+2]<<16,ge=16383&(o[d+7]<<8|o[d+6]),o=16383&(o[d+9]<<8|o[d+8]),1&fe||3<(fe>>1&7)||!(fe>>4&1)||fe>>5>=le.Ja||!ge||!o?o=0:(O&&(O[0]=ge),T&&(T[0]=o),o=1))}if(!o||(O=O[0],Ne=Ne[0],he&&(U[0]!=O||ae[0]!=Ne)))return 3;M!=null&&(M[0]=le,M.offset=d-M.w,e(4294967286>d-M.w),e(M.offset==M.ha-x));break}return ie==0||ie==7&&he&&M==null?(E!=null&&(E[0]|=le.na!=null&&0<le.na.length),N!=null&&(N[0]=O),C!=null&&(C[0]=Ne),0):ie}function yi(o,d,x){var N=d.width,C=d.height,E=0,O=0,T=N,M=C;if(d.Da=o!=null&&0<o.Da,d.Da&&(T=o.cd,M=o.bd,E=o.v,O=o.j,11>x||(E&=-2,O&=-2),0>E||0>O||0>=T||0>=M||E+T>N||O+M>C))return 0;if(d.v=E,d.j=O,d.va=E+T,d.o=O+M,d.U=T,d.T=M,d.da=o!=null&&0<o.da,d.da){if(!et(T,M,x=[o.ib],E=[o.hb]))return 0;d.ib=x[0],d.hb=E[0]}return d.ob=o!=null&&o.ob,d.Kb=o==null||!o.Sd,d.da&&(d.ob=d.ib<3*N/4&&d.hb<3*C/4,d.Kb=0),1}function wi(o){if(o==null)return 2;if(11>o.S){var d=o.f.RGBA;d.fb+=(o.height-1)*d.A,d.A=-d.A}else d=o.f.kb,o=o.height,d.O+=(o-1)*d.fa,d.fa=-d.fa,d.N+=(o-1>>1)*d.Ab,d.Ab=-d.Ab,d.W+=(o-1>>1)*d.Db,d.Db=-d.Db,d.F!=null&&(d.J+=(o-1)*d.lb,d.lb=-d.lb);return 0}function Da(o,d,x,N){if(N==null||0>=o||0>=d)return 2;if(x!=null){if(x.Da){var C=x.cd,E=x.bd,O=-2&x.v,T=-2&x.j;if(0>O||0>T||0>=C||0>=E||O+C>o||T+E>d)return 2;o=C,d=E}if(x.da){if(!et(o,d,C=[x.ib],E=[x.hb]))return 2;o=C[0],d=E[0]}}N.width=o,N.height=d;e:{var M=N.width,U=N.height;if(o=N.S,0>=M||0>=U||!(o>=ms&&13>o))o=2;else{if(0>=N.Rd&&N.sd==null){O=E=C=d=0;var ae=(T=M*Ml[o])*U;if(11>o||(E=(U+1)/2*(d=(M+1)/2),o==12&&(O=(C=M)*U)),(U=i(ae+2*E+O))==null){o=1;break e}N.sd=U,11>o?((M=N.f.RGBA).eb=U,M.fb=0,M.A=T,M.size=ae):((M=N.f.kb).y=U,M.O=0,M.fa=T,M.Fd=ae,M.f=U,M.N=0+ae,M.Ab=d,M.Cd=E,M.ea=U,M.W=0+ae+E,M.Db=d,M.Ed=E,o==12&&(M.F=U,M.J=0+ae+2*E),M.Tc=O,M.lb=C)}if(d=1,C=N.S,E=N.width,O=N.height,C>=ms&&13>C)if(11>C)o=N.f.RGBA,d&=(T=Math.abs(o.A))*(O-1)+E<=o.size,d&=T>=E*Ml[C],d&=o.eb!=null;else{o=N.f.kb,T=(E+1)/2,ae=(O+1)/2,M=Math.abs(o.fa),U=Math.abs(o.Ab);var he=Math.abs(o.Db),fe=Math.abs(o.lb),le=fe*(O-1)+E;d&=M*(O-1)+E<=o.Fd,d&=U*(ae-1)+T<=o.Cd,d=(d&=he*(ae-1)+T<=o.Ed)&M>=E&U>=T&he>=T,d&=o.y!=null,d&=o.f!=null,d&=o.ea!=null,C==12&&(d&=fe>=E,d&=le<=o.Tc,d&=o.F!=null)}else d=0;o=d?0:2}}return o!=0||x!=null&&x.fd&&(o=wi(N)),o}var Zt=64,Ea=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ia=24,Oa=32,Ni=8,mr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ce("Predictor0","PredictorAdd0"),X.Predictor0=function(){return 4278190080},X.Predictor1=function(o){return o},X.Predictor2=function(o,d,x){return d[x+0]},X.Predictor3=function(o,d,x){return d[x+1]},X.Predictor4=function(o,d,x){return d[x-1]},X.Predictor5=function(o,d,x){return Ie(Ie(o,d[x+1]),d[x+0])},X.Predictor6=function(o,d,x){return Ie(o,d[x-1])},X.Predictor7=function(o,d,x){return Ie(o,d[x+0])},X.Predictor8=function(o,d,x){return Ie(d[x-1],d[x+0])},X.Predictor9=function(o,d,x){return Ie(d[x+0],d[x+1])},X.Predictor10=function(o,d,x){return Ie(Ie(o,d[x-1]),Ie(d[x+0],d[x+1]))},X.Predictor11=function(o,d,x){var N=d[x+0];return 0>=nt(N>>24&255,o>>24&255,(d=d[x-1])>>24&255)+nt(N>>16&255,o>>16&255,d>>16&255)+nt(N>>8&255,o>>8&255,d>>8&255)+nt(255&N,255&o,255&d)?N:o},X.Predictor12=function(o,d,x){var N=d[x+0];return(ze((o>>24&255)+(N>>24&255)-((d=d[x-1])>>24&255))<<24|ze((o>>16&255)+(N>>16&255)-(d>>16&255))<<16|ze((o>>8&255)+(N>>8&255)-(d>>8&255))<<8|ze((255&o)+(255&N)-(255&d)))>>>0},X.Predictor13=function(o,d,x){var N=d[x-1];return(Xe((o=Ie(o,d[x+0]))>>24&255,N>>24&255)<<24|Xe(o>>16&255,N>>16&255)<<16|Xe(o>>8&255,N>>8&255)<<8|Xe(o>>0&255,N>>0&255))>>>0};var Lo=X.PredictorAdd0;X.PredictorAdd1=at,Ce("Predictor2","PredictorAdd2"),Ce("Predictor3","PredictorAdd3"),Ce("Predictor4","PredictorAdd4"),Ce("Predictor5","PredictorAdd5"),Ce("Predictor6","PredictorAdd6"),Ce("Predictor7","PredictorAdd7"),Ce("Predictor8","PredictorAdd8"),Ce("Predictor9","PredictorAdd9"),Ce("Predictor10","PredictorAdd10"),Ce("Predictor11","PredictorAdd11"),Ce("Predictor12","PredictorAdd12"),Ce("Predictor13","PredictorAdd13");var ji=X.PredictorAdd2;it("ColorIndexInverseTransform","MapARGB","32b",function(o){return o>>8&255},function(o){return o}),it("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(o){return o},function(o){return o>>8&255});var cs,Cr=X.ColorIndexInverseTransform,Ba=X.MapARGB,ds=X.VP8LColorIndexInverseTransformAlpha,us=X.MapAlpha,En=X.VP8LPredictorsAdd=[];En.length=16,(X.VP8LPredictors=[]).length=16,(X.VP8LPredictorsAdd_C=[]).length=16,(X.VP8LPredictors_C=[]).length=16;var aa,gr,dr,In,vn,yn,Ta,wn,Ot,_i,ur,Pr,Ma,hs,Si,ia,sa,On,oa,Ra,la,Bn,Li,Fr,Dr,jt,_t,Bt,Wt=i(511),Nn=i(2041),Ai=i(225),qa=i(767),fs=0,Ao=Nn,ps=Ai,jr=qa,Er=Wt,ms=0,gs=1,Ll=2,xs=3,bs=4,ko=5,Al=6,Co=7,Po=8,vs=9,Fo=10,Od=[2,3,7],Bd=[3,3,11],kl=[280,256,256,256,40],Td=[0,1,1,1,0],Md=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Rd=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],qd=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],zd=8,Do=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Eo=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ki=null,Ud=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],$d=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Cl=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Vd=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Hd=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Wd=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Gd=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Tn=[],Wr=[],jn=[],Yd=1,Pl=2,Mn=[],Ir=[];xe("UpsampleRgbLinePair",lt,3),xe("UpsampleBgrLinePair",kt,3),xe("UpsampleRgbaLinePair",Hr,4),xe("UpsampleBgraLinePair",Gt,4),xe("UpsampleArgbLinePair",ar,4),xe("UpsampleRgba4444LinePair",zt,2),xe("UpsampleRgb565LinePair",Ft,2);var Jd=X.UpsampleRgbLinePair,Xd=X.UpsampleBgrLinePair,Fl=X.UpsampleRgbaLinePair,Dl=X.UpsampleBgraLinePair,El=X.UpsampleArgbLinePair,Il=X.UpsampleRgba4444LinePair,Kd=X.UpsampleRgb565LinePair,ys=16,ws=1<<ys-1,Ci=-227,Io=482,Ol=6,Zd=(256<<Ol)-1,Bl=0,Qd=i(256),eu=i(256),tu=i(256),ru=i(256),nu=i(Io-Ci),au=i(Io-Ci);cn("YuvToRgbRow",lt,3),cn("YuvToBgrRow",kt,3),cn("YuvToRgbaRow",Hr,4),cn("YuvToBgraRow",Gt,4),cn("YuvToArgbRow",ar,4),cn("YuvToRgba4444Row",zt,2),cn("YuvToRgb565Row",Ft,2);var Tl=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ns=[0,2,8],iu=[8,7,6,4,4,2,2,2,1,1,1,1],su=1;this.WebPDecodeRGBA=function(o,d,x,N,C){var E=gs,O=new Ca,T=new Mr;O.ba=T,T.S=E,T.width=[T.width],T.height=[T.height];var M=T.width,U=T.height,ae=new mn;if(ae==null||o==null)var he=2;else e(ae!=null),he=Fa(o,d,x,ae.width,ae.height,ae.Pd,ae.Qd,ae.format,null);if(he!=0?M=0:(M!=null&&(M[0]=ae.width[0]),U!=null&&(U[0]=ae.height[0]),M=1),M){T.width=T.width[0],T.height=T.height[0],N!=null&&(N[0]=T.width),C!=null&&(C[0]=T.height);e:{if(N=new Na,(C=new pi).data=o,C.w=d,C.ha=x,C.kd=1,d=[0],e(C!=null),((o=Fa(C.data,C.w,C.ha,null,null,null,d,null,C))==0||o==7)&&d[0]&&(o=4),(d=o)==0){if(e(O!=null),N.data=C.data,N.w=C.w+C.offset,N.ha=C.ha-C.offset,N.put=tn,N.ac=Kt,N.bc=rn,N.ma=O,C.xa){if((o=kr())==null){O=1;break e}if(function(fe,le){var Ne=[0],ge=[0],ie=[0];t:for(;;){if(fe==null)return 0;if(le==null)return fe.a=2,0;if(fe.l=le,fe.a=0,R(fe.m,le.data,le.w,le.ha),!He(fe.m,Ne,ge,ie)){fe.a=3;break t}if(fe.xb=Pl,le.width=Ne[0],le.height=ge[0],!sn(Ne[0],ge[0],1,fe,null))break t;return 1}return e(fe.a!=0),0}(o,N)){if(N=(d=Da(N.width,N.height,O.Oa,O.ba))==0){t:{N=o;r:for(;;){if(N==null){N=0;break t}if(e(N.s.yc!=null),e(N.s.Ya!=null),e(0<N.s.Wb),e((x=N.l)!=null),e((C=x.ma)!=null),N.xb!=0){if(N.ca=C.ba,N.tb=C.tb,e(N.ca!=null),!yi(C.Oa,x,xs)){N.a=2;break r}if(!Qn(N,x.width)||x.da)break r;if((x.da||ft(N.ca.S))&&ce(),11>N.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),N.ca.f.kb.F!=null&&ce()),N.Pb&&0<N.s.ua&&N.s.vb.X==null&&!We(N.s.vb,N.s.Wa.Xa)){N.a=1;break r}N.xb=0}if(!Ur(N,N.V,N.Ba,N.c,N.i,x.o,ga))break r;C.Dc=N.Ma,N=1;break t}e(N.a!=0),N=0}N=!N}N&&(d=o.a)}else d=o.a}else{if((o=new so)==null){O=1;break e}if(o.Fa=C.na,o.P=C.P,o.qc=C.Sa,Gi(o,N)){if((d=Da(N.width,N.height,O.Oa,O.ba))==0){if(o.Aa=0,x=O.Oa,e((C=o)!=null),x!=null){if(0<(M=0>(M=x.Md)?0:100<M?255:255*M/100)){for(U=ae=0;4>U;++U)12>(he=C.pb[U]).lc&&(he.ia=M*iu[0>he.lc?0:he.lc]>>3),ae|=he.ia;ae&&(alert("todo:VP8InitRandom"),C.ia=1)}C.Ga=x.Id,100<C.Ga?C.Ga=100:0>C.Ga&&(C.Ga=0)}oo(o,N)||(d=o.a)}}else d=o.a}d==0&&O.Oa!=null&&O.Oa.fd&&(d=wi(O.ba))}O=d}E=O!=0?null:11>E?T.f.RGBA.eb:T.f.kb.y}else E=null;return E};var Ml=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(X,se){for(var Y="",I=0;I<4;I++)Y+=String.fromCharCode(X[se++]);return Y}function b(X,se){return(X[se+0]<<0|X[se+1]<<8|X[se+2]<<16)>>>0}function w(X,se){return(X[se+0]<<0|X[se+1]<<8|X[se+2]<<16|X[se+3]<<24)>>>0}new c;var y=[0],p=[0],_=[],j=new c,B=n,v=function(X,se){var Y={},I=0,h=!1,g=0,S=0;if(Y.frames=[],!function(z,V,ee,W){for(var ne=0;ne<W;ne++)if(z[V+ne]!=ee.charCodeAt(ne))return!0;return!1}(X,se,"RIFF",4)){for(w(X,se+=4),se+=8;se<X.length;){var D=m(X,se),F=w(X,se+=4);se+=4;var A=F+(1&F);switch(D){case"VP8 ":case"VP8L":Y.frames[I]===void 0&&(Y.frames[I]={}),(re=Y.frames[I]).src_off=h?S:se-8,re.src_size=g+F+8,I++,h&&(h=!1,g=0,S=0);break;case"VP8X":(re=Y.header={}).feature_flags=X[se];var R=se+4;re.canvas_width=1+b(X,R),R+=3,re.canvas_height=1+b(X,R),R+=3;break;case"ALPH":h=!0,g=A+8,S=se-8;break;case"ANIM":(re=Y.header).bgcolor=w(X,se),R=se+4,re.loop_count=(ve=X)[(k=R)+0]<<0|ve[k+1]<<8,R+=2;break;case"ANMF":var J,re;(re=Y.frames[I]={}).offset_x=2*b(X,se),se+=3,re.offset_y=2*b(X,se),se+=3,re.width=1+b(X,se),se+=3,re.height=1+b(X,se),se+=3,re.duration=b(X,se),se+=3,J=X[se++],re.dispose=1&J,re.blend=J>>1&1}D!="ANMF"&&(se+=A)}var ve,k;return Y}}(B,0);v.response=B,v.rgbaoutput=!0,v.dataurl=!1;var L=v.header?v.header:null,q=v.frames?v.frames:null;if(L){L.loop_counter=L.loop_count,y=[L.canvas_height],p=[L.canvas_width];for(var G=0;G<q.length&&q[G].blend!=0;G++);}var K=q[0],$=j.WebPDecodeRGBA(B,K.src_off,K.src_size,p,y);K.rgba=$,K.imgwidth=p[0],K.imgheight=y[0];for(var Q=0;Q<p[0]*y[0]*4;Q++)_[Q]=$[Q];return this.width=p,this.height=y,this.data=_,this}(function(n){var e=function(){return typeof cl=="function"},r=function(y,p,_,j){var B=4,v=l;switch(j){case n.image_compression.FAST:B=1,v=i;break;case n.image_compression.MEDIUM:B=6,v=u;break;case n.image_compression.SLOW:B=9,v=c}y=a(y,p,_,v);var L=cl(y,{level:B});return n.__addimage__.arrayBufferToBinaryString(L)},a=function(y,p,_,j){for(var B,v,L,q=y.length/p,G=new Uint8Array(y.length+q),K=b(),$=0;$<q;$+=1){if(L=$*p,B=y.subarray(L,L+p),j)G.set(j(B,_,v),L+$);else{for(var Q,X=K.length,se=[];Q<X;Q+=1)se[Q]=K[Q](B,_,v);var Y=w(se.concat());G.set(se[Y],L+$)}v=B}return G},s=function(y){var p=Array.apply([],y);return p.unshift(0),p},i=function(y,p){var _,j=[],B=y.length;j[0]=1;for(var v=0;v<B;v+=1)_=y[v-p]||0,j[v+1]=y[v]-_+256&255;return j},l=function(y,p,_){var j,B=[],v=y.length;B[0]=2;for(var L=0;L<v;L+=1)j=_&&_[L]||0,B[L+1]=y[L]-j+256&255;return B},u=function(y,p,_){var j,B,v=[],L=y.length;v[0]=3;for(var q=0;q<L;q+=1)j=y[q-p]||0,B=_&&_[q]||0,v[q+1]=y[q]+256-(j+B>>>1)&255;return v},c=function(y,p,_){var j,B,v,L,q=[],G=y.length;q[0]=4;for(var K=0;K<G;K+=1)j=y[K-p]||0,B=_&&_[K]||0,v=_&&_[K-p]||0,L=m(j,B,v),q[K+1]=y[K]-L+256&255;return q},m=function(y,p,_){if(y===p&&p===_)return y;var j=Math.abs(p-_),B=Math.abs(y-_),v=Math.abs(y+p-_-_);return j<=B&&j<=v?y:B<=v?p:_},b=function(){return[s,i,l,u,c]},w=function(y){var p=y.map(function(_){return _.reduce(function(j,B){return j+Math.abs(B)},0)});return p.indexOf(Math.min.apply(null,p))};n.processPNG=function(y,p,_,j){var B,v,L,q,G,K,$,Q,X,se,Y,I,h,g,S,D=this.decode.FLATE_DECODE,F="";if(this.__addimage__.isArrayBuffer(y)&&(y=new Uint8Array(y)),this.__addimage__.isArrayBufferView(y)){if(y=(L=new Ah(y)).imgData,v=L.bits,B=L.colorSpace,G=L.colors,[4,6].indexOf(L.colorType)!==-1){if(L.bits===8){X=(Q=L.pixelBitlength==32?new Uint32Array(L.decodePixels().buffer):L.pixelBitlength==16?new Uint16Array(L.decodePixels().buffer):new Uint8Array(L.decodePixels().buffer)).length,Y=new Uint8Array(X*L.colors),se=new Uint8Array(X);var A,R=L.pixelBitlength-L.bits;for(g=0,S=0;g<X;g++){for(h=Q[g],A=0;A<R;)Y[S++]=h>>>A&255,A+=L.bits;se[g]=h>>>A&255}}if(L.bits===16){X=(Q=new Uint32Array(L.decodePixels().buffer)).length,Y=new Uint8Array(X*(32/L.pixelBitlength)*L.colors),se=new Uint8Array(X*(32/L.pixelBitlength)),I=L.colors>1,g=0,S=0;for(var J=0;g<X;)h=Q[g++],Y[S++]=h>>>0&255,I&&(Y[S++]=h>>>16&255,h=Q[g++],Y[S++]=h>>>0&255),se[J++]=h>>>16&255;v=8}j!==n.image_compression.NONE&&e()?(y=r(Y,L.width*L.colors,L.colors,j),$=r(se,L.width,1,j)):(y=Y,$=se,D=void 0)}if(L.colorType===3&&(B=this.color_spaces.INDEXED,K=L.palette,L.transparency.indexed)){var re=L.transparency.indexed,ve=0;for(g=0,X=re.length;g<X;++g)ve+=re[g];if((ve/=255)===X-1&&re.indexOf(0)!==-1)q=[re.indexOf(0)];else if(ve!==X){for(Q=L.decodePixels(),se=new Uint8Array(Q.length),g=0,X=Q.length;g<X;g++)se[g]=re[Q[g]];$=r(se,L.width,1)}}var k=function(z){var V;switch(z){case n.image_compression.FAST:V=11;break;case n.image_compression.MEDIUM:V=13;break;case n.image_compression.SLOW:V=14;break;default:V=12}return V}(j);return D===this.decode.FLATE_DECODE&&(F="/Predictor "+k+" "),F+="/Colors "+G+" /BitsPerComponent "+v+" /Columns "+L.width,(this.__addimage__.isArrayBuffer(y)||this.__addimage__.isArrayBufferView(y))&&(y=this.__addimage__.arrayBufferToBinaryString(y)),($&&this.__addimage__.isArrayBuffer($)||this.__addimage__.isArrayBufferView($))&&($=this.__addimage__.arrayBufferToBinaryString($)),{alias:_,data:y,index:p,filter:D,decodeParameters:F,transparency:q,palette:K,sMask:$,predictor:k,width:L.width,height:L.height,bitsPerComponent:v,colorSpace:B}}}})($e.API),function(n){n.processGIF89A=function(e,r,a,s){var i=new kh(e),l=i.width,u=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var m={data:c,width:l,height:u},b=new Zo(100).encode(m,100);return n.processJPEG.call(this,b,r,a,s)},n.processGIF87A=n.processGIF89A}($e.API),Jr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Jr.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(r){Nt.log("bit decode error:"+r)}},Jr.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),r=e%4;for(n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*s*4,u=0;u<8&&8*s+u<this.width;u++){var c=this.palette[i>>7-u&1];this.data[l+4*u]=c.blue,this.data[l+4*u+1]=c.green,this.data[l+4*u+2]=c.red,this.data[l+4*u+3]=255}r!==0&&(this.pos+=4-r)}},Jr.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<n;s++){var i=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*s*4,u=i>>4,c=15&i,m=this.palette[u];if(this.data[l]=m.blue,this.data[l+1]=m.green,this.data[l+2]=m.red,this.data[l+3]=255,2*s+1>=this.width)break;m=this.palette[c],this.data[l+4]=m.blue,this.data[l+4+1]=m.green,this.data[l+4+2]=m.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},Jr.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(s<this.palette.length){var l=this.palette[s];this.data[i]=l.red,this.data[i+1]=l.green,this.data[i+2]=l.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}n!==0&&(this.pos+=4-n)}},Jr.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&e)/e*255|0,u=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,m=i>>15?255:0,b=a*this.width*4+4*s;this.data[b]=c,this.data[b+1]=u,this.data[b+2]=l,this.data[b+3]=m}this.pos+=n}},Jr.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(l&e)/e*255|0,c=(l>>5&r)/r*255|0,m=(l>>11)/e*255|0,b=s*this.width*4+4*i;this.data[b]=m,this.data[b+1]=c,this.data[b+2]=u,this.data[b+3]=255}this.pos+=n}},Jr.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},Jr.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),u=e*this.width*4+4*r;this.data[u]=i,this.data[u+1]=s,this.data[u+2]=a,this.data[u+3]=l}},Jr.prototype.getData=function(){return this.data},function(n){n.processBMP=function(e,r,a,s){var i=new Jr(e,!1),l=i.width,u=i.height,c={data:i.getData(),width:l,height:u},m=new Zo(100).encode(c,100);return n.processJPEG.call(this,m,r,a,s)}}($e.API),_c.prototype.getData=function(){return this.data},function(n){n.processWEBP=function(e,r,a,s){var i=new _c(e),l=i.width,u=i.height,c={data:i.getData(),width:l,height:u},m=new Zo(100).encode(c,100);return n.processJPEG.call(this,m,r,a,s)}}($e.API),$e.API.processRGBA=function(n,e,r){for(var a=n.data,s=a.length,i=new Uint8Array(s/4*3),l=new Uint8Array(s/4),u=0,c=0,m=0;m<s;m+=4){var b=a[m],w=a[m+1],y=a[m+2],p=a[m+3];i[u++]=b,i[u++]=w,i[u++]=y,l[c++]=p}var _=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:_,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},$e.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wa=$e.API,Bs=Wa.getCharWidthsArray=function(n,e){var r,a,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),u=e.widths?e.widths:s.metadata.Unicode.widths,c=u.fof?u.fof:1,m=e.kerning?e.kerning:s.metadata.Unicode.kerning,b=m.fof?m.fof:1,w=e.doKerning!==!1,y=0,p=n.length,_=0,j=u[0]||c,B=[];for(r=0;r<p;r++)a=n.charCodeAt(r),typeof s.metadata.widthOfString=="function"?B.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a))+l*(1e3/i)||0)/1e3):(y=w&&xt(m[a])==="object"&&!isNaN(parseInt(m[a][_],10))?m[a][_]/b:0,B.push((u[a]||j)/c+y)),_=a;return B},yc=Wa.getStringUnitWidth=function(n,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),a=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Wa.processArabic&&(n=Wa.processArabic(n)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(n,r,s)/r:Bs.apply(this,arguments).reduce(function(i,l){return i+l},0)},wc=function(n,e,r,a){for(var s=[],i=0,l=n.length,u=0;i!==l&&u+e[i]<r;)u+=e[i],i++;s.push(n.slice(0,i));var c=i;for(u=0;i!==l;)u+e[i]>a&&(s.push(n.slice(c,i)),u=0,c=i),u+=e[i],i++;return c!==i&&s.push(n.slice(c,i)),s},Nc=function(n,e,r){r||(r={});var a,s,i,l,u,c,m,b=[],w=[b],y=r.textIndent||0,p=0,_=0,j=n.split(" "),B=Bs.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?j[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),L=[];j.map(function(G){(G=G.split(/\s*\n/)).length>1?L=L.concat(G.map(function(K,$){return($&&K.length?`
`:"")+K})):L.push(G[0])}),j=L,c=yc.apply(this,[v,r])}for(i=0,l=j.length;i<l;i++){var q=0;if(a=j[i],c&&a[0]==`
`&&(a=a.substr(1),q=1),y+p+(_=(s=Bs.apply(this,[a,r])).reduce(function(G,K){return G+K},0))>e||q){if(_>e){for(u=wc.apply(this,[a,s,e-(y+p),e]),b.push(u.shift()),b=[u.pop()];u.length;)w.push([u.shift()]);_=s.slice(a.length-(b[0]?b[0].length:0)).reduce(function(G,K){return G+K},0)}else b=[a];w.push(b),y=_+c,p=B}else b.push(a),y+=p+_,p=B}return m=c?function(G,K){return(K?v:"")+G.join(" ")}:function(G){return G.join(" ")},w.map(m)},Wa.splitTextToSize=function(n,e,r){var a,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(b){if(b.widths&&b.kerning)return{widths:b.widths,kerning:b.kerning};var w=this.internal.getFont(b.fontName,b.fontStyle);return w.metadata.Unicode?{widths:w.metadata.Unicode.widths||{0:1},kerning:w.metadata.Unicode.kerning||{}}:{font:w.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(n)?n:String(n).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var u,c,m=[];for(u=0,c=a.length;u<c;u++)m=m.concat(Nc.apply(this,[a[u],l,i]));return m},function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},a={},s=0;s<e.length;s++)r[e[s]]="0123456789abcdef"[s],a["0123456789abcdef"[s]]=e[s];var i=function(w){return"0x"+parseInt(w,10).toString(16)},l=n.__fontmetrics__.compress=function(w){var y,p,_,j,B=["{"];for(var v in w){if(y=w[v],isNaN(parseInt(v,10))?p="'"+v+"'":(v=parseInt(v,10),p=(p=i(v).slice(2)).slice(0,-1)+a[p.slice(-1)]),typeof y=="number")y<0?(_=i(y).slice(3),j="-"):(_=i(y).slice(2),j=""),_=j+_.slice(0,-1)+a[_.slice(-1)];else{if(xt(y)!=="object")throw new Error("Don't know what to do with value type "+xt(y)+".");_=l(y)}B.push(p+_)}return B.push("}"),B.join("")},u=n.__fontmetrics__.uncompress=function(w){if(typeof w!="string")throw new Error("Invalid argument passed to uncompress.");for(var y,p,_,j,B={},v=1,L=B,q=[],G="",K="",$=w.length-1,Q=1;Q<$;Q+=1)(j=w[Q])=="'"?y?(_=y.join(""),y=void 0):y=[]:y?y.push(j):j=="{"?(q.push([L,_]),L={},_=void 0):j=="}"?((p=q.pop())[0][p[1]]=L,_=void 0,L=p[0]):j=="-"?v=-1:_===void 0?r.hasOwnProperty(j)?(G+=r[j],_=parseInt(G,16)*v,v=1,G=""):G+=j:r.hasOwnProperty(j)?(K+=r[j],L[_]=parseInt(K,16)*v,v=1,_=void 0,K=""):K+=j;return B},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},b={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(w){var y=w.font,p=b.Unicode[y.postScriptName];p&&(y.metadata.Unicode={},y.metadata.Unicode.widths=p.widths,y.metadata.Unicode.kerning=p.kerning);var _=m.Unicode[y.postScriptName];_&&(y.metadata.Unicode.encoding=_,y.encoding=_.codePages[0])}])}($e.API),function(n){var e=function(r){for(var a=r.length,s=new Uint8Array(a),i=0;i<a;i++)s[i]=r.charCodeAt(i);return s};n.API.events.push(["addFont",function(r){var a=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(a=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(l,u){u=/^\x00\x01\x00\x00/.test(u)?e(u):e(Mi(u)),l.metadata=n.API.TTFFont.open(u),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(s,a)}}])}($e),function(n){function e(){return(Ge.canvg?Promise.resolve(Ge.canvg):ri(()=>import("./index.es-DubB-cnQ.js"),__vite__mapDeps([0,1]))).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}$e.API.addSvgAsImage=function(r,a,s,i,l,u,c,m){if(isNaN(a)||isNaN(s))throw Nt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(l))throw Nt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var b=document.createElement("canvas");b.width=i,b.height=l;var w=b.getContext("2d");w.fillStyle="#fff",w.fillRect(0,0,b.width,b.height);var y={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(_){return _.fromString(w,r,y)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(_){return _.render(y)}).then(function(){p.addImage(b.toDataURL("image/jpeg",1),a,s,i,l,c,m)})}}(),$e.API.putTotalPages=function(n){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var s=0;s<this.internal.pages[a].length;s++)this.internal.pages[a][s]=this.internal.pages[a][s].replace(e,r);return this},$e.API.viewerPreferences=function(n,e){var r;n=n||{},e=e||!1;var a,s,i,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(l),c=[],m=0,b=0,w=0;function y(_,j){var B,v=!1;for(B=0;B<_.length;B+=1)_[B]===j&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=u.length;for(w=0;w<p;w+=1)r[u[w]].value=r[u[w]].defaultValue,r[u[w]].explicitSet=!1}if(xt(n)==="object"){for(s in n)if(i=n[s],y(u,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&y(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(m=0;m<i.length;m+=1)if(a=!0,i[m].length===1&&typeof i[m][0]=="number")c.push(String(i[m]-1));else if(i[m].length>1){for(b=0;b<i[m].length;b+=1)typeof i[m][b]!="number"&&(a=!1);a===!0&&c.push([i[m][0]-1,i[m][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var _,j=[];for(_ in r)r[_].explicitSet===!0&&(r[_].type==="name"?j.push("/"+_+" /"+r[_].value):j.push("/"+_+" "+r[_].value));j.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+j.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(n){var e=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),m=i.length+l.length+u.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(s+i+l+u+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(a,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}($e.API),function(n){var e=n.API,r=e.pdfEscape16=function(i,l){for(var u,c=l.metadata.Unicode.widths,m=["","0","00","000","0000"],b=[""],w=0,y=i.length;w<y;++w){if(u=l.metadata.characterToGlyph(i.charCodeAt(w)),l.metadata.glyIdsUsed.push(u),l.metadata.toUnicode[u]=i.charCodeAt(w),c.indexOf(u)==-1&&(c.push(u),c.push([parseInt(l.metadata.widthOfGlyph(u),10)])),u=="0")return b.join("");u=u.toString(16),b.push(m[4-u.length],u)}return b.join("")},a=function(i){var l,u,c,m,b,w,y;for(b=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],w=0,y=(u=Object.keys(i).sort(function(p,_){return p-_})).length;w<y;w++)l=u[w],c.length>=100&&(b+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[l]!==void 0&&i[l]!==null&&typeof i[l].toString=="function"&&(m=("0000"+i[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),c.push("<"+l+"><"+m+">"));return c.length&&(b+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),b+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(l){var u=l.font,c=l.out,m=l.newObject,b=l.putStream;if(u.metadata instanceof n.API.TTFFont&&u.encoding==="Identity-H"){for(var w=u.metadata.Unicode.widths,y=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),p="",_=0;_<y.length;_++)p+=String.fromCharCode(y[_]);var j=m();b({data:p,addLength1:!0,objectId:j}),c("endobj");var B=m();b({data:a(u.metadata.toUnicode),addLength1:!0,objectId:B}),c("endobj");var v=m();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Ya(u.fontName)),c("/FontFile2 "+j+" 0 R"),c("/FontBBox "+n.API.PDFObject.convert(u.metadata.bbox)),c("/Flags "+u.metadata.flags),c("/StemV "+u.metadata.stemV),c("/ItalicAngle "+u.metadata.italicAngle),c("/Ascent "+u.metadata.ascender),c("/Descent "+u.metadata.decender),c("/CapHeight "+u.metadata.capHeight),c(">>"),c("endobj");var L=m();c("<<"),c("/Type /Font"),c("/BaseFont /"+Ya(u.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+n.API.PDFObject.convert(w)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+u.encoding+")"),c(">>"),c(">>"),c("endobj"),u.objectNumber=m(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+B+" 0 R"),c("/BaseFont /"+Ya(u.fontName)),c("/Encoding /"+u.encoding),c("/DescendantFonts ["+L+" 0 R]"),c(">>"),c("endobj"),u.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(l){var u=l.font,c=l.out,m=l.newObject,b=l.putStream;if(u.metadata instanceof n.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var w=u.metadata.rawData,y="",p=0;p<w.length;p++)y+=String.fromCharCode(w[p]);var _=m();b({data:y,addLength1:!0,objectId:_}),c("endobj");var j=m();b({data:a(u.metadata.toUnicode),addLength1:!0,objectId:j}),c("endobj");var B=m();c("<<"),c("/Descent "+u.metadata.decender),c("/CapHeight "+u.metadata.capHeight),c("/StemV "+u.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+_+" 0 R"),c("/Flags 96"),c("/FontBBox "+n.API.PDFObject.convert(u.metadata.bbox)),c("/FontName /"+Ya(u.fontName)),c("/ItalicAngle "+u.metadata.italicAngle),c("/Ascent "+u.metadata.ascender),c(">>"),c("endobj"),u.objectNumber=m();for(var v=0;v<u.metadata.hmtx.widths.length;v++)u.metadata.hmtx.widths[v]=parseInt(u.metadata.hmtx.widths[v]*(1e3/u.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+j+" 0 R/BaseFont/"+Ya(u.fontName)+"/FontDescriptor "+B+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),c("endobj"),u.isAlreadyPutted=!0}})(i)}]);var s=function(i){var l,u=i.text||"",c=i.x,m=i.y,b=i.options||{},w=i.mutex||{},y=w.pdfEscape,p=w.activeFontKey,_=w.fonts,j=p,B="",v=0,L="",q=_[j].encoding;if(_[j].encoding!=="Identity-H")return{text:u,x:c,y:m,options:b,mutex:w};for(L=u,j=p,Array.isArray(u)&&(L=u[0]),v=0;v<L.length;v+=1)_[j].metadata.hasOwnProperty("cmap")&&(l=_[j].metadata.cmap.unicode.codeMap[L[v].charCodeAt(0)]),l||L[v].charCodeAt(0)<256&&_[j].metadata.hasOwnProperty("Unicode")?B+=L[v]:B+="";var G="";return parseInt(j.slice(1))<14||q==="WinAnsiEncoding"?G=y(B,j).split("").map(function(K){return K.charCodeAt(0).toString(16)}).join(""):q==="Identity-H"&&(G=r(B,_[j])),w.isHex=!0,{text:G,x:c,y:m,options:b,mutex:w}};e.events.push(["postProcessText",function(i){var l=i.text||"",u=[],c={text:l,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(l)){var m=0;for(m=0;m<l.length;m+=1)Array.isArray(l[m])&&l[m].length===3?u.push([s(Object.assign({},c,{text:l[m][0]})).text,l[m][1],l[m][2]]):u.push(s(Object.assign({},c,{text:l[m]})).text);i.text=u}else i.text=s(Object.assign({},c,{text:l})).text}])}($e),function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},n.addFileToVFS=function(r,a){return e.call(this),this.internal.vFS[r]=a,this},n.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}($e.API),function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(a){var s,i,l,u,c,m,b,w=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],_={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},j={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},B=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),L=!1,q=0;this.__bidiEngine__={};var G=function(I){var h=I.charCodeAt(),g=h>>8,S=j[g];return S!==void 0?w[256*S+(255&h)]:g===252||g===253?"AL":v.test(g)?"L":g===8?"R":"N"},K=function(I){for(var h,g=0;g<I.length;g++){if((h=G(I.charAt(g)))==="L")return!1;if(h==="R")return!0}return!1},$=function(I,h,g,S){var D,F,A,R,J=h[S];switch(J){case"L":case"R":L=!1;break;case"N":case"AN":break;case"EN":L&&(J="AN");break;case"AL":L=!0,J="R";break;case"WS":J="N";break;case"CS":S<1||S+1>=h.length||(D=g[S-1])!=="EN"&&D!=="AN"||(F=h[S+1])!=="EN"&&F!=="AN"?J="N":L&&(F="AN"),J=F===D?F:"N";break;case"ES":J=(D=S>0?g[S-1]:"B")==="EN"&&S+1<h.length&&h[S+1]==="EN"?"EN":"N";break;case"ET":if(S>0&&g[S-1]==="EN"){J="EN";break}if(L){J="N";break}for(A=S+1,R=h.length;A<R&&h[A]==="ET";)A++;J=A<R&&h[A]==="EN"?"EN":"N";break;case"NSM":if(l&&!u){for(R=h.length,A=S+1;A<R&&h[A]==="NSM";)A++;if(A<R){var re=I[S],ve=re>=1425&&re<=2303||re===64286;if(D=h[A],ve&&(D==="R"||D==="AL")){J="R";break}}}J=S<1||(D=h[S-1])==="B"?"N":g[S-1];break;case"B":L=!1,s=!0,J=q;break;case"S":i=!0,J="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":L=!1;break;case"BN":J="N"}return J},Q=function(I,h,g){var S=I.split("");return g&&X(S,g,{hiLevel:q}),S.reverse(),h&&h.reverse(),S.join("")},X=function(I,h,g){var S,D,F,A,R,J=-1,re=I.length,ve=0,k=[],z=q?p:y,V=[];for(L=!1,s=!1,i=!1,D=0;D<re;D++)V[D]=G(I[D]);for(F=0;F<re;F++){if(R=ve,k[F]=$(I,V,k,F),S=240&(ve=z[R][_[k[F]]]),ve&=15,h[F]=A=z[ve][5],S>0)if(S===16){for(D=J;D<F;D++)h[D]=1;J=-1}else J=-1;if(z[ve][6])J===-1&&(J=F);else if(J>-1){for(D=J;D<F;D++)h[D]=A;J=-1}V[F]==="B"&&(h[F]=0),g.hiLevel|=A}i&&function(ee,W,ne){for(var de=0;de<ne;de++)if(ee[de]==="S"){W[de]=q;for(var ue=de-1;ue>=0&&ee[ue]==="WS";ue--)W[ue]=q}}(V,h,re)},se=function(I,h,g,S,D){if(!(D.hiLevel<I)){if(I===1&&q===1&&!s)return h.reverse(),void(g&&g.reverse());for(var F,A,R,J,re=h.length,ve=0;ve<re;){if(S[ve]>=I){for(R=ve+1;R<re&&S[R]>=I;)R++;for(J=ve,A=R-1;J<A;J++,A--)F=h[J],h[J]=h[A],h[A]=F,g&&(F=g[J],g[J]=g[A],g[A]=F);ve=R}ve++}}},Y=function(I,h,g){var S=I.split(""),D={hiLevel:q};return g||(g=[]),X(S,g,D),function(F,A,R){if(R.hiLevel!==0&&b)for(var J,re=0;re<F.length;re++)A[re]===1&&(J=B.indexOf(F[re]))>=0&&(F[re]=B[J+1])}(S,g,D),se(2,S,h,g,D),se(1,S,h,g,D),S.join("")};return this.__bidiEngine__.doBidiReorder=function(I,h,g){if(function(D,F){if(F)for(var A=0;A<D.length;A++)F[A]=A;u===void 0&&(u=K(D)),m===void 0&&(m=K(D))}(I,h),l||!c||m)if(l&&c&&u^m)q=u?1:0,I=Q(I,h,g);else if(!l&&c&&m)q=u?1:0,I=Y(I,h,g),I=Q(I,h);else if(!l||u||c||m){if(l&&!c&&u^m)I=Q(I,h),u?(q=0,I=Y(I,h,g)):(q=1,I=Y(I,h,g),I=Q(I,h));else if(l&&u&&!c&&m)q=1,I=Y(I,h,g),I=Q(I,h);else if(!l&&!c&&u^m){var S=b;u?(q=1,I=Y(I,h,g),q=0,b=!1,I=Y(I,h,g),b=S):(q=0,I=Y(I,h,g),I=Q(I,h),q=1,b=!1,I=Y(I,h,g),b=S,I=Q(I,h))}}else q=0,I=Y(I,h,g);else q=u?1:0,I=Y(I,h,g);return I},this.__bidiEngine__.setOptions=function(I){I&&(l=I.isInputVisual,c=I.isOutputVisual,u=I.isInputRtl,m=I.isOutputRtl,b=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(a){var s=a.text;a.x,a.y;var i=a.options||{};a.mutex,i.lang;var l=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var u=0;for(l=[],u=0;u<s.length;u+=1)Object.prototype.toString.call(s[u])==="[object Array]"?l.push([r.doBidiReorder(s[u][0]),s[u][1],s[u][2]]):l.push([r.doBidiReorder(s[u])]);a.text=l}else a.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}($e),$e.API.TTFFont=function(){function n(e){var r;if(this.rawData=e,r=this.contents=new Xn(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new $h(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new Ch(this.contents),this.head=new Fh(this),this.name=new Bh(this),this.cmap=new hd(this),this.toUnicode={},this.hhea=new Dh(this),this.maxp=new Th(this),this.hmtx=new Mh(this),this.post=new Ih(this),this.os2=new Eh(this),this.loca=new Uh(this),this.glyf=new Rh(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,r,a,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,u,c,m;for(m=[],l=0,u=(c=this.bbox).length;l<u;l++)e=c[l],m.push(Math.round(e*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(a=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},n.prototype.widthOfString=function(e,r,a){var s,i,l,u;for(l=0,i=0,u=(e=""+e).length;0<=u?i<u:i>u;i=0<=u?++i:--i)s=e.charCodeAt(i),l+=this.widthOfGlyph(this.characterToGlyph(s))+a*(1e3/r)||0;return l*(r/1e3)},n.prototype.lineHeight=function(e,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},n}();var Qr,Xn=function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var r,a;for(a=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},n.prototype.writeString=function(e){var r,a,s;for(s=[],r=0,a=e.length;0<=a?r<a:r>a;r=0<=a?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,r,a,s,i,l,u,c;return e=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),l=this.readByte(),u=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^s)+16777216*(255^i)+65536*(255^l)+256*(255^u)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*a+4294967296*s+16777216*i+65536*l+256*u+c},n.prototype.writeLongLong=function(e){var r,a;return r=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var r,a;for(r=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)r.push(this.readByte());return r},n.prototype.write=function(e){var r,a,s,i;for(i=[],a=0,s=e.length;a<s;a++)r=e[a],i.push(this.writeByte(r));return i},n}(),Ch=function(){var n;function e(r){var a,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return e.prototype.encode=function(r){var a,s,i,l,u,c,m,b,w,y,p,_,j;for(j in p=Object.keys(r).length,c=Math.log(2),w=16*Math.floor(Math.log(p)/c),l=Math.floor(w/c),b=16*p-w,(s=new Xn).writeInt(this.scalarType),s.writeShort(p),s.writeShort(w),s.writeShort(l),s.writeShort(b),i=16*p,m=s.pos+i,u=null,_=[],r)for(y=r[j],s.writeString(j),s.writeInt(n(y)),s.writeInt(m),s.writeInt(y.length),_=_.concat(y),j==="head"&&(u=m),m+=y.length;m%4;)_.push(0),m++;return s.write(_),a=2981146554-n(s.data),s.pos=u+8,s.writeUInt32(a),s.data},n=function(r){var a,s,i,l;for(r=fd.call(r);r.length%4;)r.push(0);for(i=new Xn(r),s=0,a=0,l=r.length;a<l;a=a+=4)s+=i.readUInt32();return 4294967295&s},e}(),Ph={}.hasOwnProperty,pn=function(n,e){for(var r in e)Ph.call(e,r)&&(n[r]=e[r]);function a(){this.constructor=n}return a.prototype=e.prototype,n.prototype=new a,n.__super__=e.prototype,n};Qr=function(){function n(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n}();var Fh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var a;return(a=new Xn).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},e}(),Sc=function(){function n(e,r){var a,s,i,l,u,c,m,b,w,y,p,_,j,B,v,L,q;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),w=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),y=p/2,e.pos+=6,i=function(){var G,K;for(K=[],c=G=0;0<=y?G<y:G>y;c=0<=y?++G:--G)K.push(e.readUInt16());return K}(),e.pos+=2,j=function(){var G,K;for(K=[],c=G=0;0<=y?G<y:G>y;c=0<=y?++G:--G)K.push(e.readUInt16());return K}(),m=function(){var G,K;for(K=[],c=G=0;0<=y?G<y:G>y;c=0<=y?++G:--G)K.push(e.readUInt16());return K}(),b=function(){var G,K;for(K=[],c=G=0;0<=y?G<y:G>y;c=0<=y?++G:--G)K.push(e.readUInt16());return K}(),s=(this.length-e.pos+this.offset)/2,u=function(){var G,K;for(K=[],c=G=0;0<=s?G<s:G>s;c=0<=s?++G:--G)K.push(e.readUInt16());return K}(),c=v=0,q=i.length;v<q;c=++v)for(B=i[c],a=L=_=j[c];_<=B?L<=B:L>=B;a=_<=B?++L:--L)b[c]===0?l=a+m[c]:(l=u[b[c]/2+(a-_)-(y-c)]||0)!==0&&(l+=m[c]),this.codeMap[a]=65535&l}e.pos=w}return n.encode=function(e,r){var a,s,i,l,u,c,m,b,w,y,p,_,j,B,v,L,q,G,K,$,Q,X,se,Y,I,h,g,S,D,F,A,R,J,re,ve,k,z,V,ee,W,ne,de,ue,Le,Se,ke;switch(S=new Xn,l=Object.keys(e).sort(function(De,We){return De-We}),r){case"macroman":for(j=0,B=function(){var De=[];for(_=0;_<256;++_)De.push(0);return De}(),L={0:0},i={},D=0,J=l.length;D<J;D++)L[ue=e[s=l[D]]]==null&&(L[ue]=++j),i[s]={old:e[s],new:L[e[s]]},B[s]=L[e[s]];return S.writeUInt16(1),S.writeUInt16(0),S.writeUInt32(12),S.writeUInt16(0),S.writeUInt16(262),S.writeUInt16(0),S.write(B),{charMap:i,subtable:S.data,maxGlyphID:j+1};case"unicode":for(h=[],w=[],q=0,L={},a={},v=m=null,F=0,re=l.length;F<re;F++)L[K=e[s=l[F]]]==null&&(L[K]=++q),a[s]={old:K,new:L[K]},u=L[K]-s,v!=null&&u===m||(v&&w.push(v),h.push(s),m=u),v=s;for(v&&w.push(v),w.push(65535),h.push(65535),Y=2*(se=h.length),X=2*Math.pow(Math.log(se)/Math.LN2,2),y=Math.log(X/2)/Math.LN2,Q=2*se-X,c=[],$=[],p=[],_=A=0,ve=h.length;A<ve;_=++A){if(I=h[_],b=w[_],I===65535){c.push(0),$.push(0);break}if(I-(g=a[I].new)>=32768)for(c.push(0),$.push(2*(p.length+se-_)),s=R=I;I<=b?R<=b:R>=b;s=I<=b?++R:--R)p.push(a[s].new);else c.push(g-I),$.push(0)}for(S.writeUInt16(3),S.writeUInt16(1),S.writeUInt32(12),S.writeUInt16(4),S.writeUInt16(16+8*se+2*p.length),S.writeUInt16(0),S.writeUInt16(Y),S.writeUInt16(X),S.writeUInt16(y),S.writeUInt16(Q),ne=0,k=w.length;ne<k;ne++)s=w[ne],S.writeUInt16(s);for(S.writeUInt16(0),de=0,z=h.length;de<z;de++)s=h[de],S.writeUInt16(s);for(Le=0,V=c.length;Le<V;Le++)u=c[Le],S.writeUInt16(u);for(Se=0,ee=$.length;Se<ee;Se++)G=$[Se],S.writeUInt16(G);for(ke=0,W=p.length;ke<W;ke++)j=p[ke],S.writeUInt16(j);return{charMap:a,subtable:S.data,maxGlyphID:q+1}}},n}(),hd=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="cmap",e.prototype.parse=function(r){var a,s,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)a=new Sc(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},e.encode=function(r,a){var s,i;return a==null&&(a="macroman"),s=Sc.encode(r,a),(i=new Xn).writeUInt16(0),i.writeUInt16(1),s.table=i.data.concat(s.subtable),s},e}(),Dh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),Eh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var a,s;for(s=[],a=0;a<10;++a)s.push(r.readByte());return s}(),this.charRange=function(){var a,s;for(s=[],a=0;a<4;++a)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var a,s;for(s=[],a=0;a<2;a=++a)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),Ih=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="post",e.prototype.parse=function(r){var a,s,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var l;for(s=r.readUInt16(),this.glyphNameIndex=[],l=0;0<=s?l<s:l>s;l=0<=s?++l:--l)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)a=r.readByte(),i.push(this.names.push(r.readString(a)));return i;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var u,c,m;for(m=[],l=u=0,c=this.file.maxp.numGlyphs;0<=c?u<c:u>c;l=0<=c?++u:--u)m.push(r.readUInt32());return m}).call(this)}},e}(),Oh=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Bh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="name",e.prototype.parse=function(r){var a,s,i,l,u,c,m,b,w,y,p;for(r.pos=this.offset,r.readShort(),a=r.readShort(),c=r.readShort(),s=[],l=0;0<=a?l<a:l>a;l=0<=a?++l:--l)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(m={},l=w=0,y=s.length;w<y;l=++w)i=s[l],r.pos=i.offset,b=r.readString(i.length),u=new Oh(b,i),m[p=i.nameID]==null&&(m[p]=[]),m[i.nameID].push(u);this.strings=m,this.copyright=m[0],this.fontFamily=m[1],this.fontSubfamily=m[2],this.uniqueSubfamily=m[3],this.fontName=m[4],this.version=m[5];try{this.postscriptName=m[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=m[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=m[7],this.manufacturer=m[8],this.designer=m[9],this.description=m[10],this.vendorUrl=m[11],this.designerUrl=m[12],this.license=m[13],this.licenseUrl=m[14],this.preferredFamily=m[15],this.preferredSubfamily=m[17],this.compatibleFull=m[18],this.sampleText=m[19]},e}(),Th=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),Mh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="hmtx",e.prototype.parse=function(r){var a,s,i,l,u,c,m;for(r.pos=this.offset,this.metrics=[],a=0,c=this.file.hhea.numberOfMetrics;0<=c?a<c:a>c;a=0<=c?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var b,w;for(w=[],a=b=0;0<=i?b<i:b>i;a=0<=i?++b:--b)w.push(r.readInt16());return w}(),this.widths=(function(){var b,w,y,p;for(p=[],b=0,w=(y=this.metrics).length;b<w;b++)l=y[b],p.push(l.advance);return p}).call(this),s=this.widths[this.widths.length-1],m=[],a=u=0;0<=i?u<i:u>i;a=0<=i?++u:--u)m.push(this.widths.push(s));return m},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),fd=[].slice,Rh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var a,s,i,l,u,c,m,b,w,y;return r in this.cache?this.cache[r]:(l=this.file.loca,a=this.file.contents,s=l.indexOf(r),(i=l.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+s,u=(c=new Xn(a.read(i))).readShort(),b=c.readShort(),y=c.readShort(),m=c.readShort(),w=c.readShort(),this.cache[r]=u===-1?new zh(c,b,y,m,w):new qh(c,u,b,y,m,w),this.cache[r]))},e.prototype.encode=function(r,a,s){var i,l,u,c,m;for(u=[],l=[],c=0,m=a.length;c<m;c++)i=r[a[c]],l.push(u.length),i&&(u=u.concat(i.encode(s)));return l.push(u.length),{table:u,offsets:l}},e}(),qh=function(){function n(e,r,a,s,i,l){this.raw=e,this.numberOfContours=r,this.xMin=a,this.yMin=s,this.xMax=i,this.yMax=l,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n}(),zh=function(){function n(e,r,a,s,i){var l,u;for(this.raw=e,this.xMin=r,this.yMin=a,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;u=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&u;)l.pos+=1&u?4:2,128&u?l.pos+=8:64&u?l.pos+=4:8&u&&(l.pos+=2)}return n.prototype.encode=function(){var e,r,a;for(r=new Xn(fd.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)r.pos=this.glyphOffsets[e];return r.data},n}(),Uh=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pn(e,Qr),e.prototype.tag="loca",e.prototype.parse=function(r){var a,s;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,l;for(l=[],s=0,i=this.length;s<i;s+=2)l.push(2*r.readUInt16());return l}).call(this):(function(){var i,l;for(l=[],s=0,i=this.length;s<i;s+=4)l.push(r.readUInt32());return l}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,a){for(var s=new Uint32Array(this.offsets.length),i=0,l=0,u=0;u<s.length;++u)if(s[u]=i,l<a.length&&a[l]==u){++l,s[u]=i;var c=this.offsets[u],m=this.offsets[u+1]-c;m>0&&(i+=m)}for(var b=new Array(4*s.length),w=0;w<s.length;++w)b[4*w+3]=255&s[w],b[4*w+2]=(65280&s[w])>>8,b[4*w+1]=(16711680&s[w])>>16,b[4*w]=(4278190080&s[w])>>24;return b},e}(),$h=function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,r,a,s,i;for(r in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)a=i[r],e[r]=s[a];return e},n.prototype.glyphsFor=function(e){var r,a,s,i,l,u,c;for(s={},l=0,u=e.length;l<u;l++)s[i=e[l]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(a=s[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))a=c[i],s[i]=a;return s},n.prototype.encode=function(e,r){var a,s,i,l,u,c,m,b,w,y,p,_,j,B,v;for(s in a=hd.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),p={0:0},v=a.charMap)p[(c=v[s]).old]=c.new;for(_ in y=a.maxGlyphID,l)_ in p||(p[_]=y++);return b=function(L){var q,G;for(q in G={},L)G[L[q]]=q;return G}(p),w=Object.keys(b).sort(function(L,q){return L-q}),j=function(){var L,q,G;for(G=[],L=0,q=w.length;L<q;L++)u=w[L],G.push(b[u]);return G}(),i=this.font.glyf.encode(l,j,p),m=this.font.loca.encode(i.offsets,j),B={cmap:this.font.cmap.raw(),glyf:i.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(B["OS/2"]=this.font.os2.raw()),this.font.directory.encode(B)},n}();$e.API.PDFObject=function(){var n;function e(){}return n=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},e.convert=function(r){var a,s,i,l;if(Array.isArray(r))return"["+function(){var u,c,m;for(m=[],u=0,c=r.length;u<c;u++)a=r[u],m.push(e.convert(a));return m}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+n(r.getUTCFullYear(),4)+n(r.getUTCMonth(),2)+n(r.getUTCDate(),2)+n(r.getUTCHours(),2)+n(r.getUTCMinutes(),2)+n(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)l=r[s],i.push("/"+s+" "+e.convert(l));return i.push(">>"),i.join(`
`)}return""+r},e}();const _l=async n=>{try{if(n.startsWith("data:image/png"))return n;await new Promise((l,u)=>{const c=new Image;c.onload=()=>l(),c.onerror=u,c.src=n});const e=document.createElement("canvas"),r=new Image;r.src=n;const a=r.naturalWidth||256,s=r.naturalHeight||256;e.width=a,e.height=s;const i=e.getContext("2d");return i?(i.drawImage(r,0,0),e.toDataURL("image/png")):n}catch{return n}},er={name:"BHAVISHYA ROAD CARRIERS",address:"Specialist in Heavy ODC, Hydraulic, Low Bed Trailer, Flat Bed Trailer Transport & Commission Agent",address2:"FLEET OWNERS, TRANSPORT CONTRACTORS & COMMISSION AGENTS",address3:"MEMBER OF ALL INDIA MOTOR TRANSPORT CONGRESS",phone:"MOB: 9824026578, 9824900776",pan:"PAN NO: BNDPK7173D",location:"404, Parijaat Business Center, Nr. SP Ring Road, Aslali, Ahmedabad - 382405",tagline:"DIRECT TO AHMEDABAD JURISDICTION"},At=n=>`Rs. ${n.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Ws=n=>new Date(n).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}),pd=async(n,e,r)=>{var B;const a=new $e("p","mm","a4"),s=a.internal.pageSize.getWidth(),i=a.internal.pageSize.getHeight();try{const v=await _l(ni);a.addImage(v,"PNG",15,8,25,25)}catch(v){console.warn("Could not add logo to PDF:",v)}a.setFontSize(16),a.setFont("helvetica","bold"),a.setTextColor(25,118,210),a.text(er.name,s/2,15,{align:"center"}),a.setFontSize(8),a.setFont("helvetica","normal"),a.setTextColor(0,0,0),a.text(er.address,s/2,21,{align:"center"}),a.text(er.address2,s/2,25,{align:"center"}),a.text(er.location,s/2,29,{align:"center"}),a.setFontSize(7),a.text(er.phone,15,37),a.text(er.pan,s-15,37,{align:"right"}),a.text(er.tagline,s/2,41,{align:"center"}),a.setLineWidth(1),a.setDrawColor(0,0,0),a.rect(10,5,s-20,40),a.setFillColor(52,144,220),a.rect(10,50,s-20,12,"F"),a.setFontSize(16),a.setFont("helvetica","bold"),a.setTextColor(255,255,255),a.text("MEMO",s/2,58,{align:"center"}),a.setTextColor(0,0,0),a.setLineWidth(.5),a.setDrawColor(0,0,0),a.setTextColor(0,0,0),a.rect(10,67,s-20,15),a.setFontSize(9),a.setFont("helvetica","normal"),a.text(`Memo No: ${n.memo_number}`,15,72),a.text(`Date: ${Ws(n.date)}`,s-15,72,{align:"right"}),a.text(`Supplier: ${n.supplier}`,15,78),a.text(`Vehicle No: ${e.vehicle_no}`,s-15,78,{align:"right"}),a.setFillColor(52,144,220),a.rect(10,87,s-20,8,"F"),a.setFontSize(11),a.setFont("helvetica","bold"),a.setTextColor(255,255,255),a.text("TRANSPORT DETAILS",15,93),a.setTextColor(0,0,0),a.setLineWidth(.5);const l=100;a.rect(10,l,(s-20)/2,12),a.rect(10+(s-20)/2,l,(s-20)/2,12),a.setFontSize(9),a.setFont("helvetica","bold"),a.text("FROM:",15,l+4),a.text("TO:",15+(s-20)/2,l+4),a.setFont("helvetica","normal"),a.text(e.from_location,15,l+8),a.text(e.to_location,15+(s-20)/2,l+8),a.rect(10,l+12,(s-20)/2,10),a.rect(10+(s-20)/2,l+12,(s-20)/2,10),a.setFont("helvetica","bold"),a.text("MATERIAL:",15,l+17),a.text("WEIGHT:",15+(s-20)/2,l+17),a.setFont("helvetica","normal"),a.text(e.material||"MACHINERY",15,l+21),a.text(`${e.weight} MT`,15+(s-20)/2,l+21),a.setFillColor(52,144,220),a.rect(10,127,s-20,8,"F"),a.setFontSize(11),a.setFont("helvetica","bold"),a.setTextColor(255,255,255),a.text("FINANCIAL BREAKDOWN",15,133),a.setTextColor(0,0,0);const u=140;a.setLineWidth(.5);const c=r?r.filter(v=>(v.category==="memo_advance"||v.category==="memo_payment")&&v.reference_id===n.memo_number).reduce((v,L)=>v+L.amount,0):((B=n.advance_payments)==null?void 0:B.reduce((v,L)=>v+L.amount,0))||0,m=[["Freight Amount:",At(n.freight)],["Add: Detention:",At(n.detention||0)],["Add: Extra Weight:",At(n.extra||0)],["Add: RTO:",At(n.rto||0)],["Less: Commission:",At(n.commission||0)],["Less: Mamool:",At(n.mamool||0)],["Less: Advance Paid:",At(c)]];m.forEach((v,L)=>{const q=u+L*7;a.rect(10,q,s-20,7),a.setFontSize(9),a.setFont("helvetica","normal"),a.text(v[0],15,q+5),a.text(v[1],s-15,q+5,{align:"right"})});const b=u+m.length*7;a.setFillColor(52,144,220),a.rect(10,b,s-20,8,"F"),a.setFontSize(10),a.setFont("helvetica","bold"),a.setTextColor(255,255,255),a.text("NET AMOUNT PAYABLE:",15,b+5);const w=n.net_amount-c;a.text(At(w),s-15,b+5,{align:"right"}),a.setTextColor(0,0,0);const y=b+15;a.setFillColor(25,118,210),a.rect(10,y-5,s-20,8,"F"),a.setFontSize(10),a.setFont("helvetica","bold"),a.setTextColor(255,255,255),a.text("ADVANCE DETAILS",15,y),a.setTextColor(0,0,0);let p=y;n.advance_payments&&n.advance_payments.length>0?(a.setFont("helvetica","normal"),a.setFontSize(8),n.advance_payments.forEach((v,L)=>{var q;p+=6,a.text(`${L+1}. Date: ${Ws(v.date)} - Amount: ${At(v.amount)} - Mode: ${((q=v.mode)==null?void 0:q.toUpperCase())||"CASH"}`,15,p)})):(a.setFontSize(8),a.setFont("helvetica","normal"),a.text("No advance payments recorded",15,y+5));const _=y+25;a.setTextColor(0,0,0),a.setLineWidth(.5),a.line(20,_,90,_),a.line(s-90,_,s-20,_),a.setFontSize(8),a.setFont("helvetica","normal"),a.text("SUPPLIER SIGNATURE",55,_+5,{align:"center"}),a.text("AUTHORISED SIGNATORY",s-55,_+5,{align:"center"}),a.setFont("helvetica","bold"),a.text(`FOR ${er.name}`,s-55,_+10,{align:"center"}),a.setFontSize(7),a.setFont("helvetica","italic"),a.setTextColor(100,100,100),a.text("GENERATED FROM BHAVISHYA ROAD CARRIER SYSTEM",s/2,i-10,{align:"center"});const j=`Memo_${n.memo_number}_${n.supplier.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;a.save(j)},md=async n=>{const e=new $e("p","mm","a4"),r=e.internal.pageSize.getWidth(),a=e.internal.pageSize.getHeight();try{const G=await _l(ni);e.addImage(G,"PNG",15,8,25,25)}catch(G){console.warn("Could not add logo to PDF:",G)}e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(25,118,210),e.text(er.name,r/2,15,{align:"center"}),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),e.text(er.address,r/2,21,{align:"center"}),e.text(er.address2,r/2,25,{align:"center"}),e.text(er.location,r/2,29,{align:"center"}),e.setFontSize(7),e.text(er.phone,15,37),e.text(er.pan,r-15,37,{align:"right"}),e.text(er.tagline,r/2,41,{align:"center"}),e.setLineWidth(1),e.setDrawColor(0,0,0),e.rect(10,5,r-20,40),e.setFillColor(25,118,210),e.rect(10,50,r-20,10,"F"),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("LOADING SLIP",r/2,58,{align:"center"});const s=70;e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),e.text(`Loading Slip No: ${n.slip_number}`,15,s),e.text(`Date: ${Ws(n.date)}`,r-15,s,{align:"right"}),e.text(`Vehicle No: ${n.vehicle_no}`,15,s+6),e.text(`Weight: ${n.weight} MT`,r-15,s+6,{align:"right"});const i=s+18;e.setFillColor(30,136,229),e.rect(10,i-2,r-20,8,"F"),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text(`Party: ${n.party}`,r/2,i+3,{align:"center"});const l=i+15;e.setFontSize(9),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.setLineWidth(.5),e.rect(15,l,80,12),e.rect(115,l,80,12),e.text("FROM:",20,l+4),e.text("TO:",120,l+4),e.setFont("helvetica","normal"),e.text(n.from_location,20,l+8),e.text(n.to_location,120,l+8);const u=l+20;e.setLineWidth(.5),e.rect(15,u,80,12),e.rect(115,u,80,12),e.setFont("helvetica","bold"),e.text("MATERIAL:",20,u+4),e.text("DIMENSIONS:",120,u+4),e.setFont("helvetica","normal"),e.text(n.material,20,u+8),e.text(n.dimension,120,u+8);const c=u+20;e.setFillColor(51,102,204),e.rect(10,c-2,r-20,8,"F"),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("FINANCIAL DETAILS",r/2,c+3,{align:"center"});const m=c+15,b=8,w=100,y=85,p=[["Freight Amount:",At(n.freight)],["Advance Amount:",At(n.advance)],["RTO Amount:",At(n.rto)],["Balance Amount:",At(n.balance)]];e.setFontSize(9),e.setTextColor(0,0,0),p.forEach((G,K)=>{const $=m+K*b;e.setLineWidth(.5),e.rect(15,$,w,b),e.rect(15+w,$,y,b),e.setFont("helvetica","bold"),e.text(G[0],20,$+5),e.setFont("helvetica","normal"),e.text(G[1],20+w,$+5)});const _=m+p.length*b+15;e.setFillColor(25,118,210),e.rect(10,_-2,r-20,8,"F"),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("BANK DETAILS",r/2,_+3,{align:"center"});const j=[["Beneficiary Name:","BHAVISHYA ROAD CARRIERS"],["Account No:","2370003557"],["IFSC Code:","KCBL0001610"],["Branch:","GHODASAR, AHMEDABAD"]];j.forEach((G,K)=>{const $=_+K*8;e.setFontSize(9),e.setFont("helvetica","bold"),e.text(G[0],15,$),e.setFont("helvetica","normal"),e.text(G[1],70,$)});const B=_+j.length*8+10;e.setFontSize(8),e.setFont("helvetica","bold"),e.text("TERMS & CONDITIONS:",15,B),e.setFont("helvetica","normal");const v=["â€¢ We are not responsible for accident, leakage & breakage during transit","â€¢ Loading/Unloading charges extra as applicable","â€¢ Payment to be made within 15 days of delivery","â€¢ Subject to Ahmedabad jurisdiction only","â€¢ One day halting charges Rs.4000"];v.forEach((G,K)=>{e.text(G,15,B+6+K*4)});const L=B+v.length*4+15;e.setLineWidth(.5),e.line(15,L,80,L),e.line(r-80,L,r-15,L),e.setFontSize(9),e.setFont("helvetica","normal"),e.text("CONSIGNOR SIGNATURE",47,L+5,{align:"center"}),e.text("AUTHORISED SIGNATORY",r-47,L+5,{align:"center"}),e.setFont("helvetica","bold"),e.text(`FOR ${er.name}`,r-47,L+10,{align:"center"}),e.setFontSize(7),e.setFont("helvetica","italic"),e.setTextColor(100,100,100),e.text("GENERATED FROM BHAVISHYA ROAD CARRIER SYSTEM",r/2,a-10,{align:"center"});const q=`LoadingSlip_${n.slip_number}_${n.party.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;e.save(q)},gd=async(n,e)=>{var X;const r=new $e("l","mm","a4"),a=r.internal.pageSize.getWidth(),s=r.internal.pageSize.getHeight(),i=20;r.setFontSize(10),r.setFont("helvetica","normal"),r.setTextColor(0,0,0),r.text(`${new Date(n.date).toLocaleDateString("en-GB")}, ${new Date(n.date).toLocaleTimeString("en-GB",{hour12:!1})}`,i,15),r.text(`Bill - ${n.bill_number}`,a-i,15,{align:"right"}),r.setLineWidth(.5),r.setDrawColor(0,0,0),r.rect(i,25,a-2*i,45);try{const se=await _l(ni);r.addImage(se,"PNG",i+5,30,20,20)}catch(se){console.warn("Could not add logo to PDF:",se)}r.setFontSize(16),r.setFont("helvetica","bold"),r.setTextColor(0,102,204),r.text("BHAVISHYA ROAD CARRIERS",a/2,35,{align:"center"}),r.setFontSize(9),r.setFont("helvetica","normal"),r.setTextColor(0,0,0),r.text("Specialist in Heavy ODC, Hydraulic, Low Bed Trailer, Flat Bed Trailer Transport & Commission Agent",a/2,42,{align:"center"}),r.text("FLEET OWNERS, TRANSPORT CONTRACTORS & COMMISSION AGENTS",a/2,47,{align:"center"}),r.text("404, Parijaat Business Center, Nr. SP Ring Road, Aslali, Ahmedabad - 382405",a/2,52,{align:"center"}),r.text("(SUBJECT TO AHMEDABAD JURISDICTION)",a/2,57,{align:"center"}),r.setFontSize(10),r.setFont("helvetica","normal"),r.text("MOB:9824026576, 9824900776",i,65),r.text("PAN NO: BNDPK7173D",a-i,65,{align:"right"}),r.text(`M/S: ${n.party.toUpperCase()}`,i,75),r.text(`BILL NO: ${n.bill_number}`,a-i,75,{align:"right"}),r.text(`BILL DATE: ${new Date(n.date).toLocaleDateString("en-GB")}`,a-i,82,{align:"right"});const l=95,u=12,c=[15,23,24,24,22,13,22,22,22,20,22,20];let m=[i];for(let se=1;se<c.length;se++)m[se]=m[se-1]+c[se-1];const b=["CN NO","LOADING DT","FROM","TO","TRAILOR NO","WT","FREIGHT","RTO","DETENTION","EXTRA","ADVANCE","BALANCE"];r.setFillColor(240,240,240),r.rect(i,l,a-2*i,u,"F"),r.setLineWidth(.3),r.rect(i,l,a-2*i,u),r.setFontSize(8),r.setFont("helvetica","bold"),b.forEach((se,Y)=>{Y<m.length&&(r.text(se,m[Y]+2,l+8),Y>0&&r.line(m[Y],l,m[Y],l+u))});const w=l+u;r.rect(i,w,a-2*i,u),r.setFont("helvetica","normal"),r.setFontSize(8);const y=((X=n.advance_payments)==null?void 0:X.reduce((se,Y)=>se+Y.amount,0))||0,p=n.detention||0,_=n.extra||0,j=n.rto||0,B=n.bill_amount-y+p+_+j-(n.mamool||0)-(n.penalties||0)-(n.tds||0);[e.slip_number||n.bill_number,new Date(e.date||n.date).toLocaleDateString("en-GB"),(e.from_location||"N/A").substring(0,8),(e.to_location||"N/A").substring(0,8),e.vehicle_no||"N/A",`${e.weight||0}MT`,At(n.bill_amount).replace("Rs. ",""),At(j).replace("Rs. ",""),At(p).replace("Rs. ",""),At(_).replace("Rs. ",""),At(y).replace("Rs. ",""),At(B).replace("Rs. ","")].forEach((se,Y)=>{Y<m.length&&(r.text(se,m[Y]+2,w+8),Y>0&&r.line(m[Y],w,m[Y],w+u))});const L=w+u;r.rect(i,L,a-2*i,u),r.setFont("helvetica","bold"),r.text("TOTAL",i+5,L+8),r.text(At(n.bill_amount).replace("Rs. ",""),m[6]+2,L+8),r.text(At(y).replace("Rs. ",""),m[10]+2,L+8),r.text(At(B).replace("Rs. ",""),m[11]+2,L+8),m.forEach((se,Y)=>{Y>0&&r.line(se,L,se,L+u)});let q=L+15;n.advance_payments&&n.advance_payments.length>0&&(r.setFont("helvetica","bold"),r.setFontSize(9),r.text("ADVANCE DETAILS:",i,q),r.setFont("helvetica","normal"),r.setFontSize(8),n.advance_payments.forEach((se,Y)=>{var I;q+=8,r.text(`${Y+1}. Date: ${new Date(se.date).toLocaleDateString("en-GB")} - Amount: ${At(se.amount)} - Mode: ${((I=se.mode)==null?void 0:I.toUpperCase())||"CASH"}`,i,q)}),q+=10);const G=q>0?q+5:L+20;r.rect(i,G,a-2*i,35),r.setFont("helvetica","bold"),r.setFontSize(9),r.text("BANK DETAILS",i+5,G+6),r.setFont("helvetica","normal"),r.setFontSize(8),r.text("BENEFICIARY NAME: BHAVISHYA ROAD CARRIERS",i+5,G+12),r.text("ACCOUNT NO: 231005501207",i+5,G+18),r.text("IFSC CODE: ICIC0002310",i+5,G+24),r.text("BRANCH NAME: GHODASAR, AHMEDABAD",i+5,G+30);const $=a-80;if(r.setFont("helvetica","bold"),r.setFontSize(9),r.text("FOR, BHAVISHYA ROAD CARRIERS",$,G+20),r.text("AUTHORISED SIGNATORY",$,G+30),n.pod_image){r.addPage(),r.setFontSize(16),r.setFont("helvetica","bold"),r.setTextColor(0,102,204),r.text("PROOF OF DELIVERY (POD)",a/2,30,{align:"center"}),r.setFontSize(12),r.setFont("helvetica","normal"),r.setTextColor(0,0,0),r.text(`Bill No: ${n.bill_number}`,i,45),r.text(`Party: ${n.party}`,i,55),r.text(`Vehicle: ${e.vehicle_no}`,i,65),r.text(`Route: ${e.from_location} â†’ ${e.to_location}`,i,75);try{const se=a-2*i,Y=s-120;r.addImage(n.pod_image,"JPEG",i,85,se,Y)}catch(se){console.warn("Could not add POD image to second page:",se),r.setFontSize(10),r.text("POD image could not be displayed",a/2,s/2,{align:"center"})}}r.setFontSize(8),r.setFont("helvetica","normal"),r.setTextColor(128,128,128),r.text("GENERATED BY BHAVISHYA ROAD CARRIERS SYSTEM",a/2,s-10,{align:"center"});const Q=`Bill_${n.bill_number}_${n.party.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;r.save(Q)},Sl=Object.freeze(Object.defineProperty({__proto__:null,COMPANY_INFO:er,formatCurrency:At,formatDate:Ws,generateBillPDF:gd,generateLoadingSlipPDF:md,generateMemoPDF:pd},Symbol.toStringTag,{value:"Module"})),Vh=({type:n,data:e,loadingSlip:r,className:a="",size:s="md"})=>{const[i,l]=pe.useState(!1),u=async()=>{l(!0);try{switch(n){case"memo":r&&await pd(e,r);break;case"loading-slip":await md(e);break;case"bill":r&&await gd(e,r);break}}catch(b){console.error("Error generating PDF:",b),alert("Error generating PDF. Please try again.")}finally{l(!1)}},c=()=>{switch(n){case"memo":return"Generate Memo PDF";case"loading-slip":return"Generate Loading Slip PDF";case"bill":return"Generate Bill PDF";default:return"Generate PDF"}},m=()=>{switch(s){case"sm":return"px-3 py-1.5 text-sm";case"lg":return"px-6 py-3 text-base";default:return"px-4 py-2 text-sm"}};return t.jsxs("button",{onClick:u,disabled:i,className:`
        inline-flex items-center space-x-2 bg-red-600 text-white rounded-lg 
        hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed 
        transition-colors ${m()} ${a}
      `,children:[i?t.jsx(Bu,{className:"w-4 h-4 animate-spin"}):t.jsx(vl,{className:"w-4 h-4"}),t.jsx("span",{children:i?"Generating...":c()})]})},xd=({loadingSlip:n,nextBillNumber:e,initialData:r,onSubmit:a,onCancel:s})=>{const[i,l]=pe.useState({bill_number:r?r.bill_number:e,loading_slip_id:(n==null?void 0:n.id)||"",date:new Date().toISOString().split("T")[0],party:(n==null?void 0:n.party)||"",bill_amount:(n==null?void 0:n.total_freight)||0,detention:0,extra:0,rto:(n==null?void 0:n.rto)||0,mamool:0,tds:0,penalties:0,net_amount:0,pod_image:"",status:"pending",narration:""}),[u,c]=pe.useState("");pe.useEffect(()=>{const y=i.bill_amount+i.detention+i.extra+i.rto-i.mamool-i.tds-i.penalties;l(p=>({...p,net_amount:y}))},[i.bill_amount,i.detention,i.extra,i.rto,i.mamool,i.tds,i.penalties]),pe.useEffect(()=>{r?l({bill_number:r.bill_number,loading_slip_id:r.loading_slip_id,date:r.date.split("T")[0],party:r.party,bill_amount:r.bill_amount,detention:r.detention||0,extra:r.extra||0,rto:r.rto||0,mamool:r.mamool,tds:r.tds,penalties:r.penalties,net_amount:r.net_amount,pod_image:r.pod_image||"",status:r.status||"pending",narration:r.narration||""}):n&&l(y=>({...y,bill_number:e,loading_slip_id:n.id,party:n.party,bill_amount:n.total_freight,rto:n.rto||0}))},[r,n,e]);const m=async y=>{if(y.preventDefault(),i.pod_image)try{const p={filename:u||`POD_${i.bill_number}_${Date.now()}.jpg`,fileData:i.pod_image,fileType:"image/jpeg",billNo:i.bill_number,party:i.party,uploadDate:new Date().toISOString(),created_at:new Date().toISOString()};await Fe.createPODFile(p),console.log("POD image saved successfully for bill:",i.bill_number)}catch(p){console.error("Failed to save POD image:",p)}a(i)},b=y=>{const{name:p,value:_,type:j}=y.target;l(B=>({...B,[p]:j==="number"?parseFloat(_)||0:_}))},w=y=>{var j;const p=(j=y.target.files)==null?void 0:j[0];if(!p)return;const _=new FileReader;_.onload=()=>{const B=typeof _.result=="string"?_.result:"";l(v=>({...v,pod_image:B})),c(p.name)},_.readAsDataURL(p)};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Edit Bill":"New Bill"}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-6 h-6"})})]}),t.jsxs("form",{onSubmit:m,className:"p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bill Number"}),t.jsx("input",{type:"text",name:"bill_number",value:i.bill_number,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",name:"date",value:i.date,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Party (M/S)"}),t.jsx("input",{type:"text",name:"party",value:i.party,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Loading Slip Details"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Slip No:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.slip_number})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Vehicle:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.vehicle_no})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Route:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[n.from_location," â†’ ",n.to_location]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Party:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.party})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Material:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.material||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Weight:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[n.weight," MT"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Dimension:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.dimension})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-700",children:"Supplier:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.supplier})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bill Amount (â‚¹)"}),t.jsx("input",{type:"number",name:"bill_amount",value:i.bill_amount,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"POD Image"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden",id:"pod-upload"}),t.jsxs("label",{htmlFor:"pod-upload",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 flex items-center space-x-2",children:[t.jsx(Vc,{className:"w-4 h-4 text-gray-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:u||"Upload POD Image"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detention (â‚¹)"}),t.jsx("input",{type:"number",name:"detention",value:i.detention,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Extra Weight (â‚¹)"}),t.jsx("input",{type:"number",name:"extra",value:i.extra,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RTO (â‚¹)"}),t.jsx("input",{type:"number",name:"rto",value:i.rto,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mamool (â‚¹)"}),t.jsx("input",{type:"number",name:"mamool",value:i.mamool,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"TDS (â‚¹)"}),t.jsx("input",{type:"number",name:"tds",value:i.tds,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Penalties (â‚¹)"}),t.jsx("input",{type:"number",name:"penalties",value:i.penalties,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Narration"}),t.jsx("textarea",{name:"narration",value:i.narration,onChange:y=>l(p=>({...p,narration:y.target.value})),placeholder:"Enter narration or remarks",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx(Uc,{className:"w-5 h-5 text-green-600 mr-2"}),t.jsx("h3",{className:"text-sm font-medium text-green-900",children:"Bill Calculation"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-green-700",children:"Bill Amount:"}),t.jsx("span",{className:"ml-2 font-medium",children:me(i.bill_amount)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-green-700",children:"Detention:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["+",me(i.detention)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-green-700",children:"Extra Weight:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["+",me(i.extra)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-green-700",children:"RTO:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["+",me(i.rto)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-red-700",children:"Mamool:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["-",me(i.mamool)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-red-700",children:"TDS:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["-",me(i.tds)]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-red-700",children:"Penalties:"}),t.jsxs("span",{className:"ml-2 font-medium",children:["-",me(i.penalties)]})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-green-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-green-900 font-medium",children:"Net Amount:"}),t.jsx("span",{className:"text-xl font-bold text-green-900",children:me(i.net_amount)})]})})]}),t.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[t.jsx("div",{children:r&&n&&t.jsx(Vh,{type:"bill",data:r,loadingSlip:n,size:"md"})}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("button",{type:"button",onClick:s,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r?"Update":"Create"," Bill"]})]})]})]})]})})},Hh=()=>{const{loadingSlips:n,memos:e,bills:r,vehicles:a,addLoadingSlip:s,updateLoadingSlip:i,deleteLoadingSlip:l}=tr(),[u,c]=pe.useState(!1),[m,b]=pe.useState(null),[w,y]=pe.useState(null),[p,_]=pe.useState(""),[j,B]=pe.useState(!1),[v,L]=pe.useState(!1),[q,G]=pe.useState(null),[K,$]=pe.useState(null),Q=()=>Ja(n,"slip_number","LS"),X=()=>Ja(e,"memo_number","MO"),se=()=>Ja(r,"bill_number","BL"),Y=()=>{b(null),c(!0)},I=async F=>{try{const A=await Fe.createLoadingSlip(F);s(A.loadingSlip),console.log("Loading slip created and synced to MongoDB:",A.loadingSlip),setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3)}catch(A){console.error("Failed to create loading slip:",A);const R={...F,id:Ja(n,"slip_number","LS"),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};s(R)}c(!1)},h=async F=>{if(m){try{const A=await Fe.updateLoadingSlip(m.id,F);i(A.loadingSlip),console.log("Loading slip updated and synced:",A.loadingSlip)}catch(A){console.error("Failed to update loading slip:",A);const R={...m,...F,updated_at:new Date().toISOString()};i(R)}b(null),c(!1)}},g=async F=>{try{const{generateLoadingSlipPDF:A}=await ri(async()=>{const{generateLoadingSlipPDF:R}=await Promise.resolve().then(()=>Sl);return{generateLoadingSlipPDF:R}},void 0);await A(F)}catch(A){console.error("Failed to generate PDF:",A),alert("Failed to generate PDF. Please try again.")}},S=async F=>{if(window.confirm("Are you sure you want to delete this loading slip?"))try{await Fe.deleteLoadingSlip(F),l(F),console.log("Loading slip deleted and synced")}catch(A){console.error("Failed to delete loading slip:",A),l(F)}},D=n.filter(F=>{var re,ve;if(!p.trim())return!0;const A=((re=e.find(k=>k.loading_slip_id===F.id))==null?void 0:re.memo_number)||"",R=((ve=r.find(k=>k.loading_slip_id===F.id))==null?void 0:ve.bill_number)||"";return[F.slip_number,A,R,F.party,F.vehicle_no,F.from_location,F.to_location,new Date(F.date).toLocaleDateString("en-IN"),String(F.total_freight||"")].join(" ").toLowerCase().includes(p.toLowerCase())});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Loading Slip"}),t.jsxs("button",{onClick:Y,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-5 h-5"}),t.jsx("span",{children:"New Loading Slip"})]})]}),u&&t.jsx(Wu,{initialData:m,nextSlipNumber:Q(),onSubmit:m?h:I,onCancel:()=>{c(!1),b(null)}}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:t.jsx("input",{type:"text",value:p,onChange:F=>_(F.target.value),placeholder:"Search by slip number, vehicle, party, location, material, or date...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),D.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Br,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No loading slips found"}),t.jsx("p",{className:"text-gray-500",children:"Create your first loading slip to get started"})]}):t.jsx("div",{className:"space-y-4",children:D.map((F,A)=>t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-blue-600 mb-1",children:["Loading Slip #",F.slip_number]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(F.date).toLocaleDateString("en-IN")," â€¢ ",F.from_location," â†’ ",F.to_location]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>y(F),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"View Details",children:t.jsx(qi,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{b(F),c(!0)},className:"p-2 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:t.jsx(pa,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>g(F),className:"p-2 text-green-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Download PDF",children:t.jsx(Ar,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>S(F.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:t.jsx($s,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Vehicle & Material"}),t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("p",{className:"font-medium text-gray-900",children:F.vehicle_no}),(()=>{const R=a.find(J=>J.vehicle_no===F.vehicle_no);return R?t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${R.ownership_type==="own"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:R.ownership_type==="own"?"Own":"Market"}):null})()]}),t.jsx("p",{className:"text-sm text-gray-600",children:F.material||"N/A"}),t.jsx("p",{className:"text-sm text-gray-500",children:F.dimension})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Party & Weight"}),t.jsx("p",{className:"font-medium text-gray-900",children:F.party}),t.jsxs("p",{className:"text-sm text-gray-600",children:[F.weight," MT"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Total Freight"}),t.jsx("p",{className:"text-lg font-bold text-green-600",children:me(F.total_freight)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[F.memo_number?t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Memo:"}),t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:F.memo_number})]}):t.jsxs("button",{onClick:()=>{console.log("Setting selectedSlipForMemo:",F),console.log("Slip ID:",F.id),G(F),B(!0)},className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-blue-600 bg-blue-50 rounded-full hover:bg-blue-100 transition-colors",children:[t.jsx(Kr,{className:"w-3 h-3 mr-1"}),"Create Memo"]}),F.bill_number?t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Bill:"}),t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:F.bill_number})]}):t.jsxs("button",{onClick:()=>{$(F),L(!0)},className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-green-600 bg-green-50 rounded-full hover:bg-green-100 transition-colors",children:[t.jsx(Kr,{className:"w-3 h-3 mr-1"}),"Create Bill"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>y(F),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"View Details",children:t.jsx(qi,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{b(F),c(!0)},className:"p-2 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:t.jsx(pa,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>g(F),className:"p-2 text-green-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Download PDF",children:t.jsx(Ar,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>S(F.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:t.jsx($s,{className:"w-4 h-4"})})]})]})]})},F.id||`slip-${A}-${F.slip_number}`))}),w&&t.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-semibold",children:["Loading Slip #",w.slip_number]}),t.jsx("button",{onClick:()=>y(null),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),t.jsxs("div",{className:"p-6 grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Date:"})," ",new Date(w.date).toLocaleDateString("en-IN")]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Party:"})," ",w.party]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Supplier:"})," ",w.supplier]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-gray-500",children:"Vehicle No:"}),t.jsx("span",{children:w.vehicle_no}),(()=>{const F=a.find(A=>A.vehicle_no===w.vehicle_no);return F?t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${F.ownership_type==="own"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:F.ownership_type==="own"?"Own Vehicle":"Market Vehicle"}):null})()]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Route:"})," ",w.from_location," â†’ ",w.to_location]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Weight:"})," ",w.weight," MT"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Freight:"})," ",me(w.freight)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Advance:"})," ",me(w.advance)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"RTO:"})," ",me(w.rto)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Balance:"})," ",me(w.balance)]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Total Freight:"})," ",me(w.total_freight)]}),w.narration&&t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Narration:"}),t.jsx("p",{className:"mt-1 text-gray-900",children:w.narration})]})]}),t.jsx("div",{className:"px-6 py-4 border-t flex justify-end",children:t.jsx("button",{onClick:()=>y(null),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Close"})})]})}),j&&q&&t.jsx(Wc,{slip:q,nextMemoNumber:X(),onSubmit:async F=>{try{const A=localStorage.getItem("auth_token");if(!A)throw new Error("Authentication required - please log in");const R={...F,loading_slip_id:q==null?void 0:q.id};if(console.log("LoadingSlip component - selectedSlipForMemo:",q),console.log("LoadingSlip component - selectedSlipForMemo.id:",q==null?void 0:q.id),console.log("LoadingSlip component - memoData received:",F),console.log("LoadingSlip component - final data with slip ID:",R),console.log("LoadingSlip component - auth token present:",!!A),!q)throw new Error("No loading slip selected for memo creation");if(!q.id)throw new Error("Selected loading slip is missing ID field");if(!R.loading_slip_id)throw new Error("Loading slip ID is missing - cannot create memo");const J=await Fe.createMemo(R);console.log("Memo created successfully:",J),window.dispatchEvent(new CustomEvent("data-sync-required")),B(!1),G(null),console.log("Memo created and sync triggered")}catch(A){console.error("Failed to create memo - Full error details:",A),console.error("Error message:",A instanceof Error?A.message:"Unknown error"),console.error("Error stack:",A instanceof Error?A.stack:"No stack trace"),alert(`Failed to create memo: ${A instanceof Error?A.message:"Unknown error"}`),B(!1),G(null)}},onCancel:()=>{B(!1),G(null)}}),v&&K&&t.jsx(xd,{loadingSlip:K,nextBillNumber:se(),onSubmit:async F=>{try{const A={...F,loading_slip_id:K==null?void 0:K.id};if(console.log("LoadingSlip component - selectedSlipForBill:",K),console.log("LoadingSlip component - billData received:",F),console.log("LoadingSlip component - final data with slip ID:",A),!A.loading_slip_id)throw new Error("Loading slip ID is missing - cannot create bill");const R=await Fe.createBill(A);console.log("Bill created successfully:",R),window.dispatchEvent(new CustomEvent("data-sync-required")),L(!1),$(null),console.log("Bill created and sync triggered")}catch(A){console.error("Failed to create bill:",A),L(!1),$(null)}},onCancel:()=>{L(!1),$(null)}})]})},Lc=({showOnlyFullyPaid:n=!1})=>{const{memos:e,addMemo:r,updateMemo:a,deleteMemo:s,bankingEntries:i,addBankingEntry:l,markMemoAsPaid:u,setLedgerEntries:c,loadingSlips:m,vehicles:b}=tr(),[w,y]=pe.useState(!1),[p,_]=pe.useState(null),[j,B]=pe.useState(null),[v,L]=pe.useState(null),[q,G]=pe.useState(""),[K,$]=pe.useState(""),Q=async A=>{try{const R=await Fe.createMemo(A);r(R.memo),console.log("Memo created and synced to MongoDB:",R.memo);let J=m.find(k=>k.id===A.loading_slip_id);if(!J&&R.memo.loading_slip_id){const k=typeof R.memo.loading_slip_id=="object"?R.memo.loading_slip_id._id:R.memo.loading_slip_id;J=m.find(z=>z.id===k),!J&&typeof R.memo.loading_slip_id=="object"&&(J=R.memo.loading_slip_id)}const re=b.find(k=>k.vehicle_no===(J==null?void 0:J.vehicle_no)),ve=(re==null?void 0:re.ownership_type)==="own";console.log("ðŸš› MEMO LEDGER DEBUG:",{memoId:R.memo.id,memoNumber:R.memo.memo_number,loadingSlipId:A.loading_slip_id,loadingSlipFound:!!J,vehicleNo:J==null?void 0:J.vehicle_no,vehicleFound:!!re,vehicleOwnership:re==null?void 0:re.ownership_type,isOwnVehicle:ve,freight:A.freight,commission:A.commission,mamool:A.mamool,netAmount:A.freight-(A.commission||0)-(A.mamool||0),allVehicles:b.map(k=>({no:k.vehicle_no,ownership:k.ownership_type}))});try{const k=await Fe.getLedgerEntries();c(k.ledgerEntries||[]),console.log("ðŸ”„ Synced ledger entries after memo creation")}catch(k){console.error("Failed to sync ledger entries:",k)}setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3)}catch(R){console.error("Failed to create memo:",R);const J={...A,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(J)}y(!1)},X=()=>{_(null),y(!0)},se=()=>Ja(e,"memo_number","MO"),Y=A=>{_(A),y(!0)},I=async A=>{if(p){try{const R=await Fe.updateMemo(p.id,A);a(R.memo),console.log("Memo updated and synced:",R.memo);try{const J=await Fe.getLedgerEntries();c(J.ledgerEntries||[]),console.log("ðŸ”„ Synced ledger entries after memo update")}catch(J){console.error("Failed to sync ledger entries:",J)}setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3)}catch(R){console.error("Failed to update memo:",R);const J={...p,...A,updated_at:new Date().toISOString()};a(J)}_(null),y(!1)}},h=async A=>{try{const{generateMemoPDF:R}=await ri(async()=>{const{generateMemoPDF:re}=await Promise.resolve().then(()=>Sl);return{generateMemoPDF:re}},void 0),J=typeof A.loading_slip_id=="object"&&A.loading_slip_id!==null?A.loading_slip_id:m.find(re=>re.id===A.loading_slip_id);J?await R(A,J,i):(console.error("Related loading slip not found for memo:",A.id),alert("Related loading slip not found. Cannot generate PDF."))}catch(R){console.error("Failed to generate PDF:",R),alert("Failed to generate PDF. Please try again.")}},g=A=>{L(A),G(new Date().toISOString().split("T")[0])},S=async A=>{if(window.confirm("Are you sure you want to delete this memo?"))try{await Fe.deleteMemo(A),s(A),console.log("Memo deleted and synced")}catch(R){console.error("Failed to delete memo:",R),s(A)}},D=async()=>{if(v&&q){try{const A={id:Date.now().toString(),type:"debit",date:q,category:"memo_payment",narration:`Full payment for Memo ${v.memo_number}`,amount:v.net_amount,reference_id:v.memo_number,reference_name:v.supplier,created_at:new Date().toISOString()};await Fe.createBankingEntry(A),l(A);const R={...v,status:"paid",paid_date:q,paid_amount:v.net_amount};await Fe.updateMemo(v.id,R),u(v.id,q,v.net_amount),setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3),console.log("Memo marked as paid and synced")}catch(A){console.error("Failed to mark memo as paid:",A),l({id:Date.now().toString(),type:"debit",date:q,category:"memo_payment",narration:`Full payment for Memo ${v.memo_number}`,amount:v.net_amount,reference_id:v.memo_number,reference_name:v.supplier,created_at:new Date().toISOString()}),u(v.id,q,v.net_amount)}L(null),G("")}},F=pe.useMemo(()=>{let A=n?e.filter(J=>J.status==="paid"):e.filter(J=>J.status!=="paid");if(n&&(A=A.filter(J=>{const re=i.filter(k=>(k.category==="memo_advance"||k.category==="memo_payment")&&k.reference_id===J.memo_number).reduce((k,z)=>k+z.amount,0);return J.freight-re-(J.commission||0)-(J.mamool||0)+(J.detention||0)+(J.extra||0)<=0})),!K.trim())return A;const R=K.toLowerCase();return A.filter(J=>{const re=m.find(k=>k.id===J.loading_slip_id);return[J.memo_number,J.supplier,new Date(J.date).toLocaleDateString("en-IN"),String(J.freight),String(J.net_amount),(re==null?void 0:re.slip_number)||"",(re==null?void 0:re.party)||"",(re==null?void 0:re.vehicle_no)||""].join(" ").toLowerCase().includes(R)})},[e,i,n,K,m]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Memo"}),t.jsxs("button",{onClick:X,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-5 h-5"}),t.jsx("span",{children:"New Memo"})]})]}),w&&t.jsx(Wc,{initialData:p,nextMemoNumber:se(),onSubmit:p?I:Q,onCancel:()=>{y(!1),_(null)}}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:t.jsx("input",{type:"text",value:K,onChange:A=>$(A.target.value),placeholder:"Search by memo number, supplier name, or route...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),t.jsxs("div",{className:"bg-blue-600 rounded-xl shadow-sm p-6 text-white",children:[t.jsx("h2",{className:"text-xl font-bold mb-2",children:n?"Paid Memos":"Broker Memos"}),t.jsx("p",{className:"text-blue-100",children:n?"Manage settled supplier memos":"Manage supplier transportation memos"}),t.jsxs("div",{className:"mt-4 text-sm text-blue-100",children:[F.length," of ",F.length," memos"]})]}),F.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Br,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No memos found"}),t.jsx("p",{className:"text-gray-500",children:"Create memos from loading slips"})]}):t.jsx("div",{className:"space-y-4",children:e.map((A,R)=>{const J=typeof A.loading_slip_id=="object"&&A.loading_slip_id!==null?A.loading_slip_id:m.find(V=>V.id===A.loading_slip_id),re=i.filter(V=>(V.category==="memo_advance"||V.category==="memo_payment")&&V.reference_id===A.memo_number).reduce((V,ee)=>V+ee.amount,0),ve=A.freight-re-(A.commission||0)-(A.mamool||0)+(A.detention||0)+(A.extra||0),k=ve<=0,z=Math.max(0,ve);return t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-blue-600 mb-1",children:["Memo #",A.memo_number]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(A.date).toLocaleDateString("en-IN")," â€¢ ",J?`${J.from_location} â†’ ${J.to_location}`:"N/A"]})]}),t.jsxs("div",{className:"text-right",children:[k?t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Settled"}):t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Due"}),n&&A.paid_date&&t.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Paid: ",new Date(A.paid_date).toLocaleDateString("en-IN")]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Vehicle & Material"}),t.jsx("div",{className:"font-medium text-gray-900",children:(J==null?void 0:J.vehicle_no)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-600",children:(J==null?void 0:J.material)||"N/A"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Supplier & Weight"}),t.jsx("div",{className:"font-medium text-gray-900",children:(J==null?void 0:J.supplier)||A.supplier}),t.jsxs("div",{className:"text-sm text-gray-600",children:[(J==null?void 0:J.weight)||0," MT"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Total Freight"}),t.jsx("div",{className:"text-lg font-bold text-green-600",children:me(A.freight)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Balance"}),t.jsx("div",{className:"text-lg font-bold text-green-600",children:me(z)})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Commission:"}),t.jsx("span",{className:"ml-1 font-medium",children:me(A.commission||0)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Mamool:"}),t.jsx("span",{className:"ml-1 font-medium",children:me(A.mamool||0)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Detention:"}),t.jsx("span",{className:"ml-1 font-medium",children:me(A.detention||0)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Extra:"}),t.jsx("span",{className:"ml-1 font-medium",children:me(A.extra||0)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Net Amount:"}),t.jsx("span",{className:"ml-1 font-bold text-green-600",children:me(A.net_amount)})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Paid:"}),t.jsx("span",{className:"ml-1 font-medium",children:me(re)})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>B(A),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"View Details",children:t.jsx(qi,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>Y(A),className:"p-2 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:t.jsx(pa,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>h(A),className:"p-2 text-green-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Download PDF",children:t.jsx(Ar,{className:"w-4 h-4"})}),!n&&!k&&t.jsx("button",{onClick:()=>g(A),className:"p-2 text-purple-400 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:"Mark as Paid",children:t.jsx(Iu,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>S(A.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:t.jsx($s,{className:"w-4 h-4"})})]})]})]})},A.id||`memo-${R}-${A.memo_number}`)})}),j&&t.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-semibold",children:["Memo #",j.memo_number]}),t.jsx("button",{onClick:()=>B(null),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),t.jsxs("div",{className:"p-6 grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Date:"})," ",new Date(j.date).toLocaleDateString("en-IN")]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Supplier:"})," ",j.supplier]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Freight:"})," ",me(j.freight)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Commission:"})," ",me(j.commission)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Mamool:"})," ",me(j.mamool)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Detention:"})," ",me(j.detention)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Extra:"})," ",me(j.extra)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"RTO:"})," ",me(j.rto)]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Net Amount:"})," ",me(j.net_amount)]}),j.narration&&t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Narration:"}),t.jsx("p",{className:"mt-1 text-gray-900",children:j.narration})]})]}),t.jsx("div",{className:"px-6 py-4 border-t flex justify-end",children:t.jsx("button",{onClick:()=>B(null),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Close"})})]})}),v&&t.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Mark Memo as Paid"}),t.jsx("button",{onClick:()=>L(null),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Memo #",v.memo_number," - ",v.supplier]}),t.jsxs("p",{className:"text-lg font-semibold text-green-600",children:["Amount: ",me(v.net_amount)]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Date"}),t.jsx("input",{type:"date",value:q,onChange:A=>G(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end space-x-3",children:[t.jsx("button",{onClick:()=>L(null),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancel"}),t.jsx("button",{onClick:D,className:"px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",children:"Mark as Paid"})]})]})})]})},Ac=({showOnlyFullyReceived:n=!1})=>{const{bills:e,addBill:r,updateBill:a,deleteBill:s,bankingEntries:i,addBankingEntry:l,loadingSlips:u,markBillAsReceived:c}=tr(),[m,b]=pe.useState(!1),[w,y]=pe.useState(null),[p,_]=pe.useState(null),[j,B]=pe.useState(null),[v,L]=pe.useState(""),[q,G]=pe.useState(""),K=async g=>{try{const S=await Fe.createBill(g);r(S.bill),console.log("Bill created and synced to MongoDB:",S.bill),setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3)}catch(S){console.error("Failed to create bill:",S);const D={...g,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(D)}b(!1)},$=()=>Ja(e,"bill_number","BL"),Q=async g=>{if(w){try{const S=await Fe.updateBill(w.id,g);a(S.bill),console.log("Bill updated and synced:",S.bill),setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3)}catch(S){console.error("Failed to update bill:",S);const D={...g,id:w.id,created_at:w.created_at,updated_at:new Date().toISOString()};a(D)}b(!1),y(null)}},X=async g=>{try{const S=i.filter(R=>R.category==="bill_advance"&&R.reference_id===g.bill_number).map(R=>({id:R.id||R._id||`advance-${Date.now()}-${Math.random()}`,bill_id:g.id,date:R.date,amount:R.amount,mode:R.payment_mode||"bank",reference:R.narration||R.reference_id})),D={...g,advance_payments:S},{generateBillPDF:F}=await ri(async()=>{const{generateBillPDF:R}=await Promise.resolve().then(()=>Sl);return{generateBillPDF:R}},void 0);let A;typeof g.loading_slip_id=="object"&&g.loading_slip_id!==null?(A=g.loading_slip_id,console.log("Using populated loading slip from bill:",A)):(A=u.find(R=>R.id===g.loading_slip_id||R._id===g.loading_slip_id),console.log("Found loading slip in local store:",A)),A?await F(D,A):(console.error("Related loading slip not found for bill:",g.id,"loading_slip_id:",g.loading_slip_id),alert("Related loading slip not found. Cannot generate PDF."))}catch(S){console.error("Error generating PDF:",S),alert("Error generating PDF. Please try again.")}},se=g=>{B(g),L(new Date().toISOString().split("T")[0])},Y=async()=>{if(j&&v){try{const g={id:Date.now().toString(),type:"credit",date:v,category:"bill_payment",narration:`Full payment received for Bill ${j.bill_number}`,amount:j.bill_amount,reference_id:j.bill_number,reference_name:j.party,created_at:new Date().toISOString()};await Fe.createBankingEntry(g),l(g);const S={...j,status:"received",received_date:v,received_amount:j.bill_amount};await Fe.updateBill(j.id,S),c(j.id,v,j.bill_amount),setTimeout(()=>{window.dispatchEvent(new CustomEvent("data-sync-required"))},1e3),console.log("Bill marked as received and synced")}catch(g){console.error("Failed to mark bill as received:",g),l({id:Date.now().toString(),type:"credit",date:v,category:"bill_payment",narration:`Full payment received for Bill ${j.bill_number}`,amount:j.bill_amount,reference_id:j.bill_number,reference_name:j.party,created_at:new Date().toISOString()}),c(j.id,v,j.bill_amount)}B(null),L("")}},I=async g=>{if(window.confirm(`Are you sure you want to delete Bill #${g.bill_number}?`))try{console.log("Deleting bill with ID:",g.id),await Fe.deleteBill(g.id),s(g.id),console.log("Bill deleted successfully"),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(S){console.error("Failed to delete bill:",S),s(g.id)}},h=pe.useMemo(()=>{let g=n?e.filter(D=>D.status==="received"):e.filter(D=>D.status!=="received");if(n&&(g=g.filter(D=>i.filter(A=>(A.category==="bill_advance"||A.category==="bill_payment")&&A.reference_id===D.bill_number).reduce((A,R)=>A+R.amount,0)>=D.net_amount&&D.net_amount>0)),!q.trim())return g;const S=q.toLowerCase();return g.filter(D=>{const F=u.find(R=>R.id===D.loading_slip_id);return[D.bill_number,D.party,new Date(D.date).toLocaleDateString("en-IN"),String(D.bill_amount),String(D.net_amount),(F==null?void 0:F.vehicle_no)||""].join(" ").toLowerCase().includes(S)})},[e,i,n,q,u]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bills"}),t.jsxs("button",{onClick:()=>b(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-5 h-5"}),t.jsx("span",{children:"New Bill"})]})]}),m&&t.jsx(xd,{initialData:w,nextBillNumber:$(),onSubmit:w?Q:K,onCancel:()=>{b(!1),y(null)}}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:t.jsx("input",{type:"text",value:q,onChange:g=>G(g.target.value),placeholder:"Search bills by bill number, party name, route, or vehicle...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),h.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Br,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No bills found"}),t.jsx("p",{className:"text-gray-500",children:"Create bills from loading slips"})]}):t.jsx("div",{className:"space-y-4",children:e.map((g,S)=>{const D=typeof g.loading_slip_id=="object"&&g.loading_slip_id!==null?g.loading_slip_id:u.find(re=>re.id===g.loading_slip_id),F=i.filter(re=>(re.category==="bill_advance"||re.category==="bill_payment")&&re.reference_id===g.bill_number).reduce((re,ve)=>re+ve.amount,0),A=g.bill_amount+(g.detention||0)+(g.extra||0)+(g.rto||0)-(g.mamool||0)-(g.penalties||0)-(g.tds||0),R=A-F;return t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[t.jsxs("h3",{className:"text-lg font-semibold text-blue-600",children:["Bill #",g.bill_number]}),t.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[t.jsxs("span",{children:["Trips: ",1]}),t.jsxs("span",{className:`font-medium ${R>0?"text-red-600":R<0?"text-green-600":"text-gray-600"}`,children:["Balance: ",me(Math.abs(R))]})]})]}),t.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:[new Date(g.date).toLocaleDateString("en-IN")," â€¢ ",g.party,n&&g.received_date&&t.jsxs("span",{className:"text-green-600 ml-2",children:["â€¢ Received: ",new Date(g.received_date).toLocaleDateString("en-IN")]})]}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Total Freight: ",t.jsx("span",{className:"font-medium",children:me(A)}),t.jsxs("span",{className:"ml-4",children:["Advances: ",F>0?me(F):"0"]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>_(g),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"View Details",children:t.jsx(qi,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{y(g),b(!0)},className:"p-2 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:t.jsx(pa,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>X(g),className:"p-2 text-green-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Download PDF",children:t.jsx(Ar,{className:"w-4 h-4"})}),!n&&t.jsx("button",{onClick:()=>se(g),className:"px-3 py-1 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors",title:"Mark as Received",children:"Mark as Received"}),t.jsx("button",{onClick:()=>I(g),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:t.jsx($s,{className:"w-4 h-4"})})]})]}),D&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mt-4 border border-blue-200",children:[t.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide mb-2 font-medium",children:"Loading Slip Details:"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Route"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[D.from_location," â†’ ",D.to_location]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Vehicle"}),t.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.vehicle_no})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Material"}),t.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.material||"N/A"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Weight"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[D.weight," MT"]})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Supplier"}),t.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.supplier})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Bill Amount"}),t.jsx("div",{className:"text-lg font-bold text-blue-600",children:me(g.bill_amount)})]})]})})]})]})},g.id||`bill-${S}-${g.bill_number}`)})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-semibold",children:["Bill #",p.bill_number]}),t.jsx("button",{onClick:()=>_(null),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),t.jsxs("div",{className:"p-6 grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Date:"})," ",new Date(p.date).toLocaleDateString("en-IN")]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Party:"})," ",p.party]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Bill Amount:"})," ",me(p.bill_amount)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Deductions:"})," ",me(p.mamool+p.tds+p.penalties)]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Net Amount:"})," ",me(p.net_amount)]}),t.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[t.jsx("span",{className:"text-gray-500",children:"POD:"}),p.pod_image?t.jsxs("span",{className:"text-green-600 flex items-center space-x-1",children:[t.jsx(Br,{className:"w-4 h-4"}),t.jsx("span",{children:"Available"})]}):t.jsx("span",{className:"text-gray-400",children:"Not Attached"})]}),p.narration&&t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Narration:"}),t.jsx("p",{className:"mt-1 text-gray-900",children:p.narration})]})]}),t.jsx("div",{className:"px-6 py-4 border-t flex justify-end",children:t.jsx("button",{onClick:()=>_(null),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Close"})})]})}),j&&t.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Mark Bill as Received"}),t.jsx("button",{onClick:()=>B(null),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Bill #",j.bill_number," - ",j.party]}),t.jsxs("p",{className:"text-lg font-semibold text-green-600",children:["Amount: ",me(j.bill_amount)]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Received Date"}),t.jsx("input",{type:"date",value:v,onChange:g=>L(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end space-x-3",children:[t.jsx("button",{onClick:()=>B(null),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancel"}),t.jsx("button",{onClick:Y,className:"px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",children:"Mark as Received"})]})]})})]})},bd=({onSubmit:n,onCancel:e,editingEntry:r})=>{const{memos:a,bills:s,ledgerEntries:i,parties:l,vehicles:u}=tr(),[c,m]=pe.useState({type:(r==null?void 0:r.type)||"credit",category:(r==null?void 0:r.category)||"other",amount:(r==null?void 0:r.amount)||0,date:(r==null?void 0:r.date)||new Date().toISOString().split("T")[0],reference_id:(r==null?void 0:r.reference_id)||"",reference_name:(r==null?void 0:r.reference_name)||"",narration:(r==null?void 0:r.narration)||"",vehicle_no:(r==null?void 0:r.vehicle_no)||""}),b=pe.useMemo(()=>a.map(S=>S.memo_number),[a]),w=pe.useMemo(()=>s.map(S=>S.bill_number),[s]),[y,p]=pe.useState(!1),[_,j]=pe.useState(!1),[B,v]=pe.useState({name:"",type:"expense",description:""}),L=pe.useMemo(()=>{const S=i.filter(A=>A.ledger_type==="general"),D=l.map(A=>A.name).filter(Boolean),F=Array.from(new Set(S.map(A=>A.reference_name).filter(Boolean)));return Array.from(new Set([...D,...F])).sort()},[i,l]),q=async S=>{if(S.preventDefault(),c.category==="vehicle_expense"&&c.vehicle_no){const D={ledger_type:"vehicle_expense",reference_id:c.reference_id||`BANK-${Date.now()}`,reference_name:`Vehicle ${c.vehicle_no} - ${c.narration||"Banking Expense"}`,date:c.date,description:c.narration||"Vehicle expense from banking",debit:c.amount,credit:0,balance:0,vehicle_no:c.vehicle_no};try{await Fe.createLedgerEntry(D),console.log("âœ… Vehicle expense ledger entry created:",D)}catch(F){console.error("âŒ Failed to create vehicle expense ledger entry:",F)}}n(c)},G=S=>{const{name:D,value:F,type:A}=S.target;m(R=>D==="category"?{...R,category:F,reference_id:"",reference_name:""}:{...R,[D]:A==="number"?parseFloat(F)||0:F})},K=()=>c.type==="credit"?[{value:"bill_advance",label:"Bill Advance"},{value:"bill_payment",label:"Bill Payment"},{value:"vehicle_credit_note",label:"Vehicle Credit Note (Insurance/Cashback)"},{value:"other",label:"Other Income"}]:[{value:"memo_advance",label:"Memo Advance"},{value:"memo_payment",label:"Memo Payment"},{value:"expense",label:"General Expense"},{value:"vehicle_expense",label:"Vehicle Expense"},{value:"fuel_wallet",label:"Fuel Wallet Credit"},{value:"other",label:"Other Expense"}],$=()=>["bill_advance","bill_payment","memo_advance","memo_payment"].includes(c.category),Q=()=>c.category==="vehicle_expense"||c.category==="vehicle_credit_note",X=()=>u.filter(S=>S.ownership_type==="own"),se=()=>c.category.includes("bill")?w:c.category.includes("memo")?b:[],Y=S=>{m(D=>{let F=D.reference_name;if(D.category.includes("bill")){const A=s.find(R=>R.bill_number===S);F=(A==null?void 0:A.party)||""}else if(D.category.includes("memo")){const A=a.find(R=>R.memo_number===S);F=(A==null?void 0:A.supplier)||""}return{...D,reference_id:S,reference_name:F}}),p(!1)},I=()=>{v({name:c.reference_name,type:c.type==="debit"?"expense":"income",description:""}),j(!0),p(!1)},h=S=>{S.preventDefault(),m(D=>({...D,reference_name:B.name})),j(!1),v({name:"",type:"expense",description:""})},g=S=>{const{name:D,value:F}=S.target;v(A=>({...A,[D]:F}))};return t.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Edit Banking Entry":"New Banking Entry"}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-6 h-6"})})]}),t.jsxs("form",{onSubmit:q,className:"p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Entry Type"}),t.jsxs("select",{name:"type",value:c.type,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[t.jsx("option",{value:"credit",children:"Credit (Money In)"}),t.jsx("option",{value:"debit",children:"Debit (Money Out)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),t.jsx("select",{name:"category",value:c.category,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:K().map(S=>t.jsx("option",{value:S.value,children:S.label},S.value))})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount (â‚¹)"}),t.jsx("input",{type:"number",name:"amount",value:c.amount,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",name:"date",value:c.date,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),$()&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c.category.includes("bill")?"Bill Number":"Memo Number"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"reference_id",value:c.reference_id,onChange:G,onFocus:()=>p(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:c.category.includes("bill")?"Select Bill Number":"Select Memo Number",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>p(!y)}),y&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:se().map((S,D)=>t.jsx("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer",onClick:()=>Y(S),children:S},D))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c.category.includes("bill")?"Party Name":"Supplier Name"}),t.jsx("input",{type:"text",name:"reference_name",value:c.reference_name,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:c.category.includes("bill")?"Enter Party Name":"Enter Supplier Name",required:!0})]})]}),Q()&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Vehicle (Own Vehicles Only)"}),t.jsxs("select",{name:"vehicle_no",value:c.vehicle_no,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[t.jsx("option",{value:"",children:"Select Vehicle"}),X().map(S=>t.jsxs("option",{value:S.vehicle_no,children:[S.vehicle_no," (",S.vehicle_type,")"]},S.id))]})]}),!$()&&!Q()&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c.category==="fuel_wallet"?"Fuel Wallet Name":c.type==="debit"&&(c.category==="expense"||c.category==="other")||c.type==="credit"&&c.category==="other"?"Select Ledger Account":"Reference Name"}),c.category==="fuel_wallet"?t.jsxs("select",{name:"reference_name",value:c.reference_name,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[t.jsx("option",{value:"",children:"Select Fuel Wallet"}),t.jsx("option",{value:"BPCL",children:"BPCL"}),t.jsx("option",{value:"HPCL",children:"HPCL"}),t.jsx("option",{value:"IOCL",children:"IOCL"}),t.jsx("option",{value:"Shell",children:"Shell"}),t.jsx("option",{value:"Essar",children:"Essar"})]}):c.type==="debit"&&(c.category==="expense"||c.category==="other")||c.type==="credit"&&c.category==="other"?t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",name:"reference_name",value:c.reference_name,onChange:G,onFocus:()=>p(!0),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:c.type==="credit"?"Select income ledger or enter new name":"Select existing ledger or enter new name",required:!0}),t.jsx(ua,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>p(!y)}),y&&L.length>0&&t.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[L.filter(S=>S&&S.toLowerCase().includes((c.reference_name||"").toLowerCase())).map((S,D)=>t.jsx("div",{className:"px-4 py-2 hover:bg-blue-50 cursor-pointer",onClick:()=>{m(F=>({...F,reference_name:S||""})),p(!1)},children:S},D)),c.reference_name&&!L.some(S=>S&&S.toLowerCase()===c.reference_name.toLowerCase())&&t.jsxs("div",{className:"px-4 py-2 text-blue-600 hover:bg-blue-50 cursor-pointer border-t flex items-center space-x-2",onClick:I,children:[t.jsx(Kr,{className:"w-4 h-4"}),t.jsxs("span",{children:['Create new ledger: "',c.reference_name,'"']})]})]})]}):t.jsx("input",{type:"text",name:"reference_name",value:c.reference_name,onChange:G,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter name or description",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Narration"}),t.jsx("textarea",{name:"narration",value:c.narration,onChange:G,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter transaction details...",required:!0})]}),t.jsx("div",{className:`p-4 rounded-lg ${c.type==="credit"?"bg-green-50":"bg-red-50"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Yn,{className:`w-5 h-5 ${c.type==="credit"?"text-green-600":"text-red-600"}`}),t.jsx("span",{className:`font-medium ${c.type==="credit"?"text-green-900":"text-red-900"}`,children:c.type==="credit"?"Credit Entry":"Debit Entry"})]}),t.jsxs("span",{className:`text-xl font-bold ${c.type==="credit"?"text-green-900":"text-red-900"}`,children:[c.type==="credit"?"+":"-",me(c.amount)]})]})}),t.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:r?"Update Entry":"Create Entry"})]})]})]}),_&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Ledger Account"}),t.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ledger Account Name"}),t.jsx("input",{type:"text",name:"name",value:B.name,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter ledger account name",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Type"}),t.jsxs("select",{name:"type",value:B.type,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[t.jsx("option",{value:"expense",children:"Expense Account"}),t.jsx("option",{value:"income",children:"Income Account"}),t.jsx("option",{value:"asset",children:"Asset Account"}),t.jsx("option",{value:"liability",children:"Liability Account"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),t.jsx("textarea",{name:"description",value:B.description,onChange:g,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter description for this ledger account"})]}),t.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-4 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-4 h-4"}),t.jsx("span",{children:"Create Ledger"})]})]})]})]})})]})},Wh=()=>{const{bankingEntries:n,addBankingEntry:e,updateBankingEntry:r,deleteBankingEntry:a}=tr(),[s,i]=pe.useState(!1),[l,u]=pe.useState(null),[c,m]=pe.useState(""),[b,w]=pe.useState("all"),[y,p]=pe.useState({start:"",end:""}),[_,j]=pe.useState("statement"),B=async h=>{try{const g=await Fe.createBankingEntry(h);e(g.bankingEntry),console.log("Banking entry created and synced:",g.bankingEntry)}catch(g){console.error("Failed to create banking entry:",g);const S={...h,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};e(S)}i(!1)},v=async h=>{if(l){try{const g=await Fe.updateBankingEntry(l.id,h);r(l.id,g.bankingEntry),console.log("Banking entry updated and synced:",g.bankingEntry)}catch(g){console.error("Failed to update banking entry:",g);const S={...h,id:l.id,created_at:l.created_at,updated_at:new Date().toISOString()};r(l.id,S)}u(null),i(!1)}},L=h=>{u(h),i(!0)},q=()=>{u(null),i(!1)},G=async h=>{if(!h){console.error("No ID provided for deletion");return}if(window.confirm("Are you sure you want to delete this entry?"))try{console.log("Attempting to delete banking entry with ID:",h),a(h),console.log("Banking entry deleted locally"),await Fe.deleteBankingEntry(h),console.log("Banking entry deleted from backend"),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(g){console.error("Failed to delete banking entry from backend:",g),window.dispatchEvent(new CustomEvent("data-sync-required"))}},K=pe.useMemo(()=>{let h=[...n];if(b!=="all"){const g=new Date,S=new Date(g.getFullYear(),g.getMonth(),g.getDate());h=h.filter(D=>{const F=new Date(D.date),A=new Date(F.getFullYear(),F.getMonth(),F.getDate());switch(b){case"today":return A.getTime()===S.getTime();case"week":const R=new Date(S);return R.setDate(R.getDate()-7),A>=R;case"month":return F.getMonth()===g.getMonth()&&F.getFullYear()===g.getFullYear();case"custom":if(!y.start||!y.end)return!0;const J=new Date(y.start),re=new Date(y.end);return A>=J&&A<=re;default:return!0}})}if(c.trim()){const g=c.toLowerCase();h=h.filter(S=>{const D=new Date(S.date).toLocaleDateString("en-IN"),F=String(S.amount),A=me(S.amount);return[D,S.type,S.category,S.reference_id||"",S.reference_name||"",F,A,S.narration||""].join(" ").toLowerCase().includes(g)})}return h.sort((g,S)=>new Date(S.date).getTime()-new Date(g.date).getTime())},[n,c,b,y]),$=K.filter(h=>h.payment_mode!=="cash"),Q=$.filter(h=>h.type==="credit").reduce((h,g)=>h+g.amount,0),X=$.filter(h=>h.type==="debit").reduce((h,g)=>h+g.amount,0),se=Q-X,Y=pe.useMemo(()=>{const h=$.reduce((D,F)=>{const A=new Date(F.date).toDateString();return D[A]||(D[A]=[]),D[A].push(F),D},{});let g=0;return Object.keys(h).sort((D,F)=>new Date(D).getTime()-new Date(F).getTime()).map(D=>{const F=h[D],A=g,R=F.sort((k,z)=>new Date(k.created_at).getTime()-new Date(z.created_at).getTime()),J=R.filter(k=>k.type==="credit").reduce((k,z)=>k+z.amount,0),re=R.filter(k=>k.type==="debit").reduce((k,z)=>k+z.amount,0),ve=A+J-re;return g=ve,{date:D,entries:R,openingBalance:A,closingBalance:ve,dayCredits:J,dayDebits:re}})},[$]),I=()=>{const h=Y.map(F=>{const A=[`Date: ${new Date(F.date).toLocaleDateString("en-IN")}`,,,,,,`Opening Balance:,${me(F.openingBalance)}`,,,,,,"Time,Type,Category,Reference,Amount,Narration,Running Balance"];let R=F.openingBalance;return F.entries.forEach(J=>{const re=J.type==="credit"?J.amount:-J.amount;R+=re,A.push(`${new Date(J.created_at).toLocaleTimeString("en-IN")},${J.type},${J.category},${J.reference_id||J.reference_name||""},${me(J.amount)},${J.narration||""},${me(R)}`)}),A.push(`Closing Balance:,${me(F.closingBalance)}`),A.push(""),A.join(`
`)}).join(`
`),g=new Blob([h],{type:"text/csv"}),S=window.URL.createObjectURL(g),D=document.createElement("a");D.href=S,D.download=`bank-statement-${new Date().toISOString().split("T")[0]}.csv`,D.click(),window.URL.revokeObjectURL(S)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Banking"}),t.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[t.jsx("div",{className:"flex-1 min-w-[240px] max-w-xl",children:t.jsxs("div",{className:"relative",children:[t.jsx($c,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),t.jsx("input",{type:"text",value:c,onChange:h=>m(h.target.value),placeholder:"Search by narration, category, type, amount, reference, date",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xs,{className:"w-4 h-4 text-gray-400"}),t.jsxs("select",{value:b,onChange:h=>w(h.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[t.jsx("option",{value:"all",children:"All Time"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"week",children:"This Week"}),t.jsx("option",{value:"month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]})]}),b==="custom"&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"date",value:y.start,onChange:h=>p(g=>({...g,start:h.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),t.jsx("span",{className:"text-gray-400",children:"to"}),t.jsx("input",{type:"date",value:y.end,onChange:h=>p(g=>({...g,end:h.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),t.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>j("statement"),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${_==="statement"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Statement"}),t.jsx("button",{onClick:()=>j("list"),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${_==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"List"})]}),t.jsxs("button",{onClick:I,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[t.jsx(Ar,{className:"w-4 h-4"}),t.jsx("span",{children:"Export"})]}),t.jsxs("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-5 h-5"}),t.jsx("span",{children:"New Entry"})]})]})]}),s&&t.jsx(bd,{onSubmit:l?v:B,onCancel:q,editingEntry:l}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Credits"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-2",children:me(Q)})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx(zi,{className:"w-6 h-6 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Debits"}),t.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2",children:me(X)})]}),t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx(Ti,{className:"w-6 h-6 text-red-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Balance"}),t.jsx("p",{className:`text-2xl font-bold mt-2 ${se>=0?"text-green-600":"text-red-600"}`,children:me(se)})]}),t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx(Yn,{className:"w-6 h-6 text-blue-600"})})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:_==="statement"?"Bank Statement":"Banking Entries"})}),t.jsx("div",{className:"overflow-x-auto",children:n.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-12",children:[t.jsx(Yn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No banking entries found"}),t.jsx("p",{className:"text-sm",children:"Add your first banking entry to get started"})]}):K.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-12",children:[t.jsx(Yn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No entries match your search"}),t.jsx("p",{className:"text-sm",children:"Try adjusting your search terms"})]}):_==="statement"?t.jsx("div",{className:"space-y-6 p-6",children:Y.map(h=>t.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(nl,{className:"w-5 h-5 text-gray-400"}),t.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:new Date(h.date).toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),t.jsxs("div",{className:"text-sm text-gray-600",children:[h.entries.length," transaction",h.entries.length!==1?"s":""]})]})}),t.jsx("div",{className:"px-6 py-3 bg-blue-50 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Opening Balance"}),t.jsx("span",{className:`text-sm font-semibold ${h.openingBalance>=0?"text-green-600":"text-red-600"}`,children:me(h.openingBalance)})]})}),t.jsx("div",{className:"divide-y divide-gray-200",children:h.entries.map((g,S)=>{let D=h.openingBalance;for(let F=0;F<=S;F++){const A=h.entries[F];D+=A.type==="credit"?A.amount:-A.amount}return t.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("span",{className:"text-xs text-gray-500",children:new Date(g.created_at).toLocaleTimeString("en-IN")}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.type==="credit"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.type==="credit"?"Credit":"Debit"}),t.jsx("span",{className:"text-sm text-gray-900 capitalize",children:g.category.replace("_"," ")})]}),t.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[g.reference_id&&t.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.reference_id}),g.reference_name&&t.jsx("span",{className:"text-sm text-gray-500",children:g.reference_name}),g.narration&&t.jsxs("span",{className:"text-sm text-gray-600",children:["â€¢ ",g.narration]})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("span",{className:`text-sm font-semibold ${g.type==="credit"?"text-green-600":"text-red-600"}`,children:[g.type==="credit"?"+":"-",me(g.amount)]}),t.jsx("span",{className:`text-sm font-medium ${D>=0?"text-green-600":"text-red-600"}`,children:me(D)}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>L(g),className:"inline-flex items-center px-2 py-1 text-xs text-white bg-blue-600 hover:bg-blue-700 rounded",title:"Edit entry",children:[t.jsx(pa,{className:"w-3 h-3 mr-1"})," Edit"]}),t.jsxs("button",{onClick:()=>G(g._id||g.id),className:"inline-flex items-center px-2 py-1 text-xs text-white bg-red-600 hover:bg-red-700 rounded",title:"Delete entry",children:[t.jsx(al,{className:"w-3 h-3 mr-1"})," Delete"]})]})]})]})},`${g.id}-${S}`)})}),t.jsx("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Closing Balance"}),t.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[t.jsxs("span",{children:["Credits: ",me(h.dayCredits)]}),t.jsx("span",{children:"â€¢"}),t.jsxs("span",{children:["Debits: ",me(h.dayDebits)]})]})]}),t.jsx("span",{className:`text-sm font-semibold ${h.closingBalance>=0?"text-green-600":"text-red-600"}`,children:me(h.closingBalance)})]})})]},h.date))}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reference"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Narration"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(h=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(nl,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{children:new Date(h.date).toLocaleDateString("en-IN")})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${h.type==="credit"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.type==="credit"?"Credit":"Debit"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize",children:h.category.replace("_"," ")}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.jsxs("div",{children:[h.reference_id&&t.jsx("div",{className:"font-medium",children:h.reference_id}),t.jsx("div",{className:"text-gray-500",children:h.reference_name})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("span",{className:h.type==="credit"?"text-green-600":"text-red-600",children:[h.type==="credit"?"+":"-",me(h.amount)]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:h.narration}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>L(h),className:"inline-flex items-center px-2 py-1 text-xs text-white bg-blue-600 hover:bg-blue-700 rounded",title:"Edit entry",children:[t.jsx(pa,{className:"w-3 h-3 mr-1"})," Edit"]}),t.jsxs("button",{onClick:()=>G(h.id),className:"inline-flex items-center px-2 py-1 text-xs text-white bg-red-600 hover:bg-red-700 rounded",title:"Delete entry",children:[t.jsx(al,{className:"w-3 h-3 mr-1"})," Delete"]})]})})]},h.id))})]})})]})]})},Gh=()=>{const{cashbookEntries:n,updateCashbookEntry:e,setCashbookEntries:r}=tr(),[a,s]=pe.useState(!1),[i,l]=pe.useState(null);pe.useEffect(()=>{(async()=>{try{console.log("ðŸ”„ Refreshing cashbook data on component mount...");const j=await Fe.getCashbookEntries();j.cashbookEntries&&(r(j.cashbookEntries),console.log("âœ… Cashbook data refreshed:",j.cashbookEntries.length,"entries"))}catch(j){console.error("âŒ Failed to refresh cashbook data:",j)}})()},[r]);const u=async _=>{try{if(i){const j={..._,payment_mode:"cash",id:i.id,created_at:i.created_at};e(j),l(null)}else{const j={..._,payment_mode:"cash"},v=(await Fe.createCashbookEntry(j)).cashbookEntry;r([v,...n]);const L={referenceId:v._id,reference_id:v._id,ledger_type:"general",reference_name:v.reference_name||v.category||"Cash Transaction",source_type:"cashbook",type:"expense",date:v.date,description:v.narration||v.category,debit:v.type==="debit"?v.amount:0,credit:v.type==="credit"?v.amount:0,balance:0};await Fe.createLedgerEntry(L),window.dispatchEvent(new CustomEvent("data-sync-required"))}s(!1)}catch(j){console.error("Failed to create cashbook entry:",j)}},c=_=>{l(_),s(!0)},m=()=>{l(null),s(!1)},b=n.filter(_=>_.type==="credit").reduce((_,j)=>_+j.amount,0),w=n.filter(_=>_.type==="debit").reduce((_,j)=>_+j.amount,0),y=b-w,p=async _=>{if(window.confirm("Delete this cashbook entry? This will also remove related ledger entries."))try{console.log("ðŸ—‘ï¸ Attempting to delete cashbook entry with ID:",_);const j=n.find(G=>G._id===_||G.id===_);if(!j){console.error("Entry not found in local store:",_),alert("Entry not found. Please refresh and try again.");return}const B=j._id||j.id;console.log("Using delete ID:",B);const v=await Fe.deleteCashbookEntry(B);console.log("Delete response:",v),r(n.filter(G=>G._id!==B&&G.id!==B));const q=(await Fe.getLedgerEntries()).ledgerEntries.filter(G=>(G.reference_id===B||G.reference_id===_)&&G.source_type==="cashbook");console.log("Found related ledger entries:",q.length);for(const G of q)try{await Fe.deleteLedgerEntry(G._id),console.log("Deleted ledger entry:",G._id)}catch(K){console.warn("Failed to delete ledger entry:",G._id,K)}window.dispatchEvent(new CustomEvent("data-sync-required")),console.log("âœ… Cashbook entry deleted successfully")}catch(j){console.error("âŒ Failed to delete cashbook entry:",j),j instanceof Error&&j.message.includes("404")?(r(n.filter(B=>B._id!==_&&B.id!==_)),window.dispatchEvent(new CustomEvent("data-sync-required")),console.log("Entry was already deleted from backend, removed from local store")):alert("Failed to delete cashbook entry. Please try again.")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cashbook"}),t.jsxs("button",{onClick:()=>s(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-5 h-5"}),t.jsx("span",{children:"New Entry"})]})]}),a&&t.jsx(bd,{onSubmit:u,onCancel:m,editingEntry:i}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Credits"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-2",children:me(b)})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx(zi,{className:"w-6 h-6 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Debits"}),t.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2",children:me(w)})]}),t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx(Ti,{className:"w-6 h-6 text-red-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Balance"}),t.jsx("p",{className:`text-2xl font-bold mt-2 ${y>=0?"text-green-600":"text-red-600"}`,children:me(y)})]}),t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx(Yn,{className:"w-6 h-6 text-blue-600"})})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cashbook Entries"})}),t.jsx("div",{className:"overflow-x-auto",children:n.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-12",children:[t.jsx(Yn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No cashbook entries found"}),t.jsx("p",{className:"text-sm",children:"Add your first cashbook entry to get started"})]}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reference"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Narration"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(_=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(nl,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{children:new Date(_.date).toLocaleDateString("en-IN")})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.type==="credit"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.type==="credit"?"Credit":"Debit"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize",children:_.category.replace("_"," ")}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.jsxs("div",{children:[_.reference_id&&t.jsx("div",{className:"font-medium",children:_.reference_id}),t.jsx("div",{className:"text-gray-500",children:_.reference_name})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("span",{className:_.type==="credit"?"text-green-600":"text-red-600",children:[_.type==="credit"?"+":"-",me(_.amount)]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:_.narration}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>c(_),className:"inline-flex items-center px-2 py-1 text-xs text-white bg-blue-600 hover:bg-blue-700 rounded",title:"Edit entry",children:[t.jsx(pa,{className:"w-3 h-3 mr-1"})," Edit"]}),t.jsxs("button",{onClick:()=>p(_.id),className:"inline-flex items-center px-2 py-1 text-xs text-white bg-red-600 hover:bg-red-700 rounded",title:"Delete entry",children:[t.jsx(al,{className:"w-3 h-3 mr-1"})," Delete"]})]})})]},_.id))})]})})]})]})},Yh=(n,e,r)=>{const a=e.filter(m=>m.party===n),s=a.reduce((m,b)=>{const w=b.bill_amount+(b.detention||0)+(b.extra||0)+(b.rto||0)-(b.mamool||0)-(b.penalties||0)-(b.tds||0);return m+w},0),i=r.filter(m=>(m.category==="bill_payment"||m.category==="bill_advance")&&a.some(b=>b.bill_number===m.reference_id)),l=i.filter(m=>m.category==="bill_payment").reduce((m,b)=>m+b.amount,0),u=i.filter(m=>m.category==="bill_advance").reduce((m,b)=>m+b.amount,0),c=s-(l+u);return{partyName:n,totalBills:s,totalPayments:l,totalAdvances:u,outstandingAmount:c}},Jh=(n,e,r)=>{const a=e.filter(p=>p.supplier===n),s=a.reduce((p,_)=>p+_.freight,0),i=a.reduce((p,_)=>p+(_.detention||0),0),l=a.reduce((p,_)=>p+(_.extra||0),0),u=a.reduce((p,_)=>p+(_.commission||0),0),c=a.reduce((p,_)=>p+(_.mamool||0),0),m=r.filter(p=>(p.category==="memo_payment"||p.category==="memo_advance")&&a.some(_=>_.memo_number===p.reference_id)),b=m.filter(p=>p.category==="memo_payment").reduce((p,_)=>p+_.amount,0),w=m.filter(p=>p.category==="memo_advance").reduce((p,_)=>p+_.amount,0),y=s-w-u-c+l+i;return{supplierName:n,totalMemos:s,totalDetention:i,totalExtraWeight:l,totalPayments:b,totalAdvances:w,totalCommission:u,totalMamul:c,outstandingAmount:y}},Xh=(n,e)=>Array.from(new Set(n.map(a=>a.party))).map(a=>Yh(a,n,e)).sort((a,s)=>s.outstandingAmount-a.outstandingAmount),Kh=(n,e,r,a)=>{let s=n;return Array.from(new Set(s.map(l=>l.supplier))).map(l=>Jh(l,s,e)).sort((l,u)=>u.outstandingAmount-l.outstandingAmount)};function vd(n,e,r,a,s){a=a||{};var i=1.15,l=s.internal.scaleFactor,u=s.internal.getFontSize()/l,c=s.getLineHeightFactor?s.getLineHeightFactor():i,m=u*c,b=/\r\n|\r|\n/g,w="",y=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(w=typeof n=="string"?n.split(b):n,y=w.length||1),r+=u*(2-i),a.valign==="middle"?r-=y/2*m:a.valign==="bottom"&&(r-=y*m),a.halign==="center"||a.halign==="right"){var p=u;if(a.halign==="center"&&(p*=.5),w&&y>=1){for(var _=0;_<w.length;_++)s.text(w[_],e-s.getStringUnitWidth(w[_])*p,r),r+=m;return s}e-=s.getStringUnitWidth(n)*p}return a.halign==="justify"?s.text(n,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):s.text(n,e,r),s}var kc={},ti=function(){function n(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return n.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:kc=e},n.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},n.prototype.applyStyles=function(e,r){var a,s,i;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),u=l.fontStyle,c=l.fontName;if(e.font&&(c=e.font),e.fontStyle){u=e.fontStyle;var m=this.getFontList()[c];m&&m.indexOf(u)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(m[0]),u=m[0])}if(this.jsPDFDocument.setFont(c,u),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var b=n.unifyColor(e.fillColor);b&&(a=this.jsPDFDocument).setFillColor.apply(a,b),b=n.unifyColor(e.textColor),b&&(s=this.jsPDFDocument).setTextColor.apply(s,b),b=n.unifyColor(e.lineColor),b&&(i=this.jsPDFDocument).setDrawColor.apply(i,b),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},n.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},n.prototype.rect=function(e,r,a,s,i){return this.jsPDFDocument.rect(e,r,a,s,i)},n.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},n.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},n.prototype.getDocument=function(){return this.jsPDFDocument},n.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},n.prototype.addPage=function(){return this.jsPDFDocument.addPage()},n.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},n.prototype.getGlobalOptions=function(){return kc||{}},n.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},n.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},n.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},n.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},n.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},n.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},n}(),gl=function(n,e){return gl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])},gl(n,e)};function yd(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");gl(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var wd=function(n){yd(e,n);function e(r){var a=n.call(this)||this;return a._element=r,a}return e}(Array);function Zh(n){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/n,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Qh(n){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[n]}function Gs(n,e,r){r.applyStyles(e,!0);var a=Array.isArray(n)?n:[n],s=a.map(function(i){return r.getTextWidth(i)}).reduce(function(i,l){return Math.max(i,l)},0);return s}function Nd(n,e,r,a){var s=e.settings.tableLineWidth,i=e.settings.tableLineColor;n.applyStyles({lineWidth:s,lineColor:i});var l=jd(s,!1);l&&n.rect(r.x,r.y,e.getWidth(n.pageSize().width),a.y-r.y,l)}function jd(n,e){var r=n>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function eo(n,e){var r,a,s,i;if(n=n||e,Array.isArray(n)){if(n.length>=4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===3)return{top:n[0],right:n[1],bottom:n[2],left:n[1]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]};n.length===1?n=n[0]:n=e}return typeof n=="object"?(typeof n.vertical=="number"&&(n.top=n.vertical,n.bottom=n.vertical),typeof n.horizontal=="number"&&(n.right=n.horizontal,n.left=n.horizontal),{left:(r=n.left)!==null&&r!==void 0?r:e,top:(a=n.top)!==null&&a!==void 0?a:e,right:(s=n.right)!==null&&s!==void 0?s:e,bottom:(i=n.bottom)!==null&&i!==void 0?i:e}):(typeof n!="number"&&(n=e),{top:n,right:n,bottom:n,left:n})}function _d(n,e){var r=eo(e.settings.margin,0);return n.pageSize().width-(r.left+r.right)}function e0(n,e,r,a,s){var i={},l=1.3333333333333333,u=Qo(e,function(q){return s.getComputedStyle(q).backgroundColor});u!=null&&(i.fillColor=u);var c=Qo(e,function(q){return s.getComputedStyle(q).color});c!=null&&(i.textColor=c);var m=r0(a,r);m&&(i.cellPadding=m);var b="borderTopColor",w=l*r,y=a.borderTopWidth;if(a.borderBottomWidth===y&&a.borderRightWidth===y&&a.borderLeftWidth===y){var p=(parseFloat(y)||0)/w;p&&(i.lineWidth=p)}else i.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/w,right:(parseFloat(a.borderRightWidth)||0)/w,bottom:(parseFloat(a.borderBottomWidth)||0)/w,left:(parseFloat(a.borderLeftWidth)||0)/w},i.lineWidth.top||(i.lineWidth.right?b="borderRightColor":i.lineWidth.bottom?b="borderBottomColor":i.lineWidth.left&&(b="borderLeftColor"));var _=Qo(e,function(q){return s.getComputedStyle(q)[b]});_!=null&&(i.lineColor=_);var j=["left","right","center","justify"];j.indexOf(a.textAlign)!==-1&&(i.halign=a.textAlign),j=["middle","bottom","top"],j.indexOf(a.verticalAlign)!==-1&&(i.valign=a.verticalAlign);var B=parseInt(a.fontSize||"");isNaN(B)||(i.fontSize=B/l);var v=t0(a);v&&(i.fontStyle=v);var L=(a.fontFamily||"").toLowerCase();return n.indexOf(L)!==-1&&(i.font=L),i}function t0(n){var e="";return(n.fontWeight==="bold"||n.fontWeight==="bolder"||parseInt(n.fontWeight)>=700)&&(e="bold"),(n.fontStyle==="italic"||n.fontStyle==="oblique")&&(e+="italic"),e}function Qo(n,e){var r=Sd(n,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var s=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],i=parseInt(a[4]);return i===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function Sd(n,e){var r=e(n);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?n.parentElement==null?null:Sd(n.parentElement,e):r}function r0(n,e){var r=[n.paddingTop,n.paddingRight,n.paddingBottom,n.paddingLeft],a=96/(72/e),s=(parseInt(n.lineHeight)-parseInt(n.fontSize))/e/2,i=r.map(function(u){return parseInt(u||"0")/a}),l=eo(i,0);return s>l.top&&(l.top=s),s>l.bottom&&(l.bottom=s),l}function Ld(n,e,r,a,s){var i,l;a===void 0&&(a=!1),s===void 0&&(s=!1);var u;typeof e=="string"?u=r.document.querySelector(e):u=e;var c=Object.keys(n.getFontList()),m=n.scaleFactor(),b=[],w=[],y=[];if(!u)return console.error("Html table could not be found with input: ",e),{head:b,body:w,foot:y};for(var p=0;p<u.rows.length;p++){var _=u.rows[p],j=(l=(i=_==null?void 0:_.parentElement)===null||i===void 0?void 0:i.tagName)===null||l===void 0?void 0:l.toLowerCase(),B=n0(c,m,r,_,a,s);B&&(j==="thead"?b.push(B):j==="tfoot"?y.push(B):w.push(B))}return{head:b,body:w,foot:y}}function n0(n,e,r,a,s,i){for(var l=new wd(a),u=0;u<a.cells.length;u++){var c=a.cells[u],m=r.getComputedStyle(c);if(s||m.display!=="none"){var b=void 0;i&&(b=e0(n,c,e,m,r)),l.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:b,_element:c,content:a0(c)})}}var w=r.getComputedStyle(a);if(l.length>0&&(s||w.display!=="none"))return l}function a0(n){var e=n.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function i0(n,e,r){for(var a=0,s=[n,e,r];a<s.length;a++){var i=s[a];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function An(n,e,r,a,s){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(n),l=1;l<arguments.length;l++){var u=arguments[l];if(u!=null)for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(i[c]=u[c])}return i}function s0(n,e){var r=new ti(n),a=r.getDocumentOptions(),s=r.getGlobalOptions();i0(s,a,e);var i=An({},s,a,e),l;typeof window<"u"&&(l=window);var u=o0(s,a,e),c=l0(s,a,e),m=c0(r,i),b=u0(r,i,l);return{id:e.tableId,content:b,hooks:c,styles:u,settings:m}}function o0(n,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var m=n[c],b=e[c],w=r[c];a.columnStyles=An({},m,b,w)}else{var y=[n,e,r],p=y.map(function(_){return _[c]||{}});a[c]=An({},p[0],p[1],p[2])}},i=0,l=Object.keys(a);i<l.length;i++){var u=l[i];s(u)}return a}function l0(n,e,r){for(var a=[n,e,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,l=a;i<l.length;i++){var u=l[i];u.didParseCell&&s.didParseCell.push(u.didParseCell),u.willDrawCell&&s.willDrawCell.push(u.willDrawCell),u.didDrawCell&&s.didDrawCell.push(u.didDrawCell),u.willDrawPage&&s.willDrawPage.push(u.willDrawPage),u.didDrawPage&&s.didDrawPage.push(u.didDrawPage)}return s}function c0(n,e){var r,a,s,i,l,u,c,m,b,w,y,p,_=eo(e.margin,40/n.scaleFactor()),j=(r=d0(n,e.startY))!==null&&r!==void 0?r:_.top,B;e.showFoot===!0?B="everyPage":e.showFoot===!1?B="never":B=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(s=e.showHead)!==null&&s!==void 0?s:"everyPage";var L=(i=e.useCss)!==null&&i!==void 0?i:!1,q=e.theme||(L?"plain":"striped"),G=!!e.horizontalPageBreak,K=(l=e.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(u=e.includeHiddenHtml)!==null&&u!==void 0?u:!1,useCss:L,theme:q,startY:j,margin:_,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(m=e.rowPageBreak)!==null&&m!==void 0?m:"auto",tableWidth:(b=e.tableWidth)!==null&&b!==void 0?b:"auto",showHead:v,showFoot:B,tableLineWidth:(w=e.tableLineWidth)!==null&&w!==void 0?w:0,tableLineColor:(y=e.tableLineColor)!==null&&y!==void 0?y:200,horizontalPageBreak:G,horizontalPageBreakRepeat:K,horizontalPageBreakBehaviour:(p=e.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function d0(n,e){var r=n.getLastAutoTable(),a=n.scaleFactor(),s=n.pageNumber(),i=!1;if(r&&r.startPageNumber){var l=r.startPageNumber+r.pageNumber-1;i=l===s}return typeof e=="number"?e:(e==null||e===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/a:null}function u0(n,e,r){var a=e.head||[],s=e.body||[],i=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(r){var u=Ld(n,e.html,r,l,e.useCss)||{};a=u.head||a,s=u.body||a,i=u.foot||a}else console.error("Cannot parse html in non browser environment")}var c=e.columns||h0(a,s,i);return{columns:c,head:a,body:s,foot:i}}function h0(n,e,r){var a=n[0]||e[0]||r[0]||[],s=[];return Object.keys(a).filter(function(i){return i!=="_element"}).forEach(function(i){var l=1,u;Array.isArray(a)?u=a[parseInt(i)]:u=a[i],typeof u=="object"&&!Array.isArray(u)&&(l=(u==null?void 0:u.colSpan)||1);for(var c=0;c<l;c++){var m=void 0;Array.isArray(a)?m=s.length:m=i+(c>0?"_".concat(c):"");var b={dataKey:m};s.push(b)}}),s}var xl=function(){function n(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return n}(),f0=function(n){yd(e,n);function e(r,a,s,i,l,u){var c=n.call(this,r,a,u)||this;return c.cell=s,c.row=i,c.column=l,c.section=i.section,c}return e}(xl),p0=function(){function n(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return n.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},n.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},n.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},n.prototype.callCellHooks=function(e,r,a,s,i,l){for(var u=0,c=r;u<c.length;u++){var m=c[u],b=new f0(e,this,a,s,i,l),w=m(b)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],w)return!1}return!0},n.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,s=this.hooks.didDrawPage;a<s.length;a++){var i=s[a];i(new xl(e,this,r))}},n.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,s=this.hooks.willDrawPage;a<s.length;a++){var i=s[a];i(new xl(e,this,r))}},n.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,i){return s+i.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},n}(),Ad=function(){function n(e,r,a,s,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof wd&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=s,this.spansMultiplePages=i}return n.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,s){var i;return Math.max(a,((i=r.cells[s.index])===null||i===void 0?void 0:i.height)||0)},0)},n.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var s=r.cells[a.index];return s?s.rowSpan>1:!1}).length>0},n.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},n.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(s,i){var l=a.cells[i.index];if(!l)return 0;var u=r.getLineHeight(l.styles.fontSize),c=l.padding("vertical"),m=c+u;return m>s?m:s},0)},n}(),kd=function(){function n(e,r,a){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(s=e.content)!==null&&s!==void 0?s:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var l=i!=null?""+i:"",u=/\r\n|\r|\n/g;this.text=l.split(u)}return n.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");a=this.x+s/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},n.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/e*r,i=a*s+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},n.prototype.padding=function(e){var r=eo(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},n}(),m0=function(){function n(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return n.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,s=e.allRows();a<s.length;a++){var i=s[a],l=i.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(r=Math.max(r,l.styles.cellWidth))}return r},n}();function g0(n,e){x0(n,e);var r=[],a=0;e.columns.forEach(function(i){var l=i.getMaxCustomCellWidth(e);l?i.width=l:(i.width=i.wrappedWidth,r.push(i)),a+=i.width});var s=e.getWidth(n.pageSize().width)-a;s&&(s=bl(r,s,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),s&&(s=bl(r,s,function(i){return i.minWidth})),s=Math.abs(s),!e.settings.horizontalPageBreak&&s>.1/n.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),v0(e),y0(e,n),b0(e)}function x0(n,e){var r=n.scaleFactor(),a=e.settings.horizontalPageBreak,s=_d(n,e);e.allRows().forEach(function(i){for(var l=0,u=e.columns;l<u.length;l++){var c=u[l],m=i.cells[c.index];if(m){var b=e.hooks.didParseCell;e.callCellHooks(n,b,m,i,c,null);var w=m.padding("horizontal");m.contentWidth=Gs(m.text,m.styles,n)+w;var y=Gs(m.text.join(" ").split(/[^\S\u00A0]+/),m.styles,n);if(m.minReadableWidth=y+m.padding("horizontal"),typeof m.styles.cellWidth=="number")m.minWidth=m.styles.cellWidth,m.wrappedWidth=m.styles.cellWidth;else if(m.styles.cellWidth==="wrap"||a===!0)m.contentWidth>s?(m.minWidth=s,m.wrappedWidth=s):(m.minWidth=m.contentWidth,m.wrappedWidth=m.contentWidth);else{var p=10/r;m.minWidth=m.styles.minCellWidth||p,m.wrappedWidth=m.contentWidth,m.minWidth>m.wrappedWidth&&(m.wrappedWidth=m.minWidth)}}}}),e.allRows().forEach(function(i){for(var l=0,u=e.columns;l<u.length;l++){var c=u[l],m=i.cells[c.index];if(m&&m.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,m.wrappedWidth),c.minWidth=Math.max(c.minWidth,m.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,m.minReadableWidth);else{var b=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},w=b.cellWidth||b.minCellWidth;w&&typeof w=="number"&&(c.minWidth=w,c.wrappedWidth=w)}m&&(m.colSpan>1&&!c.minWidth&&(c.minWidth=m.minWidth),m.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=m.minWidth))}})}function bl(n,e,r){for(var a=e,s=n.reduce(function(p,_){return p+_.wrappedWidth},0),i=0;i<n.length;i++){var l=n[i],u=l.wrappedWidth/s,c=a*u,m=l.width+c,b=r(l),w=m<b?b:m;e-=w-l.width,l.width=w}if(e=Math.round(e*1e10)/1e10,e){var y=n.filter(function(p){return e<0?p.width>r(p):!0});y.length&&(e=bl(y,e,r))}return e}function b0(n){for(var e={},r=1,a=n.allRows(),s=0;s<a.length;s++)for(var i=a[s],l=0,u=n.columns;l<u.length;l++){var c=u[l],m=e[c.index];if(r>1)r--,delete i.cells[c.index];else if(m)m.cell.height+=i.height,r=m.cell.colSpan,delete i.cells[c.index],m.left--,m.left<=1&&delete e[c.index];else{var b=i.cells[c.index];if(!b)continue;if(b.height=i.height,b.rowSpan>1){var w=a.length-s,y=b.rowSpan>w?w:b.rowSpan;e[c.index]={cell:b,left:y,row:i}}}}}function v0(n){for(var e=n.allRows(),r=0;r<e.length;r++)for(var a=e[r],s=null,i=0,l=0,u=0;u<n.columns.length;u++){var c=n.columns[u];if(l-=1,l>1&&n.columns[u+1])i+=c.width,delete a.cells[c.index];else if(s){var m=s;delete a.cells[c.index],s=null,m.width=c.width+i}else{var m=a.cells[c.index];if(!m)continue;if(l=m.colSpan,i=0,m.colSpan>1){s=m,i+=c.width;continue}m.width=c.width+i}}}function y0(n,e){for(var r={count:0,height:0},a=0,s=n.allRows();a<s.length;a++){for(var i=s[a],l=0,u=n.columns;l<u.length;l++){var c=u[l],m=i.cells[c.index];if(m){e.applyStyles(m.styles,!0);var b=m.width-m.padding("horizontal");if(m.styles.overflow==="linebreak")m.text=e.splitTextToSize(m.text,b+1/e.scaleFactor(),{fontSize:m.styles.fontSize});else if(m.styles.overflow==="ellipsize")m.text=Cc(m.text,b,m.styles,e,"...");else if(m.styles.overflow==="hidden")m.text=Cc(m.text,b,m.styles,e,"");else if(typeof m.styles.overflow=="function"){var w=m.styles.overflow(m.text,b);typeof w=="string"?m.text=[w]:m.text=w}m.contentHeight=m.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var y=m.contentHeight/m.rowSpan;m.rowSpan>1&&r.count*r.height<y*m.rowSpan?r={height:y,count:m.rowSpan}:r&&r.count>0&&r.height>y&&(y=r.height),y>i.height&&(i.height=y)}}r.count--}}function Cc(n,e,r,a,s){return n.map(function(i){return w0(i,e,r,a,s)})}function w0(n,e,r,a,s){var i=1e4*a.scaleFactor();if(e=Math.ceil(e*i)/i,e>=Gs(n,r,a))return n;for(;e<Gs(n+s,r,a)&&!(n.length<=1);)n=n.substring(0,n.length-1);return n.trim()+s}function N0(n,e){var r=new ti(n),a=j0(e,r.scaleFactor()),s=new p0(e,a);return g0(r,s),r.applyStyles(r.userStyles),s}function j0(n,e){var r=n.content,a=S0(r.columns);if(r.head.length===0){var s=Pc(a,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=Pc(a,"foot");s&&r.foot.push(s)}var i=n.settings.theme,l=n.styles;return{columns:a,head:el("head",r.head,a,l,i,e),body:el("body",r.body,a,l,i,e),foot:el("foot",r.foot,a,l,i,e)}}function el(n,e,r,a,s,i){var l={},u=e.map(function(c,m){for(var b=0,w={},y=0,p=0,_=0,j=r;_<j.length;_++){var B=j[_];if(l[B.index]==null||l[B.index].left===0)if(p===0){var v=void 0;Array.isArray(c)?v=c[B.index-y-b]:v=c[B.dataKey];var L={};typeof v=="object"&&!Array.isArray(v)&&(L=(v==null?void 0:v.styles)||{});var q=L0(n,B,m,s,a,i,L),G=new kd(v,q,n);w[B.dataKey]=G,w[B.index]=G,p=G.colSpan-1,l[B.index]={left:G.rowSpan-1,times:p}}else p--,y++;else l[B.index].left--,p=l[B.index].times,b++}return new Ad(c,m,n,w)});return u}function Pc(n,e){var r={};return n.forEach(function(a){if(a.raw!=null){var s=_0(e,a.raw);s!=null&&(r[a.dataKey]=s)}}),Object.keys(r).length>0?r:null}function _0(n,e){if(n==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(n==="foot"&&typeof e=="object")return e.footer;return null}function S0(n){return n.map(function(e,r){var a,s;return typeof e=="object"?s=(a=e.dataKey)!==null&&a!==void 0?a:r:s=r,new m0(s,e,r)})}function L0(n,e,r,a,s,i,l){var u=Qh(a),c;n==="head"?c=s.headStyles:n==="body"?c=s.bodyStyles:n==="foot"&&(c=s.footStyles);var m=An({},u.table,u[n],s.styles,c),b=s.columnStyles[e.dataKey]||s.columnStyles[e.index]||{},w=n==="body"?b:{},y=n==="body"&&r%2===0?An({},u.alternateRow,s.alternateRowStyles):{},p=Zh(i),_=An({},p,m,y,w);return An(_,l)}function A0(n,e,r){var a;r===void 0&&(r={});var s=_d(n,e),i=new Map,l=[],u=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(y){var p=e.columns.find(function(_){return _.dataKey===y||_.index===y});p&&!i.has(p.index)&&(i.set(p.index,!0),l.push(p.index),u.push(e.columns[p.index]),s-=p.wrappedWidth)});for(var m=!0,b=(a=r==null?void 0:r.start)!==null&&a!==void 0?a:0;b<e.columns.length;){if(i.has(b)){b++;continue}var w=e.columns[b].wrappedWidth;if(m||s>=w)m=!1,l.push(b),u.push(e.columns[b]),s-=w;else break;b++}return{colIndexes:l,columns:u,lastIndex:b-1}}function k0(n,e){for(var r=[],a=0;a<e.columns.length;a++){var s=A0(n,e,{start:a});s.columns.length&&(r.push(s),a=s.lastIndex)}return r}function C0(n,e){var r=e.settings,a=r.startY,s=r.margin,i={x:s.left,y:a},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),u=a+s.bottom+l;if(r.pageBreak==="avoid"){var c=e.body,m=c.reduce(function(y,p){return y+p.height},0);u+=m}var b=new ti(n);(r.pageBreak==="always"||r.startY!=null&&u>b.pageSize().height)&&(Pd(b),i.y=s.top),e.callWillDrawPageHooks(b,i);var w=An({},i);e.startPageNumber=b.pageNumber(),r.horizontalPageBreak?P0(b,e,w,i):(b.applyStyles(b.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(y){return Cn(b,e,y,i,e.columns)}),b.applyStyles(b.userStyles),e.body.forEach(function(y,p){var _=p===e.body.length-1;Ys(b,e,y,_,w,i,e.columns)}),b.applyStyles(b.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(y){return Cn(b,e,y,i,e.columns)})),Nd(b,e,w,i),e.callEndPageHooks(b,i),e.finalY=i.y,n.lastAutoTable=e,b.applyStyles(b.userStyles)}function P0(n,e,r,a){var s=k0(n,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(m,b){n.applyStyles(n.userStyles),b>0?Ri(n,e,r,a,m.columns,!0):Fc(n,e,a,m.columns),F0(n,e,r,a,m.columns),tl(n,e,a,m.columns)});else for(var l=-1,u=s[0],c=function(){var m=l;if(u){n.applyStyles(n.userStyles);var b=u.columns;l>=0?Ri(n,e,r,a,b,!0):Fc(n,e,a,b),m=Dc(n,e,l+1,a,b),tl(n,e,a,b)}var w=m-l;s.slice(1).forEach(function(y){n.applyStyles(n.userStyles),Ri(n,e,r,a,y.columns,!0),Dc(n,e,l+1,a,y.columns,w),tl(n,e,a,y.columns)}),l=m};l<e.body.length-1;)c()}function Fc(n,e,r,a){var s=e.settings;n.applyStyles(n.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&e.head.forEach(function(i){return Cn(n,e,i,r,a)})}function F0(n,e,r,a,s){n.applyStyles(n.userStyles),e.body.forEach(function(i,l){var u=l===e.body.length-1;Ys(n,e,i,u,r,a,s)})}function Dc(n,e,r,a,s,i){n.applyStyles(n.userStyles),i=i??e.body.length;var l=Math.min(r+i,e.body.length),u=-1;return e.body.slice(r,l).forEach(function(c,m){var b=r+m===e.body.length-1,w=Cd(n,e,b,a);c.canEntireRowFit(w,s)&&(Cn(n,e,c,a,s),u=r+m)}),u}function tl(n,e,r,a){var s=e.settings;n.applyStyles(n.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&e.foot.forEach(function(i){return Cn(n,e,i,r,a)})}function D0(n,e,r){var a=r.getLineHeight(n.styles.fontSize),s=n.padding("vertical"),i=Math.floor((e-s)/a);return Math.max(0,i)}function E0(n,e,r,a){var s={};n.spansMultiplePages=!0,n.height=0;for(var i=0,l=0,u=r.columns;l<u.length;l++){var c=u[l],m=n.cells[c.index];if(m){Array.isArray(m.text)||(m.text=[m.text]);var b=new kd(m.raw,m.styles,m.section);b=An(b,m),b.text=[];var w=D0(m,e,a);m.text.length>w&&(b.text=m.text.splice(w,m.text.length));var y=a.scaleFactor(),p=a.getLineHeightFactor();m.contentHeight=m.getContentHeight(y,p),m.contentHeight>=e&&(m.contentHeight=e,b.styles.minCellHeight-=e),m.contentHeight>n.height&&(n.height=m.contentHeight),b.contentHeight=b.getContentHeight(y,p),b.contentHeight>i&&(i=b.contentHeight),s[c.index]=b}}var _=new Ad(n.raw,-1,n.section,s,!0);_.height=i;for(var j=0,B=r.columns;j<B.length;j++){var c=B[j],b=_.cells[c.index];b&&(b.height=_.height);var m=n.cells[c.index];m&&(m.height=n.height)}return _}function I0(n,e,r,a){var s=n.pageSize().height,i=a.settings.margin,l=i.top+i.bottom,u=s-l;e.section==="body"&&(u-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var c=e.getMinimumRowHeight(a.columns,n),m=c<r;if(c>u)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!m)return!1;var b=e.hasRowSpan(a.columns),w=e.getMaxCellHeight(a.columns)>u;return w?(b&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(b||a.settings.rowPageBreak==="avoid")}function Ys(n,e,r,a,s,i,l){var u=Cd(n,e,a,i);if(r.canEntireRowFit(u,l))Cn(n,e,r,i,l);else if(I0(n,r,u,e)){var c=E0(r,u,e,n);Cn(n,e,r,i,l),Ri(n,e,s,i,l),Ys(n,e,c,a,s,i,l)}else Ri(n,e,s,i,l),Ys(n,e,r,a,s,i,l)}function Cn(n,e,r,a,s){a.x=e.settings.margin.left;for(var i=0,l=s;i<l.length;i++){var u=l[i],c=r.cells[u.index];if(!c){a.x+=u.width;continue}n.applyStyles(c.styles),c.x=a.x,c.y=a.y;var m=e.callCellHooks(n,e.hooks.willDrawCell,c,r,u,a);if(m===!1){a.x+=u.width;continue}O0(n,c,a);var b=c.getTextPos();vd(c.text,b.x,b.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},n.getDocument()),e.callCellHooks(n,e.hooks.didDrawCell,c,r,u,a),a.x+=u.width}a.y+=r.height}function O0(n,e,r){var a=e.styles;if(n.getDocument().setFillColor(n.getDocument().getFillColor()),typeof a.lineWidth=="number"){var s=jd(a.lineWidth,a.fillColor);s&&n.rect(e.x,r.y,e.width,e.height,s)}else typeof a.lineWidth=="object"&&(a.fillColor&&n.rect(e.x,r.y,e.width,e.height,"F"),B0(n,e,r,a.lineWidth))}function B0(n,e,r,a){var s,i,l,u;a.top&&(s=r.x,i=r.y,l=r.x+e.width,u=r.y,a.right&&(l+=.5*a.right),a.left&&(s-=.5*a.left),c(a.top,s,i,l,u)),a.bottom&&(s=r.x,i=r.y+e.height,l=r.x+e.width,u=r.y+e.height,a.right&&(l+=.5*a.right),a.left&&(s-=.5*a.left),c(a.bottom,s,i,l,u)),a.left&&(s=r.x,i=r.y,l=r.x,u=r.y+e.height,a.top&&(i-=.5*a.top),a.bottom&&(u+=.5*a.bottom),c(a.left,s,i,l,u)),a.right&&(s=r.x+e.width,i=r.y,l=r.x+e.width,u=r.y+e.height,a.top&&(i-=.5*a.top),a.bottom&&(u+=.5*a.bottom),c(a.right,s,i,l,u));function c(m,b,w,y,p){n.getDocument().setLineWidth(m),n.getDocument().line(b,w,y,p,"S")}}function Cd(n,e,r,a){var s=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(s+=e.getFootHeight(e.columns)),n.pageSize().height-a.y-s}function Ri(n,e,r,a,s,i){s===void 0&&(s=[]),i===void 0&&(i=!1),n.applyStyles(n.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(u){return Cn(n,e,u,a,s)}),e.callEndPageHooks(n,a);var l=e.settings.margin;Nd(n,e,r,a),Pd(n),e.pageNumber++,a.x=l.left,a.y=l.top,r.y=l.top,e.callWillDrawPageHooks(n,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(u){return Cn(n,e,u,a,s)}),n.applyStyles(n.userStyles))}function Pd(n){var e=n.pageNumber();n.setPage(e+1);var r=n.pageNumber();return r===e?(n.addPage(),!0):!1}function T0(n){n.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],s=s0(this,a),i=N0(this,s);return C0(this,i),this},n.API.lastAutoTable=!1,n.API.autoTableText=function(e,r,a,s){vd(e,r,a,s,this)},n.API.autoTableSetDefaults=function(e){return ti.setDefaults(e,this),this},n.autoTableSetDefaults=function(e,r){ti.setDefaults(e,r)},n.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new ti(this),i=Ld(s,e,window,r,!1),l=i.head,u=i.body,c=((a=l[0])===null||a===void 0?void 0:a.map(function(m){return m.content}))||[];return{columns:c,rows:u,data:u}}}var rl;try{if(typeof window<"u"&&window){var Ec=window,Ic=Ec.jsPDF||((rl=Ec.jspdf)===null||rl===void 0?void 0:rl.jsPDF);Ic&&T0(Ic)}}catch(n){console.error("Could not apply autoTable plugin",n)}const Fd=async n=>{try{if(n.startsWith("data:image/png"))return n;await new Promise((l,u)=>{const c=new Image;c.onload=()=>l(),c.onerror=u,c.src=n});const e=document.createElement("canvas"),r=new Image;r.src=n;const a=r.naturalWidth||256,s=r.naturalHeight||256;e.width=a,e.height=s;const i=e.getContext("2d");return i?(i.drawImage(r,0,0),e.toDataURL("image/png")):n}catch{return n}},Vt=n=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(n),M0=async(n,e,r,a)=>{var u;const s=new $e;try{const c=await Fd(ni);s.addImage(c,"PNG",Wn.x,Wn.y,Wn.width,Wn.height)}catch(c){console.warn("Could not add logo to Party Ledger PDF:",c)}if(s.setFontSize(20),s.setFont("helvetica","bold"),s.text("BHAVISHYA ROAD CARRIERS",105,20,{align:"center"}),s.setFontSize(12),s.setFont("helvetica","normal"),s.text("Transport & Logistics Services",105,28,{align:"center"}),s.setFontSize(16),s.setFont("helvetica","bold"),s.text("PARTY LEDGER",105,45,{align:"center"}),s.setFontSize(12),s.setFont("helvetica","normal"),s.text(`Party: ${n}`,20,60),a!=null&&a.from||a!=null&&a.to){const c=a.from?new Date(a.from).toLocaleDateString("en-IN"):"Beginning",m=a.to?new Date(a.to).toLocaleDateString("en-IN"):"Present";s.text(`Period: ${c} to ${m}`,20,68)}s.text(`Generated on: ${new Date().toLocaleDateString("en-IN")}`,20,76);const i=e.map(c=>[new Date(c.date).toLocaleDateString("en-IN"),c.reference,c.tripDetails,c.credit>0?Vt(c.credit):"â€”",c.debitPayment>0?Vt(c.debitPayment):"â€”",c.debitAdvance>0?Vt(c.debitAdvance):"â€”",Vt(Math.abs(c.runningBalance)),c.remarks]);i.push(["TOTAL","","",Vt(r.credit),Vt(r.debitPayment),Vt(r.debitAdvance),Vt(Math.abs(((u=e[e.length-1])==null?void 0:u.runningBalance)||0)),""]),s.autoTable({startY:85,head:[["Date","Bill No","Trip Details","Credit (â‚¹)","Debit - Payment (â‚¹)","Debit - Advance (â‚¹)","Running Balance (â‚¹)","Remarks"]],body:i,theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[59,130,246],textColor:255,fontStyle:"bold"},columnStyles:{3:{halign:"right"},4:{halign:"right"},5:{halign:"right"},6:{halign:"right"}},didParseCell:function(c){c.row.index===i.length-1&&(c.cell.styles.fontStyle="bold",c.cell.styles.fillColor=[243,244,246])}});const l=`party-ledger-${n.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.pdf`;s.save(l)},R0=async(n,e,r,a)=>{var u;const s=new $e;try{const c=await Fd(ni);s.addImage(c,"PNG",Wn.x,Wn.y,Wn.width,Wn.height)}catch(c){console.warn("Could not add logo to Supplier Ledger PDF:",c)}if(s.setFontSize(20),s.setFont("helvetica","bold"),s.text("BHAVISHYA ROAD CARRIERS",105,20,{align:"center"}),s.setFontSize(12),s.setFont("helvetica","normal"),s.text("Transport & Logistics Services",105,28,{align:"center"}),s.setFontSize(16),s.setFont("helvetica","bold"),s.text("SUPPLIER LEDGER",105,45,{align:"center"}),s.setFontSize(12),s.setFont("helvetica","normal"),s.text(`Supplier: ${n}`,20,60),a!=null&&a.from||a!=null&&a.to){const c=a.from?new Date(a.from).toLocaleDateString("en-IN"):"Beginning",m=a.to?new Date(a.to).toLocaleDateString("en-IN"):"Present";s.text(`Period: ${c} to ${m}`,20,68)}s.text(`Generated on: ${new Date().toLocaleDateString("en-IN")}`,20,76);const i=e.map(c=>[new Date(c.date).toLocaleDateString("en-IN"),c.reference,c.tripDetails,c.detention>0?Vt(c.detention):"â€”",c.extraWeight>0?Vt(c.extraWeight):"â€”",c.credit>0?Vt(c.credit):"â€”",c.debitPayment>0?Vt(c.debitPayment):"â€”",c.debitAdvance>0?Vt(c.debitAdvance):"â€”",Vt(Math.abs(c.runningBalance)),c.remarks]);i.push(["TOTAL","","",Vt(r.detention),Vt(r.extraWeight),Vt(r.credit),Vt(r.debitPayment),Vt(r.debitAdvance),Vt(Math.abs(((u=e[e.length-1])==null?void 0:u.runningBalance)||0)),""]),s.autoTable({startY:85,head:[["Date","Memo No","Trip Details","Detention (â‚¹)","Extra Weight (â‚¹)","Credit (â‚¹)","Debit - Payment (â‚¹)","Debit - Advance (â‚¹)","Running Balance (â‚¹)","Remarks"]],body:i,theme:"grid",styles:{fontSize:7,cellPadding:1.5},headStyles:{fillColor:[234,88,12],textColor:255,fontStyle:"bold"},columnStyles:{3:{halign:"right"},4:{halign:"right"},5:{halign:"right"},6:{halign:"right"},7:{halign:"right"},8:{halign:"right"}},didParseCell:function(c){c.row.index===i.length-1&&(c.cell.styles.fontStyle="bold",c.cell.styles.fillColor=[243,244,246])}});const l=`supplier-ledger-${n.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.pdf`;s.save(l)},Dd=({selectedParty:n})=>{const{bills:e,bankingEntries:r,loadingSlips:a}=tr(),[s,i]=pe.useState(""),[l,u]=pe.useState(""),[c,m]=pe.useState(n||""),b=pe.useMemo(()=>{const v=new Set(e.map(L=>L.party));return Array.from(v).sort()},[e]),w=pe.useMemo(()=>{if(!c)return[];const v=[];let L=0;const q=e.filter($=>$.party===c).sort(($,Q)=>new Date($.date).getTime()-new Date(Q.date).getTime()),G=r.filter($=>($.category==="bill_payment"||$.category==="bill_advance")&&q.some(Q=>Q.bill_number===$.reference_id)).sort(($,Q)=>new Date($.date).getTime()-new Date(Q.date).getTime()),K=[];return q.forEach($=>{const Q=a.find(X=>X.id===$.loading_slip_id);K.push({type:"bill",date:$.date,data:{...$,loadingSlip:Q}})}),G.forEach($=>{K.push({type:$.category==="bill_advance"?"advance":"payment",date:$.date,data:$})}),K.sort(($,Q)=>new Date($.date).getTime()-new Date(Q.date).getTime()),K.forEach($=>{var S;const Q=$.type==="bill"?$.data:q.find(D=>D.bill_number===$.data.reference_id),X=(Q==null?void 0:Q.loadingSlip)||a.find(D=>D.id===(Q==null?void 0:Q.loading_slip_id)),se=X?`${X.from_location} â€“ ${X.to_location} / ${X.vehicle_no}`:(S=Q==null?void 0:Q.loading_slip_id)!=null&&S.from_location?`${Q.loading_slip_id.from_location} â€“ ${Q.loading_slip_id.to_location} / ${Q.loading_slip_id.vehicle_no}`:"";let Y=0,I=0,h=0,g="";if($.type==="bill"){Y=$.data.bill_amount+($.data.detention||0)+($.data.extra||0)+($.data.rto||0)-($.data.mamool||0)-($.data.penalties||0)-($.data.tds||0);const F=G.filter(A=>A.category==="bill_advance"&&A.reference_id===$.data.bill_number).reduce((A,R)=>A+R.amount,0);h=F,L+=Y-h,g=F>0?"Bill Created (Advance Received)":"Bill Created"}else if($.type==="payment")I=$.data.amount,L-=I,g="Payment Received";else if($.type==="advance")return;v.push({id:$.data.id||`${$.type}-${$.date}`,date:$.date,billNo:(Q==null?void 0:Q.bill_number)||"",tripDetails:se,credit:Y,debitPayment:I,debitAdvance:h,runningBalance:L,remarks:g})}),v},[c,e,r,a]),y=pe.useMemo(()=>{let v=w;return s&&(v=v.filter(L=>L.date>=s)),l&&(v=v.filter(L=>L.date<=l)),v},[w,s,l]),p=pe.useMemo(()=>y.reduce((v,L)=>({credit:v.credit+L.credit,debitPayment:v.debitPayment+L.debitPayment,debitAdvance:v.debitAdvance+L.debitAdvance}),{credit:0,debitPayment:0,debitAdvance:0}),[y]),_=y.length>0?y[y.length-1].runningBalance:0,j=()=>{if(!y.length)return;const L=[["Date","Bill No","Trip Details","Credit (â‚¹)","Debit - Payment (â‚¹)","Debit - Advance (â‚¹)","Running Balance (â‚¹)","Remarks"].join(","),...y.map($=>[$.date,$.billNo,`"${$.tripDetails}"`,$.credit,$.debitPayment,$.debitAdvance,$.runningBalance,`"${$.remarks}"`].join(","))].join(`
`),q=new Blob([L],{type:"text/csv"}),G=window.URL.createObjectURL(q),K=document.createElement("a");K.href=G,K.download=`party-ledger-${c}-${new Date().toISOString().split("T")[0]}.csv`,K.click(),window.URL.revokeObjectURL(G)},B=()=>{if(!y.length||!c)return;const v=y.map(L=>({date:L.date,reference:L.billNo,tripDetails:L.tripDetails,credit:L.credit,debitPayment:L.debitPayment,debitAdvance:L.debitAdvance,runningBalance:L.runningBalance,remarks:L.remarks}));M0(c,v,p,{from:s,to:l})};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Br,{className:"w-8 h-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Party Ledger"}),t.jsx("p",{className:"text-gray-600",children:"Track customer bills, payments, and advances"})]})]})}),t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(Xs,{className:"w-5 h-5 text-gray-400"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Party"}),t.jsxs("select",{value:c,onChange:v=>m(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select Party"}),b.map(v=>t.jsx("option",{value:v,children:v},v))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),t.jsx("input",{type:"date",value:s,onChange:v=>i(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),t.jsx("input",{type:"date",value:l,onChange:v=>u(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{className:"flex items-end space-x-2",children:[t.jsxs("button",{onClick:j,disabled:!y.length,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Ar,{className:"w-4 h-4"}),t.jsx("span",{children:"Export CSV"})]}),t.jsxs("button",{onClick:B,disabled:!y.length,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(vl,{className:"w-4 h-4"}),t.jsx("span",{children:"Export PDF"})]})]})]})]}),c&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Bills"}),t.jsx("div",{className:"text-2xl font-bold text-blue-900",children:me(p.credit)})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[t.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Total Payments"}),t.jsx("div",{className:"text-2xl font-bold text-green-900",children:me(p.debitPayment)})]}),t.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[t.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Total Advances"}),t.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:me(p.debitAdvance)})]}),t.jsxs("div",{className:`p-4 rounded-lg border ${_>=0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[t.jsx("div",{className:`text-sm font-medium ${_>=0?"text-red-600":"text-green-600"}`,children:"Outstanding Balance"}),t.jsx("div",{className:`text-2xl font-bold ${_>=0?"text-red-900":"text-green-900"}`,children:me(Math.abs(_))})]})]}),c?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Ledger for ",c]})}),y.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bill No"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Details"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit - Payment (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit - Advance (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Running Balance (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Remarks"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((v,L)=>t.jsxs("tr",{className:L%2===0?"bg-white":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(v.date).toLocaleDateString("en-IN")}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:v.billNo}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:v.tripDetails}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600 font-medium",children:v.credit>0?me(v.credit):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-blue-600 font-medium",children:v.debitPayment>0?me(v.debitPayment):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-yellow-600 font-medium",children:v.debitAdvance>0?me(v.debitAdvance):"â€”"}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${v.runningBalance>=0?"text-red-600":"text-green-600"}`,children:me(Math.abs(v.runningBalance))}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:v.remarks})]},v.id))}),t.jsx("tfoot",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:3,className:"px-6 py-4 text-sm font-bold text-gray-900",children:"Total"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-green-600",children:me(p.credit)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-blue-600",children:me(p.debitPayment)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-yellow-600",children:me(p.debitAdvance)}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${_>=0?"text-red-600":"text-green-600"}`,children:me(Math.abs(_))}),t.jsx("td",{className:"px-6 py-4"})]})})]})}):t.jsxs("div",{className:"px-6 py-12 text-center",children:[t.jsx(yl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No ledger entries found for the selected criteria"})]})]}):t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Br,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Party"}),t.jsx("p",{className:"text-gray-500",children:"Choose a party from the dropdown to view their ledger"})]})]})},Ed=({selectedSupplier:n})=>{const{memos:e,bankingEntries:r,loadingSlips:a}=tr(),[s,i]=pe.useState(""),[l,u]=pe.useState(""),[c,m]=pe.useState(n||""),b=pe.useMemo(()=>{const v=new Set(e.map(L=>L.supplier));return Array.from(v).sort()},[e]),w=pe.useMemo(()=>{if(!c)return[];const v=[];let L=0;const q=e.filter($=>$.supplier===c).sort(($,Q)=>new Date($.date).getTime()-new Date(Q.date).getTime()),G=r.filter($=>($.category==="memo_payment"||$.category==="memo_advance")&&q.some(Q=>Q.memo_number===$.reference_id)).sort(($,Q)=>new Date($.date).getTime()-new Date(Q.date).getTime()),K=[];return q.forEach($=>{const Q=a.find(X=>X.id===$.loading_slip_id);K.push({type:"memo",date:$.date,data:{...$,loadingSlip:Q}})}),G.forEach($=>{K.push({type:$.category==="memo_advance"?"advance":"payment",date:$.date,data:$})}),K.sort(($,Q)=>new Date($.date).getTime()-new Date(Q.date).getTime()),K.forEach($=>{var F;const Q=$.type==="memo"?$.data:q.find(A=>A.memo_number===$.data.reference_id),X=(Q==null?void 0:Q.loadingSlip)||a.find(A=>A.id===(Q==null?void 0:Q.loading_slip_id)),se=X?`${X.from_location} â€“ ${X.to_location} / ${X.vehicle_no}`:(F=Q==null?void 0:Q.loading_slip_id)!=null&&F.from_location?`${Q.loading_slip_id.from_location} â€“ ${Q.loading_slip_id.to_location} / ${Q.loading_slip_id.vehicle_no}`:"";let Y=0,I=0,h=0,g=0,S=0,D="";if($.type==="memo"){Y=$.data.freight,g=$.data.detention||0,S=$.data.extra||0;const A=$.data.commission||0,R=$.data.mamool||0,re=G.filter(ve=>ve.category==="memo_advance"&&ve.reference_id===$.data.memo_number).reduce((ve,k)=>ve+k.amount,0);h=re,L+=Y-h-A-R+S+g,D=re>0?"Memo Created (Advance Paid)":"Memo Created"}else if($.type==="payment")I=$.data.amount,L-=I,D="Payment to Supplier";else if($.type==="advance")return;v.push({id:$.data.id||`${$.type}-${$.date}`,date:$.date,memoNo:(Q==null?void 0:Q.memo_number)||"",tripDetails:se,detention:g,extraWeight:S,credit:Y,debitPayment:I,debitAdvance:h,runningBalance:L,remarks:D})}),v},[c,e,r,a]),y=pe.useMemo(()=>{let v=w;return s&&(v=v.filter(L=>L.date>=s)),l&&(v=v.filter(L=>L.date<=l)),v},[w,s,l]),p=pe.useMemo(()=>y.reduce((v,L)=>({credit:v.credit+L.credit,detention:v.detention+L.detention,extraWeight:v.extraWeight+L.extraWeight,debitPayment:v.debitPayment+L.debitPayment,debitAdvance:v.debitAdvance+L.debitAdvance}),{credit:0,detention:0,extraWeight:0,debitPayment:0,debitAdvance:0}),[y]),_=y.length>0?y[y.length-1].runningBalance:0,j=()=>{if(!y.length)return;const L=[["Date","Memo No","Trip Details","Detention (â‚¹)","Extra Weight (â‚¹)","Credit (â‚¹)","Debit - Payment (â‚¹)","Debit - Advance (â‚¹)","Running Balance (â‚¹)","Remarks"].join(","),...y.map($=>[$.date,$.memoNo,`"${$.tripDetails}"`,$.detention,$.extraWeight,$.credit,$.debitPayment,$.debitAdvance,$.runningBalance,`"${$.remarks}"`].join(","))].join(`
`),q=new Blob([L],{type:"text/csv"}),G=window.URL.createObjectURL(q),K=document.createElement("a");K.href=G,K.download=`supplier-ledger-${c}-${new Date().toISOString().split("T")[0]}.csv`,K.click(),window.URL.revokeObjectURL(G)},B=()=>{if(!y.length||!c)return;const v=y.map(L=>({date:L.date,reference:L.memoNo,tripDetails:L.tripDetails,detention:L.detention,extraWeight:L.extraWeight,credit:L.credit,debitPayment:L.debitPayment,debitAdvance:L.debitAdvance,runningBalance:L.runningBalance,remarks:L.remarks}));R0(c,v,p,{from:s,to:l})};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(vr,{className:"w-8 h-8 text-orange-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Supplier Ledger"}),t.jsx("p",{className:"text-gray-600",children:"Track supplier memos, payments, and advances"})]})]})}),t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(Xs,{className:"w-5 h-5 text-gray-400"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Supplier"}),t.jsxs("select",{value:c,onChange:v=>m(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select Supplier"}),b.map(v=>t.jsx("option",{value:v,children:v},v))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),t.jsx("input",{type:"date",value:s,onChange:v=>i(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),t.jsx("input",{type:"date",value:l,onChange:v=>u(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),t.jsxs("div",{className:"flex items-end space-x-2",children:[t.jsxs("button",{onClick:j,disabled:!y.length,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Ar,{className:"w-4 h-4"}),t.jsx("span",{children:"Export CSV"})]}),t.jsxs("button",{onClick:B,disabled:!y.length,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(vl,{className:"w-4 h-4"}),t.jsx("span",{children:"Export PDF"})]})]})]})]}),c&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[t.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Total Memos"}),t.jsx("div",{className:"text-2xl font-bold text-orange-900",children:me(p.credit)})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[t.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Detention"}),t.jsx("div",{className:"text-2xl font-bold text-purple-900",children:me(p.detention)})]}),t.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg border border-indigo-200",children:[t.jsx("div",{className:"text-sm text-indigo-600 font-medium",children:"Extra Weight"}),t.jsx("div",{className:"text-2xl font-bold text-indigo-900",children:me(p.extraWeight)})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[t.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Total Payments"}),t.jsx("div",{className:"text-2xl font-bold text-green-900",children:me(p.debitPayment)})]}),t.jsxs("div",{className:`p-4 rounded-lg border ${_>=0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[t.jsx("div",{className:`text-sm font-medium ${_>=0?"text-red-600":"text-green-600"}`,children:"Outstanding Balance"}),t.jsx("div",{className:`text-2xl font-bold ${_>=0?"text-red-900":"text-green-900"}`,children:me(Math.abs(_))})]})]}),c?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Ledger for ",c]})}),y.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Memo No"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Details"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detention (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Extra Weight (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit - Payment (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit - Advance (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Running Balance (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Remarks"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((v,L)=>t.jsxs("tr",{className:L%2===0?"bg-white":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(v.date).toLocaleDateString("en-IN")}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600",children:v.memoNo}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:v.tripDetails}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-purple-600 font-medium",children:v.detention>0?me(v.detention):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-indigo-600 font-medium",children:v.extraWeight>0?me(v.extraWeight):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600 font-medium",children:v.credit>0?me(v.credit):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-blue-600 font-medium",children:v.debitPayment>0?me(v.debitPayment):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-yellow-600 font-medium",children:v.debitAdvance>0?me(v.debitAdvance):"â€”"}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${v.runningBalance>=0?"text-red-600":"text-green-600"}`,children:me(Math.abs(v.runningBalance))}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:v.remarks})]},v.id))}),t.jsx("tfoot",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:3,className:"px-6 py-4 text-sm font-bold text-gray-900",children:"Total"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-purple-600",children:me(p.detention)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-indigo-600",children:me(p.extraWeight)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-green-600",children:me(p.credit)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-blue-600",children:me(p.debitPayment)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-yellow-600",children:me(p.debitAdvance)}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${_>=0?"text-red-600":"text-green-600"}`,children:me(Math.abs(_))}),t.jsx("td",{className:"px-6 py-4"})]})})]})}):t.jsxs("div",{className:"px-6 py-12 text-center",children:[t.jsx(yl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No ledger entries found for the selected criteria"})]})]}):t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(vr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Supplier"}),t.jsx("p",{className:"text-gray-500",children:"Choose a supplier from the dropdown to view their ledger"})]})]})},Id=({selectedPerson:n})=>{const{ledgerEntries:e}=tr(),[r,a]=pe.useState(""),[s,i]=pe.useState(""),[l,u]=pe.useState(n||""),c=pe.useMemo(()=>{const _=e.filter(B=>B.ledger_type==="general"),j=new Set(_.map(B=>B.reference_name));return Array.from(j).sort()},[e]),m=pe.useMemo(()=>{if(!l)return[];const _=[];let j=0;return e.filter(v=>v.ledger_type==="general"&&v.reference_name===l).sort((v,L)=>new Date(v.date).getTime()-new Date(L.date).getTime()).forEach(v=>{j+=v.debit-v.credit,_.push({id:v.id,date:v.date,description:v.description||v.narration||"",debit:v.debit,credit:v.credit,runningBalance:j,reference:v.reference_id||""})}),_},[l,e]),b=pe.useMemo(()=>{let _=m;return r&&(_=_.filter(j=>j.date>=r)),s&&(_=_.filter(j=>j.date<=s)),_},[m,r,s]),w=pe.useMemo(()=>b.reduce((_,j)=>({debit:_.debit+j.debit,credit:_.credit+j.credit}),{debit:0,credit:0}),[b]),y=b.length>0?b[b.length-1].runningBalance:0,p=()=>{if(!b.length)return;const j=[["Date","Description","Reference","Debit (â‚¹)","Credit (â‚¹)","Running Balance (â‚¹)"].join(","),...b.map(q=>[q.date,`"${q.description}"`,q.reference,q.debit,q.credit,q.runningBalance].join(","))].join(`
`),B=new Blob([j],{type:"text/csv"}),v=window.URL.createObjectURL(B),L=document.createElement("a");L.href=v,L.download=`general-ledger-${l}-${new Date().toISOString().split("T")[0]}.csv`,L.click(),window.URL.revokeObjectURL(v)};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Us,{className:"w-8 h-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"General Ledger"}),t.jsx("p",{className:"text-gray-600",children:"Track expenses and transactions by person/vendor"})]})]})}),t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(Xs,{className:"w-5 h-5 text-gray-400"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Person/Vendor"}),t.jsxs("select",{value:l,onChange:_=>u(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select Person/Vendor"}),c.map(_=>t.jsx("option",{value:_,children:_},_))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),t.jsx("input",{type:"date",value:r,onChange:_=>a(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),t.jsx("input",{type:"date",value:s,onChange:_=>i(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsx("div",{className:"flex items-end space-x-2",children:t.jsxs("button",{onClick:p,disabled:!b.length,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Ar,{className:"w-4 h-4"}),t.jsx("span",{children:"Export CSV"})]})})]})]}),l&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[t.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Total Expenses"}),t.jsx("div",{className:"text-2xl font-bold text-red-900",children:me(w.debit)})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[t.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Total Credits"}),t.jsx("div",{className:"text-2xl font-bold text-green-900",children:me(w.credit)})]}),t.jsxs("div",{className:`p-4 rounded-lg border ${y>=0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[t.jsx("div",{className:`text-sm font-medium ${y>=0?"text-red-600":"text-green-600"}`,children:"Net Balance"}),t.jsx("div",{className:`text-2xl font-bold ${y>=0?"text-red-900":"text-green-900"}`,children:me(Math.abs(y))})]})]}),l?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["General Ledger for ",l]})}),b.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reference"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit (â‚¹)"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Running Balance (â‚¹)"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map((_,j)=>t.jsxs("tr",{className:j%2===0?"bg-white":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(_.date).toLocaleDateString("en-IN")}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:_.description}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:_.reference}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-red-600 font-medium",children:_.debit>0?me(_.debit):"â€”"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600 font-medium",children:_.credit>0?me(_.credit):"â€”"}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${_.runningBalance>=0?"text-red-600":"text-green-600"}`,children:me(Math.abs(_.runningBalance))})]},_.id))}),t.jsx("tfoot",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:3,className:"px-6 py-4 text-sm font-bold text-gray-900",children:"Total"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-red-600",children:me(w.debit)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-green-600",children:me(w.credit)}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${y>=0?"text-red-600":"text-green-600"}`,children:me(Math.abs(y))})]})})]})}):t.jsxs("div",{className:"px-6 py-12 text-center",children:[t.jsx(yl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No ledger entries found for the selected criteria"})]})]}):t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Us,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Person/Vendor"}),t.jsx("p",{className:"text-gray-500",children:"Choose a person or vendor from the dropdown to view their general ledger"})]})]})},q0=({onViewLedger:n})=>{var B;const[e,r]=pe.useState("party"),[a,s]=pe.useState(null),{ledgerEntries:i,bills:l,memos:u,bankingEntries:c,setLedgerEntries:m}=tr();pe.useEffect(()=>{(async()=>{try{console.log("ðŸ”„ Refreshing ledger data on Ledgers component mount...");const L=await Fe.getLedgerEntries();L.ledgerEntries&&(m(L.ledgerEntries),console.log("âœ… Ledger data refreshed:",L.ledgerEntries.length,"entries"))}catch(L){console.error("âŒ Failed to refresh ledger data:",L)}})()},[m]);const b=pe.useMemo(()=>Xh(l,c),[l,c]),w=pe.useMemo(()=>Kh(u,c),[u,c]),y=pe.useMemo(()=>{if(e==="general"){const L=i.filter(q=>q.ledger_type==="general").reduce((q,G)=>{const K=G.reference_name||"Unknown";return q[K]||(q[K]={name:K,entries:[],totalDebit:0,totalCredit:0,outstandingAmount:0}),q[K].entries.push(G),q[K].totalDebit+=G.debit||0,q[K].totalCredit+=G.credit||0,q[K].outstandingAmount=q[K].totalDebit-q[K].totalCredit,q},{});return Object.values(L)}return e==="party"?b.map(v=>({name:v.partyName,entries:[],totalDebit:v.totalBills,totalCredit:v.totalPayments+v.totalAdvances,outstandingAmount:v.outstandingAmount})):e==="supplier"?w.map(v=>({name:v.supplierName,entries:[],totalDebit:v.totalMemos+v.totalDetention+v.totalExtraWeight,totalCredit:v.totalPayments+v.totalAdvances-v.totalCommission-v.totalMamul,outstandingAmount:v.outstandingAmount})):[]},[e,b,w,i]),p=pe.useMemo(()=>{const v=i.filter(q=>q.ledger_type==="general"),L=new Set(v.map(q=>q.reference_name)).size;return{party:b.length,supplier:w.length,general:L}},[b,w,i]),_=[{id:"party",label:"Party Ledgers",count:p.party,icon:Hc},{id:"supplier",label:"Supplier Ledgers",count:p.supplier,icon:vr},{id:"general",label:"General Ledgers",count:p.general,icon:Us}],j=(v,L)=>{s({name:v,type:L}),n&&n(v,L)};return a?t.jsxs("div",{className:"space-y-4",children:[t.jsx("button",{onClick:()=>s(null),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800",children:t.jsx("span",{children:"â† Back to Ledger Management"})}),a.type==="party"?t.jsx(Dd,{selectedParty:a.name}):a.type==="supplier"?t.jsx(Ed,{selectedSupplier:a.name}):t.jsx(Id,{selectedPerson:a.name})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ledger Management"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[e==="supplier"?"Supplier":e==="party"?"Party":"General"," Ledgers: ",((B=_.find(v=>v.id===e))==null?void 0:B.count)||0]})]}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"-mb-px flex space-x-8",children:_.map(v=>{const L=v.icon;return t.jsxs("button",{onClick:()=>r(v.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${e===v.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(L,{className:"w-4 h-4"}),t.jsx("span",{children:v.label}),t.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs",children:v.count})]},v.id)})})}),e==="supplier"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Supplier Outstanding"}),t.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-2",children:me(w.reduce((v,L)=>v+L.outstandingAmount,0))})]}),t.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:t.jsx(vr,{className:"w-6 h-6 text-orange-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Supplier Ledgers"}),t.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2",children:w.length})]}),t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-2xl font-bold text-red-600",children:w.length})})]})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex-1 max-w-md",children:t.jsx("input",{type:"text",placeholder:`Search ${e} ledgers...`,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("input",{type:"date",defaultValue:"2025-08-16",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("span",{className:"text-gray-500",children:"to"}),t.jsx("input",{type:"date",defaultValue:"2025-08-16",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e==="party"?"Party":e==="supplier"?"Supplier":"Ledger"," Name"]}),t.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:["Total ",e==="party"?"Bills":e==="supplier"?"Memos":"Entries"]}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Entries"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Outstanding Balance"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[y.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:e==="general"?t.jsxs(t.Fragment,{children:[t.jsx(Us,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No general ledger entries found"}),t.jsx("p",{className:"text-sm",children:"Create expense transactions in Banking to generate general ledger entries"})]}):"No entries"})}),y.map((v,L)=>{var q,G;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{children:t.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.name})})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e==="party"?((q=b.find(K=>K.partyName===v.name))==null?void 0:q.totalBills)||0:e==="supplier"?((G=w.find(K=>K.supplierName===v.name))==null?void 0:G.totalMemos)||0:me(v.totalDebit)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e==="party"?"Bills":e==="supplier"?"Memos":v.entries.length+" Entries"}),t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${v.outstandingAmount>0?"text-red-600":v.outstandingAmount<0?"text-green-600":"text-gray-600"}`,children:me(Math.abs(v.outstandingAmount))}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{className:"text-blue-600 hover:text-blue-800",onClick:()=>j(v.name,e),title:"View Ledger",children:t.jsx(qi,{className:"w-4 h-4"})}),t.jsx("button",{className:"text-green-600 hover:text-green-800",children:t.jsx(Ar,{className:"w-4 h-4"})})]})})]},`${e}-${v.name}-${L}`)})]})]})})})]})},z0=()=>{const[n,e]=pe.useState(""),[r,a]=pe.useState(!1),[s,i]=pe.useState({billNo:"",vehicleNo:"",party:""}),l=pe.useRef(null),{podFiles:u,addPODFile:c,setPODFiles:m}=tr();pe.useEffect(()=>{(async()=>{try{console.log("ðŸ”„ Refreshing POD data on component mount...");const _=await Fe.getPODFiles();_.podFiles&&(m(_.podFiles),console.log("âœ… POD data refreshed:",_.podFiles.length,"files"))}catch(_){console.error("âŒ Failed to refresh POD data:",_)}})()},[m]);const b=p=>{const _=p.target.files;if(_&&_.length>0){const j=_[0],B=new FileReader;B.onload=async v=>{var G;const L=(G=v.target)==null?void 0:G.result,q={id:`pod-${Date.now()}`,filename:j.name,fileData:L,fileType:j.type,billNo:s.billNo||void 0,vehicleNo:s.vehicleNo||void 0,party:s.party||void 0,uploadDate:new Date().toISOString(),created_at:new Date().toISOString()};try{await Fe.createPODFile(q),console.log("POD file saved to backend successfully"),c(q),window.dispatchEvent(new CustomEvent("data-sync-required"))}catch(K){console.error("Failed to save POD to backend:",K),c(q)}a(!1),i({billNo:"",vehicleNo:"",party:""}),l.current&&(l.current.value="")},B.readAsDataURL(j)}},w=u.filter(p=>{var _,j,B;return((_=p.billNo)==null?void 0:_.toLowerCase().includes(n.toLowerCase()))||((j=p.vehicleNo)==null?void 0:j.toLowerCase().includes(n.toLowerCase()))||((B=p.party)==null?void 0:B.toLowerCase().includes(n.toLowerCase()))||p.filename.toLowerCase().includes(n.toLowerCase())}),y=p=>{try{const _=document.createElement("a");_.href=p.fileData,_.download=p.filename,document.body.appendChild(_),_.click(),document.body.removeChild(_)}catch(_){console.error("Error downloading POD:",_),alert("Error downloading file. Please try again.")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"POD (Proof of Delivery)"}),t.jsxs("button",{onClick:()=>a(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Vc,{className:"w-5 h-5"}),t.jsx("span",{children:"Upload POD"})]})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx($c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:"Search by Bill No, Vehicle No, Party...",value:n,onChange:p=>e(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsx("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Search"})]})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Upload POD"}),t.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Number (Optional)"}),t.jsx("input",{type:"text",value:s.billNo,onChange:p=>i(_=>({..._,billNo:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter bill number"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Number (Optional)"}),t.jsx("input",{type:"text",value:s.vehicleNo,onChange:p=>i(_=>({..._,vehicleNo:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter vehicle number"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Name (Optional)"}),t.jsx("input",{type:"text",value:s.party,onChange:p=>i(_=>({..._,party:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter party name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select File"}),t.jsx("input",{ref:l,type:"file",accept:"image/*,.pdf",onChange:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),t.jsxs("div",{className:"flex space-x-3 mt-6",children:[t.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>{var p;return(p=l.current)==null?void 0:p.click()},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Choose File"})]})]})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["POD Images (",w.length,")"]})}),t.jsx("div",{className:"p-6",children:w.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-12",children:[t.jsx(nc,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No POD images found"}),t.jsx("p",{className:"text-sm",children:"Upload POD images to attach with bills"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(p=>t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(nc,{className:"w-8 h-8 text-blue-600"}),t.jsx("button",{onClick:()=>y(p),className:"text-blue-600 hover:text-blue-800",title:"Download POD",children:t.jsx(Ar,{className:"w-4 h-4"})})]}),t.jsx("h4",{className:"font-medium text-gray-900 truncate",children:p.filename}),t.jsxs("div",{className:"text-sm text-gray-500 mt-2 space-y-1",children:[p.billNo&&t.jsxs("p",{children:["Bill: ",p.billNo]}),p.vehicleNo&&t.jsxs("p",{children:["Vehicle: ",p.vehicleNo]}),p.party&&t.jsxs("p",{children:["Party: ",p.party]}),t.jsxs("p",{children:["Uploaded: ",new Date(p.uploadDate).toLocaleDateString()]})]})]},p.id))})})]})]})},U0=({ledgerName:n,ledgerType:e,onClose:r})=>{const a={name:n,totalEntries:0,outstandingBalance:0,entries:[]};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[e==="party"?"Party":"Supplier"," Ledger: ",n]}),t.jsxs("div",{className:"flex items-center space-x-6 mt-2 text-sm text-gray-600",children:[t.jsxs("span",{children:[e==="party"?"Party":"Supplier"," Name: ",t.jsx("strong",{children:a.name})]}),t.jsxs("span",{children:["Total Entries: ",t.jsx("strong",{children:a.totalEntries})]}),t.jsxs("span",{children:["Outstanding Balance: ",t.jsx("strong",{className:"text-orange-600",children:me(a.outstandingBalance)})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[t.jsx(Ar,{className:"w-4 h-4"}),t.jsx("span",{children:"Download PDF"})]}),t.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:t.jsx(kn,{className:"w-6 h-6"})})]})]}),t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e==="party"?"Bill No":"Memo No"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Details"}),e==="supplier"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detention (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Extra WT (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Advance (â‚¹)"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bill Amount (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Received (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deductions (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Received (â‚¹)"})]}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance (â‚¹)"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e==="party"?"Status":"Remarks"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.entries.map((s,i)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:s.date}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-blue-600 font-medium",children:e==="party"?s.billNo:s.memoNo}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:s.tripDetails}),e==="supplier"?t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:"-"}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:"-"}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:s.credit>0?me(s.credit):"-"}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-blue-600",children:s.payment>0?me(s.payment):"-"}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:"-"})]}):t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:me(s.billAmount)}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-blue-600",children:me(s.received)}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-red-600",children:me(s.deductions)}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-blue-600",children:me(s.netReceived)})]}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-orange-600 font-medium",children:me(s.balance)}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e==="party"?t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:s.status}):s.remarks})]},i))})]})})})]})})},$0=()=>{const{fuelWallets:n,vehicleFuelExpenses:e,vehicles:r,addBankingEntry:a,allocateFuelToVehicle:s,getVehicleFuelExpenses:i,addVehicle:l}=tr(),[u,c]=pe.useState("dashboard"),[m,b]=pe.useState("BPCL"),[w,y]=pe.useState(""),[p,_]=pe.useState({amount:"",fuelQuantity:"",ratePerLiter:"",odometerReading:"",narration:"",date:new Date().toISOString().split("T")[0]}),[j,B]=pe.useState({walletName:"BPCL",amount:"",narration:"",date:new Date().toISOString().split("T")[0]}),[v,L]=pe.useState({vehicleNo:"",vehicleType:"Truck",ownerName:"",driverName:"",driverPhone:""}),q=n.reduce((Y,I)=>Y+I.balance,0),G=e.reduce((Y,I)=>Y+I.amount,0),K=r.length,$=()=>{if(!v.vehicleNo)return;const Y={id:Date.now().toString(),vehicle_no:v.vehicleNo.toUpperCase(),vehicle_type:v.vehicleType,ownership_type:"own",owner_name:v.ownerName||void 0,driver_name:v.driverName||void 0,driver_phone:v.driverPhone||void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};l(Y),L({vehicleNo:"",vehicleType:"Truck",ownerName:"",driverName:"",driverPhone:""}),c("vehicles")},Q=()=>{if(!j.amount||!j.walletName)return;const Y={id:Date.now().toString(),type:"debit",category:"fuel_wallet",amount:parseFloat(j.amount),date:j.date,reference_name:j.walletName,narration:j.narration||`Fuel wallet credit to ${j.walletName}`,created_at:new Date().toISOString()};a(Y),B({walletName:"BPCL",amount:"",narration:"",date:new Date().toISOString().split("T")[0]})},X=()=>{if(!w||!m||!p.amount)return;const Y=parseFloat(p.amount),I=p.fuelQuantity?parseFloat(p.fuelQuantity):void 0,h=p.ratePerLiter?parseFloat(p.ratePerLiter):void 0,g=p.odometerReading?parseInt(p.odometerReading):void 0;console.log("ðŸš› Fuel allocation started:",{selectedVehicle:w,selectedWallet:m,amount:Y,date:p.date,narration:p.narration}),s(w,m,Y,p.date,p.narration,I,h,g),_({amount:"",fuelQuantity:"",ratePerLiter:"",odometerReading:"",narration:"",date:new Date().toISOString().split("T")[0]}),y("")},se=pe.useMemo(()=>r.map(Y=>{const I=i(Y.vehicle_no),h=I.reduce((S,D)=>S+D.amount,0),g=I.reduce((S,D)=>S+(D.fuel_quantity||0),0);return{vehicleNo:Y.vehicle_no,vehicle:Y,totalExpense:h,totalQuantity:g,expenseCount:I.length,lastFuelDate:I.length>0?I[0].date:null}}),[r,e]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fuel Management"}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>c("dashboard"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="dashboard"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Dashboard"}),t.jsx("button",{onClick:()=>c("allocate"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="allocate"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Allocate Fuel"}),t.jsx("button",{onClick:()=>c("wallets"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="wallets"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Fuel Wallets"}),t.jsx("button",{onClick:()=>c("vehicles"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="vehicles"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Vehicles"}),t.jsxs("button",{onClick:()=>c("add-vehicle"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="add-vehicle"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[t.jsx(qu,{className:"w-4 h-4 inline-block mr-2"}),"Add Vehicle"]})]})]}),u==="dashboard"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Wallet Balance"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:me(q)})]}),t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx(zu,{className:"w-6 h-6 text-blue-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Fuel Allocated"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-2",children:me(G)})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx(Ts,{className:"w-6 h-6 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Vehicles"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:K})]}),t.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx(vr,{className:"w-6 h-6 text-purple-600"})})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Fuel Wallets"})}),t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:n.map(Y=>t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"font-semibold text-gray-900",children:Y.name}),t.jsx(Ts,{className:"w-5 h-5 text-gray-400"})]}),t.jsx("p",{className:`text-xl font-bold ${Y.balance>=0?"text-green-600":"text-red-600"}`,children:me(Y.balance)}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Updated: ",new Date(Y.updated_at).toLocaleDateString("en-IN")]})]},Y.id))})})]})]}),u==="allocate"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Allocate Fuel to Vehicle"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle"}),t.jsxs("select",{value:w,onChange:Y=>y(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Select Vehicle"}),r.map(Y=>t.jsx("option",{value:Y.vehicle_no,children:Y.vehicle_no},Y.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuel Wallet"}),t.jsx("select",{value:m,onChange:Y=>b(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:n.map(Y=>t.jsxs("option",{value:Y.name,children:[Y.name," - ",me(Y.balance)]},Y.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),t.jsx("input",{type:"number",value:p.amount,onChange:Y=>_(I=>({...I,amount:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter amount"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",value:p.date,onChange:Y=>_(I=>({...I,date:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuel Quantity (Liters)"}),t.jsx("input",{type:"number",value:p.fuelQuantity,onChange:Y=>_(I=>({...I,fuelQuantity:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rate per Liter"}),t.jsx("input",{type:"number",value:p.ratePerLiter,onChange:Y=>_(I=>({...I,ratePerLiter:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Odometer Reading"}),t.jsx("input",{type:"number",value:p.odometerReading,onChange:Y=>_(I=>({...I,odometerReading:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Narration"}),t.jsx("input",{type:"text",value:p.narration,onChange:Y=>_(I=>({...I,narration:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional notes"})]})]}),t.jsx("div",{className:"mt-6",children:t.jsxs("button",{onClick:X,disabled:!w||!m||!p.amount,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Ts,{className:"w-4 h-4"}),t.jsx("span",{children:"Allocate Fuel"})]})})]})}),u==="wallets"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Add Credit to Fuel Wallet"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuel Wallet"}),t.jsx("select",{value:j.walletName,onChange:Y=>B(I=>({...I,walletName:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:n.map(Y=>t.jsx("option",{value:Y.name,children:Y.name},Y.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),t.jsx("input",{type:"number",value:j.amount,onChange:Y=>B(I=>({...I,amount:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter amount"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",value:j.date,onChange:Y=>B(I=>({...I,date:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Narration"}),t.jsx("input",{type:"text",value:j.narration,onChange:Y=>B(I=>({...I,narration:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Payment reference or notes"})]})]}),t.jsx("div",{className:"mt-6",children:t.jsxs("button",{onClick:Q,disabled:!j.amount||!j.walletName,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Kr,{className:"w-4 h-4"}),t.jsx("span",{children:"Add Credit"})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Wallet Details"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Wallet Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Balance"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Updated"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(Y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Y.name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsx("span",{className:`font-semibold ${Y.balance>=0?"text-green-600":"text-red-600"}`,children:me(Y.balance)})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(Y.updated_at).toLocaleDateString("en-IN")})]},Y.id))})]})})]})]}),u==="vehicles"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Vehicle Fuel Summary"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle No"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Expense"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Quantity (L)"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fuel Entries"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Fuel Date"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.map(Y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(vr,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{children:Y.vehicleNo})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:me(Y.totalExpense)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Y.totalQuantity.toFixed(2)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Y.expenseCount}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.lastFuelDate?new Date(Y.lastFuelDate).toLocaleDateString("en-IN"):"No fuel records"})]},Y.vehicleNo))})]})})]})}),u==="add-vehicle"&&t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Register New Vehicle"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Number *"}),t.jsx("input",{type:"text",value:v.vehicleNo,onChange:Y=>L(I=>({...I,vehicleNo:Y.target.value.toUpperCase()})),placeholder:"e.g., GJ01AB1234",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Type"}),t.jsxs("select",{value:v.vehicleType,onChange:Y=>L(I=>({...I,vehicleType:Y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"Truck",children:"Truck"}),t.jsx("option",{value:"Trailer",children:"Trailer"}),t.jsx("option",{value:"Container",children:"Container"}),t.jsx("option",{value:"Tanker",children:"Tanker"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Name"}),t.jsx("input",{type:"text",value:v.ownerName,onChange:Y=>L(I=>({...I,ownerName:Y.target.value})),placeholder:"Vehicle owner name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Driver Name"}),t.jsx("input",{type:"text",value:v.driverName,onChange:Y=>L(I=>({...I,driverName:Y.target.value})),placeholder:"Driver name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Driver Phone"}),t.jsx("input",{type:"tel",value:v.driverPhone,onChange:Y=>L(I=>({...I,driverPhone:Y.target.value})),placeholder:"Driver phone number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsxs("button",{onClick:$,disabled:!v.vehicleNo,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[t.jsx(Kr,{className:"w-4 h-4 inline-block mr-2"}),"Register Vehicle"]})})]})]})},V0=()=>{const{ledgerEntries:n,vehicles:e,setLedgerEntries:r,memos:a}=tr();ec.useEffect(()=>{const j=async()=>{try{const L=await(await fetch("http://localhost:5001/api/ledgers")).json();L.ledgerEntries&&(r(L.ledgerEntries),console.log("âœ… Ledger data refreshed:",L.ledgerEntries.length,"entries"),console.log("Vehicle entries found:",L.ledgerEntries.filter(q=>q.vehicle_no).length),console.log("GJ27TG9764 entries:",L.ledgerEntries.filter(q=>q.vehicle_no==="GJ27TG9764").length),console.log("GJ27TD2674 entries:",L.ledgerEntries.filter(q=>q.vehicle_no==="GJ27TD2674").length))}catch(v){console.error("Failed to refresh ledger data:",v)}};j();const B=setInterval(j,3e3);return()=>clearInterval(B)},[r]);const[s,i]=pe.useState(""),[l,u]=pe.useState(""),[c,m]=pe.useState(""),b=e.filter(j=>j.ownership_type==="own");ec.useEffect(()=>{if(!s){const j=b.find(B=>B.vehicle_no==="GJ27TG9764")||b[0];j&&(i(j.vehicle_no),console.log("ðŸŽ¯ Auto-selected vehicle:",j.vehicle_no))}},[b,s]);const w=pe.useMemo(()=>{if(!s)return[];const j=n.filter(L=>(L.vehicleNo===s||L.vehicle_no===s)&&(!l||L.date>=l)&&(!c||L.date<=c));console.log("ðŸš› Vehicle Ledger Debug:",{selectedVehicle:s,totalLedgerEntries:n.length,vehicleLedgerEntries:j.length,vehicleIncomeEntries:j.filter(L=>L.ledger_type==="vehicle_income").length,vehicleExpenseEntries:j.filter(L=>L.ledger_type==="vehicle_expense").length,fuelExpenseEntries:j.filter(L=>L.source_type==="fuel").length,dateFilter:{from:l,to:c},allLedgerEntries:n.map(L=>({type:L.ledger_type,source:L.source_type,vehicle:L.vehicle_no||L.vehicleNo,credit:L.credit,debit:L.debit,ref:L.reference_id,date:L.date,desc:L.description})),filteredEntries:j.map(L=>({type:L.ledger_type,source:L.source_type,vehicle:L.vehicle_no||L.vehicleNo,credit:L.credit,debit:L.debit,ref:L.reference_id,date:L.date,desc:L.description}))});let B=0;return j.sort((L,q)=>new Date(L.date).getTime()-new Date(q.date).getTime()).map(L=>{B+=(L.credit||0)-(L.debit||0);let q=L.description||"";const G=L.reference_id||L.referenceId||L.memoNumber;if(G&&G.startsWith("MO-")){const K=a.find($=>$.memo_number===G);if(K&&K.loading_slip_id&&typeof K.loading_slip_id=="object"){const $=K.loading_slip_id;q=`${G} - ${$.from_location} to ${$.to_location} (${L.description})`}else q=`${G} - ${L.description}`}return{...L,balance:B,type:L.ledger_type||L.type||"unknown",enhancedDescription:q}})},[s,l,c,n]),y=j=>{const B=n.filter(D=>(D.vehicle_no===j||D.vehicleNo===j)&&(!l||D.date>=l)&&(!c||D.date<=c)),v=B.filter(D=>D.credit>0).reduce((D,F)=>D+F.credit,0);B.filter(D=>{var F,A;return D.ledger_type==="vehicle_income"||((F=D.description)==null?void 0:F.toLowerCase().includes("freight"))||((A=D.description)==null?void 0:A.toLowerCase().includes("memo"))}).reduce((D,F)=>D+(F.credit||0),0);const L=0,q=0,G=B.filter(D=>{var F;return D.ledger_type==="detention"||((F=D.description)==null?void 0:F.toLowerCase().includes("detention"))}).reduce((D,F)=>D+(F.credit||0),0),K=B.filter(D=>{var F;return D.ledger_type==="toll"||D.ledger_type==="rto_fine"||D.ledger_type==="pod_charges"||((F=D.description)==null?void 0:F.toLowerCase().includes("extra"))}).reduce((D,F)=>D+(F.credit||0),0),$=L,Q=q,X=B.filter(D=>D.debit>0).reduce((D,F)=>D+F.debit,0),se=B.filter(D=>{var F,A;return D.debit>0&&(((F=D.description)==null?void 0:F.toLowerCase().includes("fuel"))||((A=D.reference_name)==null?void 0:A.toLowerCase().includes("fuel")))}).reduce((D,F)=>D+F.debit,0),Y=X-se,I=X,h=se,g=Y,S=v-I;return{totalIncome:v,fuelExpenses:h,otherExpenses:g,totalExpenses:I,netProfit:S,commissionExpense:$,mamulExpense:Q,detention:G,extraCharges:K}},p=pe.useMemo(()=>{const j=y(s);return{totalIncome:j.totalIncome,fuelExpenses:j.fuelExpenses,otherExpenses:j.otherExpenses,totalExpenses:j.totalExpenses,netProfit:j.netProfit}},[s,l,c,n]),_=()=>{if(!s||w.length===0)return;const j=["Date","Description","Type","Income","Expense","Balance"];let B=0;const v=w.map($=>(B+=($.credit||0)-($.debit||0),[$.date,$.description,$.type,$.credit>0?me($.credit):"",$.debit>0?me($.debit):"",me(B)])),L=[j,...v].map($=>$.map(Q=>`"${Q}"`).join(",")).join(`
`),q=new Blob([L],{type:"text/csv"}),G=URL.createObjectURL(q),K=document.createElement("a");K.href=G,K.download=`vehicle-ledger-${s}-${new Date().toISOString().split("T")[0]}.csv`,K.click(),URL.revokeObjectURL(G)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Vehicle Ledger"}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs("button",{onClick:_,disabled:!s||w.length===0,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(Ar,{className:"w-4 h-4"}),t.jsx("span",{children:"Export CSV"})]})})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Vehicle (Own Vehicles Only)"}),t.jsxs("select",{value:s,onChange:j=>i(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select Vehicle"}),b.map((j,B)=>t.jsxs("option",{value:j.vehicle_no,children:[j.vehicle_no," (",j.vehicle_type,")"]},j.id||`vehicle-${B}`))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),t.jsx("input",{type:"date",value:l,onChange:j=>u(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),t.jsx("input",{type:"date",value:c,onChange:j=>m(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})}),s&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Income"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-2",children:me(p.totalIncome)})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx(zi,{className:"w-6 h-6 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Expenses"}),t.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2",children:me(p.totalExpenses)})]}),t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx(Ti,{className:"w-6 h-6 text-red-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Profit/Loss"}),t.jsx("p",{className:`text-2xl font-bold mt-2 ${p.netProfit>=0?"text-green-600":"text-red-600"}`,children:me(p.netProfit)})]}),t.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${p.netProfit>=0?"bg-green-100":"bg-red-100"}`,children:p.netProfit>=0?t.jsx(zi,{className:"w-6 h-6 text-green-600"}):t.jsx(Ti,{className:"w-6 h-6 text-red-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsx("div",{children:t.jsxs("button",{onClick:_,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Export CSV"]})})})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Fuel Expenses"}),t.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-2",children:me(p.fuelExpenses)})]}),t.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:t.jsx(vr,{className:"w-6 h-6 text-orange-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Other Expenses"}),t.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2",children:me(p.otherExpenses)})]}),t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx(Ti,{className:"w-6 h-6 text-red-600"})})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Ledger Entries for ",s]})}),t.jsx("div",{className:"overflow-x-auto",children:w.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Br,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{className:"text-gray-500",children:"No entries found for the selected criteria"})]}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reference ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map((j,B)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(j.date).toLocaleDateString("en-GB")}),t.jsx("td",{className:"px-4 py-3 text-sm text-blue-600 font-medium",children:j.memoNumber||j.memo_number||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.enhancedDescription||j.description||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"-"}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:j.debit>0?t.jsx("span",{className:"text-red-600 font-medium",children:me(j.debit)}):"-"}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:j.credit>0?t.jsx("span",{className:"text-green-600 font-medium",children:me(j.credit)}):"-"}),t.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium",children:t.jsxs("span",{className:j.balance>=0?"text-green-600":"text-red-600",children:[me(Math.abs(j.balance)),j.balance<0?" Dr":" Cr"]})})]},j.id||B))})]})})]})]})]})},H0=()=>{const{vehicles:n,updateVehicle:e,cleanupSupplierLedgerForOwnVehicles:r}=tr(),[a,s]=pe.useState(null),[i,l]=pe.useState("market"),u=(b,w)=>{s(b),l(w)},c=async b=>{const w={...b,ownership_type:i,owner_name:i==="own"?"Bhavishya Road Carriers":b.owner_name};try{const y=await Fe.updateVehicle(b.id,w);e(y.vehicle),console.log("Vehicle ownership updated and synced:",y.vehicle)}catch(y){console.error("Failed to update vehicle ownership:",y),e(w)}r(),s(null)},m=()=>{s(null)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Vehicle Ownership Manager"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Fix vehicle ownership types to ensure correct ledger entries"})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"All Vehicles"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Change ownership type to fix supplier ledger issues"})]}),t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"space-y-4",children:n.map(b=>t.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(vr,{className:"w-6 h-6 text-blue-600"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:b.vehicle_no}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Owner: ",b.owner_name||"Not specified"]})]})]}),t.jsx("div",{className:"flex items-center space-x-4",children:a===b.id?t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("select",{value:i,onChange:w=>l(w.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"own",children:"Own Vehicle"}),t.jsx("option",{value:"market",children:"Market Vehicle"})]}),t.jsx("button",{onClick:()=>c(b),className:"p-1 text-green-600 hover:text-green-800",title:"Save",children:t.jsx(Ru,{className:"w-4 h-4"})}),t.jsx("button",{onClick:m,className:"p-1 text-gray-600 hover:text-gray-800",title:"Cancel",children:t.jsx(kn,{className:"w-4 h-4"})})]}):t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b.ownership_type==="own"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:b.ownership_type==="own"?"Own Vehicle":"Market Vehicle"}),t.jsx("button",{onClick:()=>u(b.id,b.ownership_type),className:"p-1 text-gray-600 hover:text-gray-800",title:"Edit ownership",children:t.jsx(Tu,{className:"w-4 h-4"})})]})})]},`vehicle-${b.id}`))}),n.length===0&&t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(vr,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"No vehicles found"})]})]})]})]})},W0=()=>{const[n,e]=pe.useState([]);pe.useEffect(()=>{const s=i=>{const{type:l,entity:u,error:c}=i.detail,m={type:l,entity:u,error:c,timestamp:Date.now()};e(b=>[m,...b.slice(0,4)]),setTimeout(()=>{e(b=>b.filter(w=>w.timestamp!==m.timestamp))},1e4)};return window.addEventListener("sync-error",s),()=>{window.removeEventListener("sync-error",s)}},[]);const r=s=>{e(i=>i.filter(l=>l.timestamp!==s))},a=()=>{window.dispatchEvent(new CustomEvent("data-sync-required")),e([])};return n.length===0?null:t.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:n.map(s=>t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg max-w-md",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(Du,{className:"h-5 w-5 text-red-400 mt-0.5 mr-3"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("h4",{className:"text-sm font-medium text-red-800",children:["Sync Error: ",s.type," ",s.entity]}),t.jsx("p",{className:"text-sm text-red-700 mt-1",children:s.error}),t.jsxs("div",{className:"mt-3 flex space-x-2",children:[t.jsxs("button",{onClick:a,className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200",children:[t.jsx(Mu,{className:"h-3 w-3 mr-1"}),"Retry Sync"]}),t.jsxs("button",{onClick:()=>r(s.timestamp),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200",children:[t.jsx(kn,{className:"h-3 w-3 mr-1"}),"Dismiss"]})]})]})]})},s.timestamp))})},G0=()=>{const{user:n,isLoading:e}=zc(),[r,a]=pe.useState("dashboard"),[s,i]=pe.useState(null);if(ku(),e)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!n)return t.jsx(Cu,{});const l=()=>{switch(r){case"dashboard":return t.jsx(ac,{});case"loading-slip":return t.jsx(Hh,{});case"memo":return t.jsx(Lc,{});case"bills":return t.jsx(Ac,{});case"paid-memo":return t.jsx(Lc,{showOnlyFullyPaid:!0});case"received-bills":return t.jsx(Ac,{showOnlyFullyReceived:!0});case"parties":return t.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Parties"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Party management component temporarily disabled due to missing form dependencies."})]});case"supplier-master":return t.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Suppliers"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Supplier management component temporarily disabled due to missing form dependencies."})]});case"party-ledger":return t.jsx(Dd,{});case"supplier-ledger":return t.jsx(Ed,{});case"general-ledger":return t.jsx(Id,{});case"banking":return t.jsx(Wh,{});case"cashbook":return t.jsx(Gh,{});case"fuel-management":return t.jsx($0,{});case"vehicle-ledger":return t.jsx(V0,{});case"vehicle-ownership":return t.jsx(H0,{});case"ledgers":return t.jsx(q0,{onViewLedger:(u,c)=>i({name:u,type:c})},Date.now());case"pod":return t.jsx(z0,{});default:return t.jsx(ac,{})}};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx($u,{currentPage:r,onNavigate:a,children:l()}),s&&t.jsx(U0,{ledgerName:s.name,ledgerType:s.type,onClose:()=>i(null)}),t.jsx(W0,{})]})};function Y0(){return t.jsx(Au,{children:t.jsx(Rc,{children:t.jsx(G0,{})})})}Tc(document.getElementById("root")).render(t.jsx(pe.StrictMode,{children:t.jsx(Rc,{children:t.jsx(Y0,{})})}));export{xt as _};
